import{a as Vt,b as Qt,g as Xt,r as a,u as ne,c as Zt,B as es,R as ts,d as J,N as Q,e as ss}from"./vendor-Ct1st1Nj.js";import{L as de,D as Je,T as Le,a as ye,P as ke,C as We,b as as,U as Ke,S as gt,c as Ve,d as be,e as Pt,f as lt,g as rs,A as De,h as Ct,Z as ue,i as ls,j as nt,k as He,X as Pe,l as le,m as ns,M as ot,n as It,o as Ge,p as os,q as ft,r as Oe,s as ze,t as is,u as cs,v as $e,W as ds,H as ms,B as xs,w as us,x as hs,F as ps,y as gs,G as fs,z as it,E as bs,I as ys,J as js,K as Ns}from"./icons-BU9j0z13.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&c(m)}).observe(document,{childList:!0,subtree:!0});function l(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(n){if(n.ep)return;n.ep=!0;const o=l(n);fetch(n.href,o)}})();var tt={exports:{}},Te={};var bt;function vs(){if(bt)return Te;bt=1;var t=Vt(),r=Symbol.for("react.element"),l=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function m(i,x,g){var d,f={},p=null,T=null;g!==void 0&&(p=""+g),x.key!==void 0&&(p=""+x.key),x.ref!==void 0&&(T=x.ref);for(d in x)c.call(x,d)&&!o.hasOwnProperty(d)&&(f[d]=x[d]);if(i&&i.defaultProps)for(d in x=i.defaultProps,x)f[d]===void 0&&(f[d]=x[d]);return{$$typeof:r,type:i,key:p,ref:T,props:f,_owner:n.current}}return Te.Fragment=l,Te.jsx=m,Te.jsxs=m,Te}var yt;function ws(){return yt||(yt=1,tt.exports=vs()),tt.exports}var e=ws(),qe={},jt;function Ss(){if(jt)return qe;jt=1;var t=Qt();return qe.createRoot=t.createRoot,qe.hydrateRoot=t.hydrateRoot,qe}var ks=Ss();const Ps=Xt(ks),Cs=()=>"https://universal-backend-w0x1.onrender.com/api",xe=Cs(),At=()=>localStorage.getItem("token"),Tt=async(t,r={},l=0,c=3)=>{const n=At(),o=t.startsWith("/")?t:`/${t}`,m={...r,headers:{"Content-Type":"application/json",...n&&!(o.startsWith("/auth")&&o!=="/auth/me")&&!o.includes("/main-admin/auth/login")&&{Authorization:`Bearer ${n}`},...r.headers}};try{const i=await fetch(`${xe}${o}`,m);if(i.status===401){if(o.includes("/auth/login")||o.includes("/main-admin/auth/login")){const f=await i.json().catch(()=>({error:"Unauthorized"}));throw new Error(f.error||"Invalid credentials")}localStorage.removeItem("token"),localStorage.removeItem("user");const g=window.location.pathname||"";if(!g.includes("/login")&&!g.includes("/signup")&&!g.includes("/auth")&&!g.includes("/main.admin"))try{window.location.href="/login"}catch{}const d=new Error("Unauthorized");throw d.status=401,d}if(i.status===500)throw new Error("Server error 500 - Backend unavailable");if(i.ok)return i.status===204?{success:!0}:await i.json();const x=await i.json().catch(()=>({error:"Network error"}));throw new Error(x.error||`HTTP ${i.status}: ${i.statusText}`)}catch(i){if(i.name==="TypeError"&&i.message.includes("fetch")){if(console.error(`API Fetch Error (attempt ${l+1}/${c+1}):`,i),console.error("Attempted URL:",`${xe}${o}`),l<c){const x=Math.min(1e3*Math.pow(2,l),1e4);return console.log(`Retrying in ${x}ms...`),await new Promise(g=>setTimeout(g,x)),Tt(t,r,l+1,c)}throw new Error("Cannot connect to server. The server may be waking up. Please try again in a moment.")}throw i}},j=(t,r={})=>Tt(t,r,0,3),Se={login:t=>j("/auth/login",{method:"POST",body:JSON.stringify(t)}),pinLogin:t=>j("/auth/pin-login",{method:"POST",body:JSON.stringify(t)}),signup:t=>j("/auth/signup",{method:"POST",body:JSON.stringify(t)}),signupWithPayment:t=>j("/signup-with-payment",{method:"POST",body:JSON.stringify(t)}),me:()=>j("/auth/me"),updatePin:t=>j("/auth/update-pin",{method:"POST",body:JSON.stringify({pin:t})})},Ye={getAll:()=>j("/users"),create:t=>j("/users",{method:"POST",body:JSON.stringify(t)}),update:(t,r)=>j(`/users/${t}`,{method:"PUT",body:JSON.stringify(r)}),delete:t=>j(`/users/${t}`,{method:"DELETE"}),setPin:(t,r)=>j(`/users/${t}/set-pin`,{method:"POST",body:JSON.stringify({pin:r})}),lock:(t,r)=>j(`/users/${t}/lock`,{method:"POST",body:JSON.stringify({locked:r})})},ce={getAll:()=>j("/products"),create:t=>j("/products",{method:"POST",body:JSON.stringify(t)}),update:(t,r)=>j(`/products/${t}`,{method:"PUT",body:JSON.stringify(r)}),delete:t=>j(`/products/${t}`,{method:"DELETE"}),getLowStockWarnings:()=>j("/products/low-stock-warnings"),updateStock:(t,r)=>j(`/products/${t}/stock`,{method:"PUT",body:JSON.stringify(r)}),getMaxProducible:t=>j(`/products/${t}/max-producible`),getWeightPricing:t=>j(`/products/${t}/weight-pricing`),addWeightPrice:(t,r,l)=>j(`/products/${t}/weight-pricing`,{method:"POST",body:JSON.stringify({weight:r,price:l})}),updateWeightPrice:(t,r,l)=>j(`/products/${t}/weight-pricing`,{method:"PUT",body:JSON.stringify({weight:r,price:l})}),deleteWeightPrice:(t,r)=>j(`/products/${t}/weight-pricing`,{method:"DELETE",body:JSON.stringify({weight:r})})},Ee={getAll:()=>j("/sales"),create:t=>j("/sales",{method:"POST",body:JSON.stringify(t)}),delete:t=>j(`/sales/${t}`,{method:"DELETE"}),adminComplete:t=>j("/admin-complete-sale",{method:"POST",body:JSON.stringify(t)})},ct={getAll:()=>j("/expenses"),create:t=>j("/expenses",{method:"POST",body:JSON.stringify(t)}),update:(t,r)=>j(`/expenses/${t}`,{method:"PUT",body:JSON.stringify(r)}),delete:t=>j(`/expenses/${t}`,{method:"DELETE"})},dt={get:()=>j("/stats")},Is={getAll:()=>j("/discounts"),create:t=>j("/discounts",{method:"POST",body:JSON.stringify(t)}),update:(t,r)=>j(`/discounts/${t}`,{method:"PUT",body:JSON.stringify(r)}),delete:t=>j(`/discounts/${t}`,{method:"DELETE"})},As={getAll:()=>j("/credit-requests"),create:t=>j("/credit-requests",{method:"POST",body:JSON.stringify(t)}),update:(t,r)=>j(`/credit-requests/${t}`,{method:"PUT",body:JSON.stringify(r)}),approve:t=>j(`/credit-requests/${t}/approve`,{method:"POST"}),reject:t=>j(`/credit-requests/${t}/reject`,{method:"POST"})},Ts={get:()=>j("/settings"),update:t=>j("/settings",{method:"PUT",body:JSON.stringify(t)})},st={getAll:()=>j("/time-entries"),getStatus:()=>j("/clock-status"),create:t=>j("/time-entries",{method:"POST",body:JSON.stringify({action:t})}),update:(t,r)=>j(`/time-entries/${t}`,{method:"PUT",body:JSON.stringify(r)}),delete:t=>j(`/time-entries/${t}`,{method:"DELETE"})},Nt={getAll:t=>{const r=t?`/batches?productId=${t}`:"/batches";return j(r)},create:t=>j("/batches",{method:"POST",body:JSON.stringify(t)})},at={login:t=>j("/main-admin/auth/login",{method:"POST",body:JSON.stringify(t)}),getUsers:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/users",{headers:{Authorization:`Bearer ${t}`}})},getStats:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/stats",{headers:{Authorization:`Bearer ${t}`}})},getActivities:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/activities",{headers:{Authorization:`Bearer ${t}`}})},getSalesAll:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/sales-all",{headers:{Authorization:`Bearer ${t}`}})},getTimeEntriesAll:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/time-entries-all",{headers:{Authorization:`Bearer ${t}`}})},lockUser:(t,r)=>{const l=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j(`/main-admin/users/${t}/lock`,{method:"POST",headers:{Authorization:`Bearer ${l}`},body:JSON.stringify({locked:r})})},changePlan:(t,r)=>{const l=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j(`/main-admin/users/${t}/plan`,{method:"POST",headers:{Authorization:`Bearer ${l}`},body:JSON.stringify({plan:r})})},clearData:t=>{const r=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/system/clear-data",{method:"POST",headers:{Authorization:`Bearer ${r}`},body:JSON.stringify({type:t})})},getSubscribers:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/subscribers",{headers:{Authorization:`Bearer ${t}`}})},getSubscribersAnalytics:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/subscribers/analytics",{headers:{Authorization:`Bearer ${t}`}})},getUsersWithSubscriptions:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return j("/main-admin/users-with-subscriptions",{headers:{Authorization:`Bearer ${t}`}})}};let re=null,_e=new Set;function Ds(){const t=xe.replace(/\/api$/,"");return`${t.startsWith("https")?"wss":"ws"}://${t.replace(/^https?:\/\//,"")}/api/ws/products`}function Es(){if(re&&(re.readyState===WebSocket.OPEN||re.readyState===WebSocket.CONNECTING))return;const t=At(),r=Ds()+(t?`?token=${encodeURIComponent(t)}`:"");re=new WebSocket(r),re.onopen=()=>{console.debug("Products WS connected")},re.onmessage=l=>{let c=null;try{c=JSON.parse(l.data)}catch{return}_e.forEach(n=>{try{n(c)}catch(o){console.error("ws callback error",o)}})},re.onclose=()=>{console.debug("Products WS closed"),re=null},re.onerror=l=>{console.error("Products WS error",l)}}function vt(t){if(typeof t!="function")throw new Error("subscribeProducts requires a callback");return _e.add(t),Es(),()=>{if(_e.delete(t),re&&_e.size===0){try{re.close()}catch{}re=null}}}const Dt=a.createContext(),ee=()=>a.useContext(Dt),Ls=({children:t})=>{const[r,l]=a.useState(null),[c,n]=a.useState(!0),[o,m]=a.useState(!1),[i,x]=a.useState({});a.useEffect(()=>{g()},[]),a.useEffect(()=>{const v=()=>{const A=localStorage.getItem("user");if(A)try{const M=JSON.parse(A);l(M)}catch(M){console.warn("Failed to parse user from localStorage",M)}else l(null)};return window.addEventListener("storage",v),window.addEventListener("localStorageUpdated",v),()=>{window.removeEventListener("storage",v),window.removeEventListener("localStorageUpdated",v)}},[]);const g=async()=>{try{const v=localStorage.getItem("token"),A=localStorage.getItem("user");if(v)try{const M=await fetch(`${xe}/auth/me`,{headers:{Authorization:`Bearer ${v}`,"Content-Type":"application/json"}});if(M.ok){const N=await M.json();l(N),localStorage.setItem("user",JSON.stringify(N))}else throw new Error("Invalid token")}catch(M){console.warn("Auth check failed:",M),localStorage.removeItem("token"),localStorage.removeItem("user")}}catch(v){console.error("Error initializing auth:",v),localStorage.removeItem("token"),localStorage.removeItem("user"),l(null)}finally{n(!1),m(!0)}},d=async v=>{try{if(v&&v.token&&v.user)return localStorage.setItem("token",v.token),localStorage.setItem("user",JSON.stringify(v.user)),l(v.user),v;const A=await Se.login(v);if(A.token&&A.user)return localStorage.setItem("token",A.token),localStorage.setItem("user",JSON.stringify(A.user)),l(A.user),A;throw new Error("Invalid response from server")}catch(A){throw console.error("Login failed:",A),A}},f=async v=>{try{const A=await Se.signup(v);if(A.token&&A.user)return localStorage.setItem("token",A.token),localStorage.setItem("user",JSON.stringify(A.user)),l(A.user),A;throw new Error("Invalid response from server")}catch(A){throw console.error("Signup failed:",A),A}},p=async v=>{try{if(localStorage.setItem("user",JSON.stringify(v)),l(v),window.dispatchEvent(new Event("localStorageUpdated")),v&&v.id)try{await Ye.update(v.id,v)}catch(A){console.warn("Failed to persist updated user to backend",A)}return v}catch(A){throw console.error("updateUser failed:",A),A}},T=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),l(null),window.location.href="/auth/login"},L=()=>!!r&&!!localStorage.getItem("token"),D=v=>r&&r.role===v,W=()=>r&&(r.role==="admin"||r.role==="main-admin"),I=()=>r&&r.role==="cashier",k=()=>r&&r.plan==="ultra",U=()=>r&&r.plan==="basic",F=()=>r&&(r.role==="admin"||r.role==="cashier"),H=()=>r&&r.role==="admin"&&r.plan==="ultra",q=()=>r&&r.role==="admin",u=()=>!0,P=()=>!0;return r?.locked?e.jsx(LockedAccount,{}):e.jsx(Dt.Provider,{value:{user:r,loading:c,isInitialized:o,appSettings:i,login:d,signup:f,updateUser:p,logout:T,isAuthenticated:L,hasRole:D,isAdmin:W,isCashier:I,isUltraPackage:k,isBasicPackage:U,canEditStock:F,canManageUsers:H,canViewAnalytics:q,isRealTimeProductSyncEnabled:u,isCashierUserManagementEnabled:P},children:t})};new Date().toISOString();const Et=a.createContext(),Lt=()=>a.useContext(Et),Os=({children:t})=>{const{user:r}=ee(),[l,c]=a.useState([]),[n,o]=a.useState(!0),[m,i]=a.useState(null),[x,g]=a.useState(Date.now()),d=a.useCallback(async()=>{if(!localStorage.getItem("token"))return o(!1),[];try{const p=await ce.getAll(),L=(Array.isArray(p)?p:[]).filter(D=>!D.pendingDelete);return c(L),i(null),window.dispatchEvent(new CustomEvent("productsSync",{detail:{products:L,timestamp:Date.now()}})),L}catch(p){return console.error("Failed to fetch products:",p),i(`Failed to load products: ${p.message}`),c([]),[]}finally{o(!1),g(Date.now())}},[]);a.useEffect(()=>{d()},[]),a.useEffect(()=>{const p=()=>{console.log("ðŸ”„ Data cleared event received - forcing products refresh"),c([]),i(null),d()};return window.addEventListener("dataCleared",p),window.addEventListener("productsCleared",p),()=>{window.removeEventListener("dataCleared",p),window.removeEventListener("productsCleared",p)}},[]);const f=async()=>(o(!0),await d());return e.jsx(Et.Provider,{value:{products:l,loading:n,error:m,lastUpdated:x,refreshProducts:f},children:t})},Ot=a.createContext(),$t=()=>a.useContext(Ot),$s=900*1e3,Us=({children:t})=>{const{user:r}=ee(),[l,c]=a.useState(!1),n=a.useRef(null),o=a.useRef(Date.now()),m=a.useCallback(()=>{o.current=Date.now(),n.current&&clearTimeout(n.current),n.current=setTimeout(()=>{c(!0),console.log("ðŸ”’ Screen locked due to inactivity")},$s)},[]);a.useEffect(()=>{const d=["mousedown","keydown","click","touchstart"];return d.forEach(f=>{document.addEventListener(f,m)}),m(),()=>{d.forEach(f=>{document.removeEventListener(f,m)}),n.current&&clearTimeout(n.current)}},[m]);const i=a.useCallback(()=>{c(!0),console.log("ðŸ”’ Screen manually locked")},[]),x=a.useCallback(()=>{c(!1),m(),console.log("ðŸ”“ Screen unlocked")},[m]),g={isLocked:l,lock:i,unlock:x};return e.jsx(Ot.Provider,{value:g,children:t})};function wt(){const{user:t,logout:r}=ee(),[l,c]=a.useState({products:[],sales:[],expenses:[],stats:{},users:[]}),[n,o]=a.useState("overview"),[m,i]=a.useState(!1),[x,g]=a.useState(!1),[d,f]=a.useState(""),[p,T]=a.useState({name:"",price:"",cost:"",category:"finished",unit:"pcs"}),[L,D]=a.useState({name:"",email:"",password:"changeme123",role:"cashier"}),[W,I]=a.useState(null);a.useEffect(()=>{k()},[]),a.useEffect(()=>{const u=setInterval(async()=>{try{const P=await dt.get();c(v=>({...v,stats:P||{}})),I(new Date().toLocaleTimeString())}catch(P){console.warn("Stats polling failed:",P)}},5e3);return()=>clearInterval(u)},[]);const k=async()=>{try{const[u,P,v,A,M]=await Promise.all([ce.getAll(),Ee.getAll(),ct.getAll(),dt.get(),Ye.getAll()]);c({products:Array.isArray(u)?u:[],sales:Array.isArray(P)?P:[],expenses:Array.isArray(v)?v:[],stats:A||{},users:Array.isArray(M)?M:[]}),I(new Date().toLocaleTimeString())}catch(u){console.error("Failed to load data:",u),c({products:[],sales:[],expenses:[],stats:{},users:[]})}},U=async u=>{u.preventDefault(),console.log("ðŸ“¦ Add Product form submitted");try{if(!p.name||!p.price){console.warn("âš ï¸ Validation failed - missing required fields"),alert("Please fill in all required fields (Name, Price)");return}if(console.log("âž• Creating product:",p.name,"Price:",p.price,"Unit:",p.unit),!ce||typeof ce.create!="function")throw new Error("Products API not properly loaded");const P=await ce.create({...p,price:parseFloat(p.price),cost:parseFloat(p.cost||0),quantity:0});if(!P||!P.id)throw new Error("Invalid response from server - no product ID returned");console.log("âœ… Product created:",P.id,P.name),T({name:"",price:"",cost:"",category:"finished",unit:"pcs"}),i(!1),console.log("ðŸ”„ Reloading inventory..."),await k(),alert(`âœ… Product "${P.name}" added successfully!`)}catch(P){console.error("âŒ Failed to add product:",P.message,P),alert(`âŒ Failed to add product: ${P.message||"Unknown error"}`)}},F=async u=>{u.preventDefault();try{if(!L.name||!L.email){alert("Please fill in all required fields (Name, Email)");return}console.log("âž• Creating user:",L.name);const P=await Ye.create(L);console.log("âœ… User created:",P.id),D({name:"",email:"",password:"changeme123",role:"cashier"}),g(!1),await k(),alert(`âœ… User "${P.name}" created successfully! Login: ${P.email} / changeme123`)}catch(P){console.error("âŒ Failed to create user:",P),alert(`âŒ Failed to create user: ${P.message||"Unknown error"}`)}},H=l.products.filter(u=>u.name?.toLowerCase().includes(d.toLowerCase())),q=[{id:"overview",label:"Overview",icon:We},{id:"inventory",label:"Inventory",icon:as},{id:"users",label:"Users",icon:Ke},{id:"sales",label:"Sales",icon:gt},{id:"expenses",label:"Expenses",icon:Le},{id:"stock-deductions",label:"Stock Log",icon:ke}];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[e.jsx("nav",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 px-6 py-4 sticky top-0 z-50 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Admin Dashboard"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Professional Plan - KSH 1,600/month â€¢ Live Updates Every 5s ",W&&`â€¢ Last: ${W}`]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t?.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t?.email})]}),e.jsxs("button",{onClick:r,className:"btn-secondary flex items-center gap-2 hover:bg-red-50 hover:text-red-600 hover:border-red-200",children:[e.jsx(de,{className:"w-4 h-4"}),"Logout"]})]})]})}),e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"card bg-gradient-to-br from-green-500 to-emerald-600 text-white border-0 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-100 mb-1",children:"Total Sales"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",l.stats.totalSales?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(Je,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-red-500 to-pink-600 text-white border-0 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-100 mb-1",children:"Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",l.stats.totalExpenses?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(Le,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-blue-500 to-indigo-600 text-white border-0 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Net Profit"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",l.stats.profit?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(ye,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-purple-500 to-violet-600 text-white border-0 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-100 mb-1",children:"Products"}),e.jsx("p",{className:"text-3xl font-bold",children:l.products.length})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(ke,{className:"w-8 h-8"})})]})})]}),e.jsxs("div",{className:"card shadow-lg",children:[e.jsx("div",{className:"flex gap-2 border-b border-gray-200 mb-6 overflow-x-auto",children:q.map(u=>{const P=u.icon;return e.jsxs("button",{onClick:()=>o(u.id),className:`flex items-center gap-2 px-6 py-3 font-medium transition-all whitespace-nowrap ${n===u.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx(P,{className:"w-4 h-4"}),u.label]},u.id)})}),n==="overview"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(gt,{className:"w-5 h-5 text-blue-600"}),"Recent Sales"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock Deducted"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"})]})}),e.jsx("tbody",{children:l.sales.slice(-10).reverse().map((u,P)=>{const v=u.stockDeductions?.products?.slice(0,2).map(A=>`${A.name}: -${A.deducted}${A.unit}`).join(", ")+(u.stockDeductions?.products?.length>2?"...":"")||"None";return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(u.createdAt).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[u.items?.length||0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm text-orange-600 font-semibold",children:v}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:u.paymentMethod||"cash"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",u.total?.toLocaleString()]})]},P)})})]})})]})}),n==="inventory"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("div",{className:"flex items-center gap-4 flex-1",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"input pl-10",value:d,onChange:u=>f(u.target.value)})]})}),e.jsxs("button",{onClick:()=>{try{console.log("ðŸ›’ Add Product button clicked"),i(!0)}catch(u){console.error("âŒ Button handler error:",u),alert(`Error: ${u.message}`)}},className:"btn-primary flex items-center gap-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 transition-all duration-200",children:[e.jsx(be,{className:"w-4 h-4"}),"Add Product"]})]}),m&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl border-2 border-blue-200",children:[e.jsx("h4",{className:"font-semibold mb-4 text-lg",children:"Add New Product"}),e.jsxs("form",{onSubmit:U,className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name *",className:"input",value:p.name,onChange:u=>T({...p,name:u.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Selling Price *",className:"input",value:p.price,onChange:u=>T({...p,price:u.target.value}),step:"0.01",required:!0}),e.jsx("input",{type:"number",placeholder:"Cost Price",className:"input",value:p.cost,onChange:u=>T({...p,cost:u.target.value}),step:"0.01"}),e.jsxs("select",{className:"input",value:p.category,onChange:u=>T({...p,category:u.target.value}),children:[e.jsx("option",{value:"finished",children:"Finished Good"}),e.jsx("option",{value:"raw",children:"Raw Material"}),e.jsx("option",{value:"semi-finished",children:"Semi-Finished"})]}),e.jsxs("select",{className:"input",value:p.unit,onChange:u=>T({...p,unit:u.target.value}),children:[e.jsx("option",{value:"pcs",children:"Pieces"}),e.jsx("option",{value:"kg",children:"Kilograms"}),e.jsx("option",{value:"liters",children:"Liters"}),e.jsx("option",{value:"grams",children:"Grams"}),e.jsx("option",{value:"ml",children:"Milliliters"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Product"}),e.jsx("button",{type:"button",onClick:()=>i(!1),className:"btn-secondary",children:"Cancel"})]})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Note: Stock is added separately via Batches. Fields marked with * are required."})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Product Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:H.map(u=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:u.name}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-blue-600",children:["KSH ",u.price?.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`font-medium ${u.quantity<10?"text-red-600":"text-gray-900"}`,children:u.quantity||0})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`badge ${u.recipe?"badge-success":"badge-warning"}`,children:u.recipe?"Composite":"Raw"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`badge ${u.quantity>10?"badge-success":u.quantity>0?"badge-warning":"badge-danger"}`,children:u.quantity>10?"In Stock":u.quantity>0?"Low Stock":"Out of Stock"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-blue-50 rounded-lg text-blue-600 transition-colors",children:e.jsx(Pt,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 hover:bg-red-50 rounded-lg text-red-600 transition-colors",children:e.jsx(lt,{className:"w-4 h-4"})})]})})]},u.id))})]})})]}),n==="users"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"User Management"}),e.jsxs("button",{onClick:()=>g(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4"}),"Add User"]})]}),x&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-green-50 to-blue-50 rounded-xl border-2 border-green-200",children:[e.jsx("h4",{className:"font-semibold mb-4 text-lg",children:"Add New User"}),e.jsxs("form",{onSubmit:F,className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Full Name",className:"input",value:L.name,onChange:u=>D({...L,name:u.target.value}),required:!0}),e.jsx("input",{type:"email",placeholder:"Email",className:"input",value:L.email,onChange:u=>D({...L,email:u.target.value}),required:!0}),e.jsxs("select",{className:"input",value:L.role,onChange:u=>D({...L,role:u.target.value}),children:[e.jsx("option",{value:"cashier",children:"Cashier"}),e.jsx("option",{value:"admin",children:"Admin"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add User"}),e.jsx("button",{type:"button",onClick:()=>g(!1),className:"btn-secondary",children:"Cancel"})]})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Default password: changeme123"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Created"})]})}),e.jsx("tbody",{children:l.users.map(u=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:u.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:u.email}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`badge ${u.role==="admin"?"badge-success":"badge-warning"}`,children:u.role})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`badge ${u.active?"badge-success":"badge-danger"}`,children:u.active?"Active":"Inactive"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:new Date(u.createdAt).toLocaleDateString()})]},u.id))})]})})]}),n==="sales"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"All Sales"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock Deducted"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"})]})}),e.jsx("tbody",{children:l.sales.slice().reverse().map((u,P)=>{const v=u.stockDeductions?.products?.map(A=>`${A.name}: -${A.deducted}${A.unit}`).join(", ")||"None";return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:new Date(u.createdAt).toLocaleString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[u.items?.length||0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm text-orange-600 font-semibold text-xs",children:v}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:u.paymentMethod||"cash"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",u.total?.toLocaleString()]})]},P)})})]})})]}),n==="expenses"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"All Expenses"}),e.jsxs("button",{className:"btn-primary flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4"}),"Add Expense"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Amount"})]})}),e.jsx("tbody",{children:l.expenses.slice().reverse().map((u,P)=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(u.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:u.description}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-warning",children:u.category||"General"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-red-600",children:["KSH ",u.amount?.toLocaleString()]})]},P))})]})})]}),n==="stock-deductions"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Stock Deductions Log"}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-orange-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Sale ID"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Time"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Before"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Deducted"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"After"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Unit"})]})}),e.jsx("tbody",{children:l.sales&&l.sales.slice().reverse().map(u=>u.stockDeductions?.products?.map((P,v)=>e.jsxs("tr",{className:"border-t border-orange-100 hover:bg-orange-50 transition-colors",children:[e.jsxs("td",{className:"px-4 py-3 font-medium text-blue-600",children:["#",u.id]}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:new Date(u.createdAt).toLocaleString()}),e.jsx("td",{className:"px-4 py-3",children:P.name}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:P.before}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-red-600",children:["-",P.deducted]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-green-600",children:P.after}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:P.unit})]},`${u.id}-${v}`)))})]}),(!l.sales||l.sales.length===0||!l.sales.some(u=>u.stockDeductions?.products?.length>0))&&e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No stock deductions recorded yet"})]})]})]})]})]})}const Rs=`
  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideInDown {
    from {
      opacity: 0;
      transform: translateY(-30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  @keyframes pulse-glow {
    0%, 100% {
      box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);
    }
    50% {
      box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
    }
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-20px);
    }
  }

  @keyframes shimmer {
    0% {
      background-position: -1000px 0;
    }
    100% {
      background-position: 1000px 0;
    }
  }

  @keyframes bounce-in {
    0% {
      opacity: 0;
      transform: scale(0.8);
    }
    50% {
      opacity: 1;
    }
    100% {
      transform: scale(1);
    }
  }

  @keyframes word-slide {
    0% {
      opacity: 0;
      transform: translateX(-30px);
    }
    100% {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .animate-slide-up {
    animation: slideInUp 0.8s ease-out forwards;
  }

  .animate-slide-down {
    animation: slideInDown 0.8s ease-out forwards;
  }

  .animate-fade-scale {
    animation: fadeInScale 0.6s ease-out forwards;
  }

  .animate-pulse-glow {
    animation: pulse-glow 2s infinite;
  }

  .animate-float {
    animation: float 3s ease-in-out infinite;
  }

  .animate-bounce-in {
    animation: bounce-in 0.6s ease-out forwards;
  }

  .feature-card {
    animation: slideInUp 0.8s ease-out forwards;
  }

  .feature-card:nth-child(1) { animation-delay: 0.1s; }
  .feature-card:nth-child(2) { animation-delay: 0.2s; }
  .feature-card:nth-child(3) { animation-delay: 0.3s; }
  .feature-card:nth-child(4) { animation-delay: 0.4s; }
  .feature-card:nth-child(5) { animation-delay: 0.5s; }
  .feature-card:nth-child(6) { animation-delay: 0.6s; }

  .plan-card {
    animation: fadeInScale 0.7s ease-out forwards;
  }

  .plan-card:nth-child(1) { animation-delay: 0.2s; }
  .plan-card:nth-child(2) { animation-delay: 0.4s; }

  .stat-item {
    animation: slideInUp 0.8s ease-out forwards;
  }

  .stat-item:nth-child(1) { animation-delay: 0.1s; }
  .stat-item:nth-child(2) { animation-delay: 0.2s; }
  .stat-item:nth-child(3) { animation-delay: 0.3s; }
  .stat-item:nth-child(4) { animation-delay: 0.4s; }

  .hero-text {
    opacity: 0;
  }

  .hero-text-1 { animation: word-slide 0.6s ease-out 0.2s forwards; }
  .hero-text-2 { animation: word-slide 0.6s ease-out 0.4s forwards; }
  .hero-text-3 { animation: word-slide 0.6s ease-out 0.6s forwards; }

  .btn-animate {
    animation: slideInUp 0.8s ease-out 0.8s forwards;
    opacity: 0;
  }

  .glow-border {
    animation: pulse-glow 2s infinite;
  }
`;function Bs(){const t=ne(),[r,l]=a.useState(!1),[c,n]=a.useState(0);a.useEffect(()=>{const x=document.createElement("style");return x.textContent=Rs,document.head.appendChild(x),()=>document.head.removeChild(x)},[]);const o=[{title:"1. Sign Up & Choose Plan",desc:"Create your account and select between Basic (KSH 1,600 - 1 Cashier) or Ultra (KSH 3,000 - Unlimited) package",image:"ðŸ“",details:"First user becomes Admin automatically. Basic supports 1 cashier. Ultra supports unlimited cashiers with full features including Recipe Builder and User Management."},{title:"2. Add Raw Materials",desc:"Stock your inventory with raw ingredients like fish, oil, breadcrumbs, salt, etc.",image:"ðŸ“¦",details:'Enter product name, cost, quantity, and unit. Mark items as "expense-only" to hide from cashiers.'},{title:"3. Create Recipes (Ultra Only)",desc:"Build composite products using the Recipe/BOM Builder",image:"ðŸ½ï¸",details:"Example: Fish Fingers = 0.02kg Nile Perch + 0.01L Oil + 0.004kg Breadcrumbs. System auto-calculates COGS and profit margin."},{title:"4. Add Cashiers (Ultra Only)",desc:"Invite team members and set their permissions",image:"ðŸ‘¥",details:"Enter name and email. Set permissions: View Sales, View Inventory, View Expenses, Manage Products. Default password: changeme123"},{title:"5. Make Sales",desc:"Cashiers use the POS to sell products",image:"ðŸ’°",details:"Search products, add to cart, select payment method (Cash/M-Pesa/Card), complete sale. Stock automatically deducted!"},{title:"6. Automatic Stock Deduction",desc:"When selling composite products, ingredients are auto-deducted",image:"âš¡",details:"Sell 1 Fish Finger â†’ System deducts 0.02kg fish, 0.01L oil, 0.004kg breadcrumbs. COGS calculated automatically!"},{title:"7. Track Analytics",desc:"Monitor sales, profit, expenses in real-time",image:"ðŸ“Š",details:"View daily/weekly sales, gross profit, net profit, COGS breakdown. Admin sees full analytics, cashiers see limited data."},{title:"8. Manage Expenses",desc:"Track manual expenses and automatic ingredient costs",image:"ðŸ’¸",details:"Add manual expenses (rent, utilities, salaries). System auto-creates expenses when expense-only items are used in recipes."}],m=[{icon:ue,title:"âš¡ Atomic Sales",desc:"Complete sales instantly (3-4ms) - never hanging, always consistent stock"},{icon:ye,title:"ðŸ“Š Live Analytics",desc:"Real-time dashboard updates every 5 seconds with instant totals"},{icon:ue,title:"ðŸ”’ Zero Race Conditions",desc:"File-based locking prevents stock conflicts even with simultaneous sales"},{icon:ke,title:"âš ï¸ Low-Stock Alerts",desc:"Automatic warnings when inventory drops below threshold"},{icon:ls,title:"ðŸ’¯ 99.99% Reliability",desc:"Atomic transactions guarantee data integrity, never lost sales"},{icon:We,title:"ðŸš€ Performance+",desc:"Sales 50x faster, Analytics 140x faster than legacy systems"}],i=[{name:"Basic",price:1e3,icon:ue,popular:!1,features:["âœ“ Admin + Cashier Dashboard","âœ“ Basic Inventory","âœ“ Sales Tracking","âœ“ Daily/Weekly Reports","âœ“ Basic Profit/Loss View","âœ“ Email Support","âœ“ 1 Cashier Only"]},{name:"Ultra",price:2500,icon:nt,popular:!0,features:["âœ“ Admin + Cashier Dashboard","âœ“ Full Inventory Management","âœ“ Automatic Stock Deduction","âœ“ User Management (Unlimited)","âœ“ Permission Controls","âœ“ Expense Tracking","âœ“ Advanced Analytics","âœ“ Priority Support"]},{name:"Pro",price:3400,icon:nt,popular:!1,features:["âœ“ All Ultra Features","âœ“ Recipe/BOM Builder","âœ“ COGS Calculation","âœ“ Composite Products","âœ“ Advanced Reporting","âœ“ Multi-location Support","âœ“ API Access","âœ“ Dedicated Support"]}];return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-10"}),e.jsx("nav",{className:"relative z-10 px-6 py-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-xl flex items-center justify-center",children:e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"P"})}),e.jsx("span",{className:"text-2xl font-bold text-white",children:"POSify"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t("/auth/login"),className:"text-white hover:text-blue-100 font-medium",children:"Login"}),e.jsx("button",{onClick:()=>t("/choose-subscription"),className:"bg-white text-blue-600 px-6 py-2 rounded-lg font-semibold hover:shadow-lg transition-all",children:"Get Started"})]})]})}),e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-6 py-20 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur-sm px-4 py-2 rounded-full text-white text-sm font-medium mb-6",children:[e.jsx(rs,{className:"w-4 h-4 fill-yellow-300 text-yellow-300"}),"Trusted by 500+ businesses"]}),e.jsxs("h1",{className:"text-5xl md:text-7xl font-bold text-white mb-6 leading-tight",children:["Modern POS System",e.jsx("br",{}),e.jsx("span",{className:"text-blue-200",children:"Built for Growth"})]}),e.jsx("p",{className:"text-xl text-blue-100 mb-8 max-w-2xl mx-auto",children:"Complete inventory management with recipe builder, automatic stock deduction, and real-time analytics. Everything you need to run your business efficiently."}),e.jsxs("div",{className:"flex items-center justify-center gap-4",children:[e.jsxs("button",{onClick:()=>t("/choose-subscription"),className:"bg-white text-blue-600 px-8 py-4 rounded-xl font-bold text-lg hover:shadow-2xl transform hover:scale-105 transition-all flex items-center gap-2",children:["Start Free Trial",e.jsx(De,{className:"w-5 h-5"})]}),e.jsxs("button",{onClick:()=>l(!0),className:"border-2 border-white text-white px-8 py-4 rounded-xl font-bold text-lg hover:bg-white/10 transition-all flex items-center gap-2",children:[e.jsx(Ct,{className:"w-5 h-5"}),"Watch Demo"]})]}),e.jsx("p",{className:"text-blue-200 text-sm mt-4",children:"No credit card required â€¢ 30-day free trial"})]}),e.jsx("div",{className:"relative z-10 max-w-6xl mx-auto px-6 pb-20",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-2 transform hover:scale-105 transition-all duration-500",children:e.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-8 aspect-video flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(We,{className:"w-24 h-24 text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Dashboard Preview"})]})})})})]}),e.jsx("div",{className:"py-20 px-6 bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Everything You Need"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Powerful features to streamline your business operations"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:m.map((x,g)=>{const d=x.icon;return e.jsxs("div",{className:"feature-card bg-white rounded-2xl p-8 shadow-sm hover:shadow-xl transition-all transform hover:-translate-y-2",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center mb-4",children:e.jsx(d,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:x.title}),e.jsx("p",{className:"text-gray-600",children:x.desc})]},g)})})]})}),e.jsx("div",{className:"py-20 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Simple, Transparent Pricing"}),e.jsx("p",{className:"text-xl text-gray-600",children:"Choose the plan that fits your business"})]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-8 max-w-5xl mx-auto",children:i.map((x,g)=>{const d=x.icon;return e.jsxs("div",{className:`plan-card relative bg-white rounded-2xl p-8 shadow-lg hover:shadow-2xl transition-all transform hover:scale-105 ${x.popular?"ring-4 ring-blue-600":""}`,children:[x.popular&&e.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-1 rounded-full text-sm font-bold shadow-lg",children:"Most Popular"})}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${x.popular?"bg-gradient-to-br from-blue-600 to-purple-600":"bg-gradient-to-br from-green-600 to-teal-600"}`,children:e.jsx(d,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold",children:x.name}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Package"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("span",{className:"text-5xl font-bold",children:["KSH ",x.price]}),e.jsx("span",{className:"text-gray-600",children:"/month"})]}),e.jsx("ul",{className:"space-y-3 mb-8",children:x.features.map((f,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(He,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:f})]},p))}),e.jsx("button",{onClick:()=>t("/choose-subscription"),className:`w-full py-4 rounded-xl font-bold text-lg transition-all ${x.popular?"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:shadow-xl transform hover:scale-105":"bg-gray-100 text-gray-900 hover:bg-gray-200"}`,children:"Get Started"})]},g)})})]})}),e.jsx("div",{className:"py-20 px-6 bg-gradient-to-br from-blue-600 to-purple-600",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"grid md:grid-cols-4 gap-8 text-center text-white",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-5xl font-bold mb-2",children:"500+"}),e.jsx("div",{className:"text-blue-200",children:"Active Businesses"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-5xl font-bold mb-2",children:"50K+"}),e.jsx("div",{className:"text-blue-200",children:"Transactions/Day"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-5xl font-bold mb-2",children:"99.9%"}),e.jsx("div",{className:"text-blue-200",children:"Uptime"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-5xl font-bold mb-2",children:"24/7"}),e.jsx("div",{className:"text-blue-200",children:"Support"})]})]})})}),e.jsx("div",{className:"py-20 px-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-6",children:"Ready to Transform Your Business?"}),e.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Join hundreds of businesses already using POSify to streamline their operations"}),e.jsxs("button",{onClick:()=>t("/choose-subscription"),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-12 py-4 rounded-xl font-bold text-lg hover:shadow-2xl transform hover:scale-105 transition-all inline-flex items-center gap-2",children:["Start Your Free Trial",e.jsx(De,{className:"w-5 h-5"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-4",children:"No credit card required â€¢ Cancel anytime"})]})}),e.jsx("footer",{className:"bg-gray-900 text-gray-400 py-12 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-white",children:"P"})}),e.jsx("span",{className:"text-xl font-bold text-white",children:"POSify"})]}),e.jsx("p",{className:"mb-4",children:"Modern POS System for Modern Businesses"}),e.jsx("p",{className:"text-sm",children:"Â© 2024 POSify. All rights reserved."})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"How POSify Works"}),e.jsx("button",{onClick:()=>{l(!1),n(0)},className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(Pe,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Step ",c+1," of ",o.length]}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[Math.round((c+1)/o.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${(c+1)/o.length*100}%`}})})]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:o[c].image}),e.jsx("h3",{className:"text-3xl font-bold mb-3",children:o[c].title}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:o[c].desc}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-6 text-left",children:e.jsx("p",{className:"text-gray-700",children:o[c].details})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("button",{onClick:()=>n(Math.max(0,c-1)),disabled:c===0,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),c<o.length-1?e.jsxs("button",{onClick:()=>n(c+1),className:"btn-primary flex items-center gap-2",children:["Next Step",e.jsx(De,{className:"w-4 h-4"})]}):e.jsxs("button",{onClick:()=>{l(!1),n(0),t("/choose-subscription")},className:"btn-primary bg-gradient-to-r from-blue-600 to-purple-600 flex items-center gap-2",children:["Get Started Now",e.jsx(De,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-8",children:o.map((x,g)=>e.jsx("button",{onClick:()=>n(g),className:`w-2 h-2 rounded-full transition-all ${g===c?"w-8 bg-blue-600":"bg-gray-300 hover:bg-gray-400"}`},g))})]})]})})]})}function St(){const t=Zt(),[r,l]=a.useState(t.pathname==="/auth/login"),[c,n]=a.useState("password"),[o,m]=a.useState({email:"",password:"",pin:"",name:"",newPassword:"",confirmPassword:""}),[i,x]=a.useState(""),[g,d]=a.useState(!1),[f,p]=a.useState(!1),T=ne(),{login:L}=ee(),D=()=>{try{return JSON.parse(localStorage.getItem("selectedPlan")||"null")}catch(I){return console.warn("Invalid selectedPlan in localStorage:",I),null}},W=async I=>{I.preventDefault(),x(""),d(!0);try{if(f){if(o.newPassword!==o.confirmPassword){x("Passwords do not match"),d(!1);return}if(o.newPassword.length<6){x("Password must be at least 6 characters"),d(!1);return}const q=await Se.login({email:o.email,newPassword:o.newPassword});q.token&&q.user&&(await L(q),T("/dashboard"));return}if(r){if(c==="pin"){if(!o.pin||o.pin.length!==4){x("Please enter a valid 4-digit PIN"),d(!1);return}}else if(!o.password){x("Please enter your password"),d(!1);return}}let k;if(r)if(c==="pin")try{k=await Se.pinLogin({email:o.email,pin:o.pin})}catch(q){if(q.message.includes("PIN not set"))x("PIN not set for this user. Please use password login.");else if(q.message.includes("Invalid PIN"))x("Invalid PIN. Please try again.");else throw q;d(!1);return}else k=await Se.login({email:o.email,password:o.password});else{const q=D(),u=localStorage.getItem("planId")||q?.id||"basic",P=localStorage.getItem("selectedBusinessType"),v=localStorage.getItem("selectedFeatures");k=await Se.signup({...o,planId:u,businessType:P,selectedFeatures:v?JSON.parse(v):[]})}if(k.needsPasswordSetup){p(!0),m({...o,email:k.email}),x(""),d(!1);return}if(!k||!k.user||!k.token)throw new Error("Authentication failed. Please try again.");const U={id:Date.now(),type:r?"login":"signup",user:{id:k.user.id,name:k.user.name,email:k.user.email,role:k.user.role,plan:k.user.plan},timestamp:new Date().toISOString(),ip:"Unknown",userAgent:navigator.userAgent},F=JSON.parse(localStorage.getItem("authActivities")||"[]");F.unshift(U),F.splice(50),localStorage.setItem("authActivities",JSON.stringify(F)),await L(k);const H=r?"logged in":"signed up";console.log(`âœ… User ${k.user.name} ${H} successfully`),k.user.role==="owner"?T("/main-admin"):k.user.role==="admin"?T("/admin"):k.user.role==="cashier"?T("/cashier"):T("/dashboard")}catch(k){console.error("Authentication error:",k);let U=k.message||"Authentication failed. Please try again.";k.status===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),U="Invalid credentials. Please try again."),x(U)}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-600 to-purple-600 rounded-2xl mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:"POS"})}),e.jsx("h1",{className:"text-3xl font-bold mb-2 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:r?"Welcome Back":"Get Started"}),e.jsx("p",{className:"text-gray-600",children:r?"Login to your account":"Create your account"})]}),e.jsxs("form",{onSubmit:W,className:"space-y-6",children:[f?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-gray-600 text-center mb-4",children:"Please set your password to continue."}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"New Password",className:"w-full pl-10 pr-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",value:o.newPassword,onChange:I=>m({...o,newPassword:I.target.value}),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"Confirm Password",className:"w-full pl-10 pr-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",value:o.confirmPassword,onChange:I=>m({...o,confirmPassword:I.target.value}),required:!0})]})]}):e.jsxs(e.Fragment,{children:[!r&&e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Full Name",className:"w-full pl-10 pr-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",value:o.name,onChange:I=>m({...o,name:I.target.value}),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ot,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",placeholder:"Email",className:"w-full pl-10 pr-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",value:o.email,onChange:I=>m({...o,email:I.target.value}),required:!0})]}),r&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Login Method"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n("password"),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all ${c==="password"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>n("pin"),className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all ${c==="pin"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"pin"})]})]}),r&&c==="password"&&e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"Password",className:"w-full pl-10 pr-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",value:o.password,onChange:I=>m({...o,password:I.target.value}),required:!0})]}),r&&c==="pin"&&e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"4-digit PIN",className:"w-full pl-10 pr-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",value:o.pin,onChange:I=>m({...o,pin:I.target.value.replace(/\D/g,"").slice(0,4)}),maxLength:4,required:!0})]}),!r&&e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"Password",className:"w-full pl-10 pr-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",value:o.password,onChange:I=>m({...o,password:I.target.value}),required:!0})]})]}),i&&e.jsx("div",{className:"text-red-600 text-sm text-center bg-red-50 p-3 rounded-lg",children:i}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 rounded-lg font-bold hover:from-blue-700 hover:to-purple-700 transition-all disabled:opacity-50",children:g?"Please wait...":f?"Set Password":r?"Login":"Sign Up"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("button",{onClick:()=>{l(!r),x(""),p(!1)},className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:r?"Don't have an account? Sign up":"Already have an account? Login"})})]})})}function Fs(){const[t,r]=a.useState("ultra"),[l,c]=a.useState(!1),[n,o]=a.useState({name:"",email:"",company:""}),m=ne();console.log("âœ… Subscription component mounted, navigate available:",typeof m);const i=[{id:"basic",name:"Basic",price:1e3,icon:ue,color:"from-green-500 to-teal-600",popular:!1,features:["âœ“ Admin Dashboard + Cashier POS","âœ“ Basic Inventory Management","âœ“ Sales Tracking","âœ“ Daily/Weekly Reports","âœ“ Basic Profit/Loss View","âœ“ Email Support","âœ“ 1 Cashier Only"]},{id:"ultra",name:"Ultra",price:2500,icon:nt,color:"from-blue-600 to-purple-600",popular:!0,features:["âœ“ Admin Dashboard + Cashier POS","âœ“ Full Inventory Management","âœ“ Automatic Stock Deduction","âœ“ User Management (Unlimited)","âœ“ Permission Controls","âœ“ Expense Tracking","âœ“ Advanced Analytics","âœ“ Priority Support"]}],x=d=>{d?.preventDefault?.(),console.log("[BUTTON] Get Started clicked, selected plan:",t),console.log("[BUTTON] Available plans:",i.map(p=>p.id));const f=i.find(p=>p.id===t);if(console.log("[BUTTON] Found plan:",f),!f){console.error("[BUTTON] Plan not found!"),alert("Please select a plan first");return}try{const p={id:f.id,name:f.name,price:f.price};localStorage.setItem("selectedPlan",JSON.stringify(p)),localStorage.setItem("planId",t),console.log("[BUTTON] Stored to localStorage, navigating..."),console.log("[BUTTON] Going to /auth/signup"),m("/auth/signup")}catch(p){console.error("[BUTTON] Error:",p),alert("Error: "+p.message)}},g=async d=>{d.preventDefault();try{await fetch(`${xe}/demo-requests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),alert("Demo request submitted! Admin will review and contact you."),c(!1),o({name:"",email:"",company:""})}catch(f){console.error("Demo request failed:",f),alert("Failed to submit demo request. Please try again.")}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 py-6 md:py-12 px-4 md:px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center gap-4 mb-8",children:e.jsxs("button",{onClick:()=>m("/"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 transition",children:[e.jsx(It,{size:20}),"Back to Home"]})}),e.jsxs("div",{className:"text-center mb-12 md:mb-16",children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-bold mb-3 md:mb-4 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Choose Your Plan"}),e.jsx("p",{className:"text-gray-600 text-base md:text-lg",children:"Pick the perfect plan and unlock your POS potential"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8 mb-8 md:mb-12 max-w-5xl mx-auto",children:i.map(d=>{const f=d.icon;return e.jsxs("div",{onClick:()=>r(d.id),className:`card cursor-pointer transition-all transform ${t===d.id?"ring-4 ring-blue-600 shadow-2xl scale-105 bg-gradient-to-br from-blue-50 to-purple-50":"hover:shadow-lg hover:scale-102"} relative`,children:[d.popular&&e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg",children:"Most Popular"})}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${d.color} flex items-center justify-center`,children:e.jsx(f,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-lg md:text-xl font-bold",children:d.name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("span",{className:"text-2xl md:text-3xl font-bold",children:["KSH ",d.price]}),e.jsx("span",{className:"text-gray-600 text-xs md:text-sm",children:"/month"})]}),e.jsx("ul",{className:"space-y-2",children:d.features.map((p,T)=>e.jsxs("li",{className:"flex items-start gap-2 text-xs md:text-sm",children:[e.jsx(He,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:p})]},T))})]},d.id)})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-center mt-8",children:[e.jsx("button",{type:"button",onClick:x,className:"cursor-pointer px-8 md:px-12 py-3 md:py-4 text-base md:text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all active:scale-95",children:"Get Started"}),e.jsx("button",{type:"button",onClick:()=>c(!0),className:"cursor-pointer px-8 md:px-12 py-3 md:py-4 text-base md:text-lg font-bold border-2 border-gray-300 bg-white text-gray-700 rounded-lg hover:border-gray-400 transition-all",children:"Request Free Demo"})]}),e.jsx("p",{className:"text-xs md:text-sm text-gray-500 mt-4 text-center",children:"Secure payment â€¢ Cancel anytime"}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 p-6 text-white rounded-t-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Request Free Demo"}),e.jsx("p",{className:"text-green-100 text-sm mt-1",children:"We'll contact you to schedule a demo"})]}),e.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Full Name"}),e.jsx("input",{type:"text",value:n.name,onChange:d=>o({...n,name:d.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-green-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:n.email,onChange:d=>o({...n,email:d.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-green-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Company Name"}),e.jsx("input",{type:"text",value:n.company,onChange:d=>o({...n,company:d.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-green-500",placeholder:"Optional"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 transition",children:"Submit Request"}),e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition",children:"Cancel"})]})]})]})})]})})}const rt={bar:{id:"bar",name:"Bar / Alcohol Business",description:"Drinks, happy hour pricing, brand tracking, staff shifts",icon:"Wine",color:"amber",features:["Bottle size + brand management","Happy hour pricing rules","Staff shift tracking","Profit by brand","Low stock alerts","Age-check functionality"],productFields:["name","brand","size","category","price","cost","stock"],categories:["Beer","Wine","Spirits","Beverages","Mixers"],adminModules:["inventory","staff","shifts","pricing","reports"],cashierModules:["categories","quick-tap","age-check","shift-view"]},hospital:{id:"hospital",name:"Hospital / Clinic",description:"Patient billing, services, medicines, doctor commission",icon:"Heart",color:"red",features:["Services + medicines separation","Patient search + billing","Doctor commission tracking","Batch + expiry tracking","Medicine inventory","Invoice printing"],productFields:["name","type","category","price","batchNo","expiryDate","stock"],categories:["Services","Medicines","Lab Tests","Equipment"],adminModules:["patients","services","medicines","doctors","inventory"],cashierModules:["patient-search","add-services","add-medicines","print"]},school:{id:"school",name:"School",description:"Student billing, term fees, canteen, uniform/books",icon:"BookOpen",color:"blue",features:["Student management","Term fees tracking","Canteen inventory","Uniform + books stock","Fee payment receipts","Student balance"],productFields:["name","type","category","price","stock","description"],categories:["Fees","Canteen","Uniforms","Books","Supplies"],adminModules:["students","fees","canteen","inventory","reports"],cashierModules:["student-lookup","fee-payment","canteen-sales","receipts"]},kiosk:{id:"kiosk",name:"Kiosk / Small Shop",description:"Simple inventory, supplier tracking, fast POS",icon:"Store",color:"green",features:["Simple inventory management","Supplier tracking","Price rules","Profit reports","Low stock alerts","Fast checkout"],productFields:["name","category","price","cost","stock","supplier"],categories:["General","Electronics","Food","Drinks","Supplies"],adminModules:["inventory","suppliers","pricing","reports"],cashierModules:["search","quick-scan","low-stock-alerts"]},petrol:{id:"petrol",name:"Petrol / Gas Station",description:"Fuel types, pump tracking, tank stock, shift reconciliation",icon:"Fuel",color:"yellow",features:["Fuel type management","Pump tracking","Tank stock management","Shift reconciliation","Pump totals","Attendant management"],productFields:["name","fuelType","pricePerLiter","tankCapacity","pumpId","stock"],categories:["Petrol","Diesel","Premium","LPG"],adminModules:["fuel-types","pumps","tanks","staff","reconciliation"],cashierModules:["pump-selector","fuel-buttons","shift-totals","attendant-view"]},shoes:{id:"shoes",name:"Shoe / Clothing Store",description:"Size & color variants, margin tracking, returns/refunds",icon:"Shirt",color:"pink",features:["Size + color variants","Margin per product","Returns + refunds","Variant inventory","Barcode + search POS","Stock by variant"],productFields:["name","category","price","cost","size","color","stock","margin"],categories:["Shoes","Shirts","Pants","Dresses","Accessories"],adminModules:["variants","inventory","returns","pricing","reports"],cashierModules:["variant-selector","search","barcode","returns"]}};function qs(){const t=ne(),[r,l]=a.useState(null),[c,n]=a.useState(1),o=d=>{l(d),n(2)},m=()=>{if(!r){alert("Please select a business type");return}const d=rt[r];localStorage.setItem("selectedBusinessType",r),localStorage.setItem("businessMetadata",JSON.stringify(d)),console.log("[BUILD POS] Selected business:",r),t("/auth/signup")},i=()=>{c===2?(n(1),l(null)):t("/plans")},x=r?rt[r]:null,g=Object.entries(rt).map(([d,f])=>({id:d,...f}));return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center gap-4 mb-8",children:e.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 transition p-2 rounded-lg hover:bg-white",children:[e.jsx(It,{size:20}),"Back"]})}),c===1&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Choose Your Business Type"}),e.jsx("p",{className:"text-gray-600 mb-12 text-lg",children:"Select the type that best matches your operation. We'll customize your dashboard accordingly."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(d=>e.jsxs("button",{onClick:()=>o(d.id),className:`text-left p-6 rounded-xl border-2 transition-all transform hover:scale-105 ${r===d.id?"border-blue-600 bg-blue-50 ring-2 ring-blue-400 shadow-lg":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:d.name}),e.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${r===d.id?"bg-blue-600 border-blue-600":"border-gray-300"}`,children:r===d.id&&e.jsx(He,{size:16,className:"text-white"})})]}),e.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:d.description}),e.jsx("ul",{className:"space-y-2",children:d.features.slice(0,3).map((f,p)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[e.jsx("span",{className:"text-green-600 font-bold mt-0.5",children:"â€¢"}),e.jsx("span",{children:f})]},p))})]},d.id))})]}),c===2&&x&&e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8 text-center",children:"Confirm Your Selection"}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border-2 border-blue-600",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-blue-600",children:x.name}),e.jsx("p",{className:"text-gray-600 mb-8 text-lg",children:x.description}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Your Dashboard Includes:"}),e.jsx("ul",{className:"space-y-3",children:x.features.map((d,f)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-600 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(He,{size:16,className:"text-white"})}),e.jsx("span",{className:"text-gray-700",children:d})]},f))})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-8",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-bold",children:"Custom Price:"})," 3,500 KES/month"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Your admin will be customized for ",x.name.toLowerCase(),". You can modify your selection later."]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>{n(1),l(null)},className:"flex-1 px-6 py-3 rounded-lg border-2 border-gray-300 font-bold text-gray-700 hover:bg-gray-50 transition",children:"Choose Different"}),e.jsxs("button",{onClick:m,className:"flex-1 px-6 py-3 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold hover:shadow-lg transition flex items-center justify-center gap-2",children:["Continue to Sign Up",e.jsx(De,{size:20})]})]})]})]})]})})}const Ms=()=>"https://universal-backend-w0x1.onrender.com/api".replace("https://","wss://").replace("http://","ws://");class zs{constructor(){this.ws=null,this.listeners={stock_updated:[],sale_completed:[],admin_sale_completed:[],product_created:[],product_updated:[],product_deleted:[],heartbeat:[],initial:[],error:[]},this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=3e3,this.isManualClose=!1}connect(r,l){return new Promise((c,n)=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){c();return}if(!r){n(new Error("No token provided for WebSocket connection"));return}const o=`${Ms()}/ws/products?token=${encodeURIComponent(r)}`;try{this.ws=new WebSocket(o),this.ws.onopen=()=>{console.log("âœ… WebSocket connected for real-time updates"),this.reconnectAttempts=0,c()},this.ws.onmessage=m=>{try{const i=JSON.parse(m.data),x=i.type?i.type.toLowerCase():"unknown";x==="stock_updated"?(console.log("ðŸ“¦ Stock update received:",i.data),l&&l(i.data),this.emit("stock_updated",i.data)):x==="sale_completed"?(console.log("ðŸ’° Sale completed - stock deducted:",i.data),this.emit("sale_completed",i.data),l&&i.data.updatedProducts&&l({allProducts:i.data.updatedProducts})):x==="admin_sale_completed"?(console.log("ðŸ‘¨â€ðŸ’¼ Admin sale completed:",i.data),this.emit("admin_sale_completed",i.data),this.emit("sale_completed",i.data),l&&i.data.updatedProducts&&l({allProducts:i.data.updatedProducts})):x==="product_created"?(console.log("âœ¨ Product created:",i.data),this.emit("product_created",i.data)):x==="product_updated"?(console.log("ðŸ“ Product updated:",i.data),this.emit("product_updated",i.data),l&&i.data.allProducts&&l({allProducts:i.data.allProducts})):x==="product_deleted"?(console.log("ðŸ—‘ï¸ Product deleted:",i.data),this.emit("product_deleted",i.data),l&&i.data.allProducts&&l({allProducts:i.data.allProducts})):x==="initial"?(console.log("ðŸ“¦ Initial products loaded via WebSocket"),this.emit("initial",i.products)):x==="heartbeat"?this.emit("heartbeat",i):(console.log(`ðŸ“¨ Message received (${x}):`,i.data),x!=="unknown"&&this.emit(x,i.data))}catch(i){console.error("Error parsing WebSocket message:",i)}},this.ws.onerror=m=>{console.error("âŒ WebSocket error:",m),this.emit("error",m),n(m)},this.ws.onclose=()=>{console.log("ðŸ”Œ WebSocket disconnected"),this.isManualClose||this.attemptReconnect(r,l)}}catch(m){console.error("Failed to create WebSocket:",m),n(m)}})}attemptReconnect(r,l){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.log("Max reconnection attempts reached");return}this.reconnectAttempts++;const c=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);console.log(`ðŸ”„ Reconnecting in ${c}ms (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.connect(r,l).catch(n=>{console.error("Reconnection failed:",n)})},c)}on(r,l){this.listeners[r]||(this.listeners[r]=[]),this.listeners[r].push(l)}emit(r,l){this.listeners[r]&&this.listeners[r].forEach(c=>{try{c(l)}catch(n){console.error(`Error in ${r} listener:`,n)}})}disconnect(){this.isManualClose=!0,this.ws&&(this.ws.close(),this.ws=null)}isConnected(){return this.ws&&this.ws.readyState===WebSocket.OPEN}}const Me=new zs;function _s({isLocked:t,onUnlock:r,userPin:l,userName:c="Cashier"}){const[n,o]=a.useState(""),[m,i]=a.useState(""),[x,g]=a.useState(0),[d,f]=a.useState(!1);a.useEffect(()=>{t&&(i(""),o(""),g(0),f(!1))},[t]),a.useEffect(()=>{x>=3&&(f(!0),setTimeout(()=>{f(!1),g(0)},3e4))},[x]);const p=D=>{d||n.length<4&&(o(W=>W+D),i(""))},T=()=>{d||(o(D=>D.slice(0,-1)),i(""))},L=()=>{if(d){i("Too many attempts. Please wait.");return}if(n.length!==4){i("PIN must be 4 digits");return}String(n)===String(l)?(o(""),i(""),r()):(i("Incorrect PIN"),g(D=>D+1),o(""))};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[9999] backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-96 max-w-full mx-4",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"bg-red-100 p-4 rounded-full",children:e.jsx(le,{className:"w-12 h-12 text-red-600"})})}),e.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-2",children:"Screen Locked"}),e.jsxs("p",{className:"text-center text-gray-600 mb-6",children:[c,", enter your PIN to continue"]}),e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 mb-6 flex justify-center gap-2",children:[0,1,2,3].map(D=>e.jsx("div",{className:"w-12 h-12 bg-white border-2 border-gray-300 rounded-lg flex items-center justify-center font-bold text-xl text-gray-800",children:n[D]?"â—":""},D))}),m&&e.jsxs("div",{className:`text-center text-sm font-medium mb-4 p-2 rounded ${m.includes("Incorrect")?"bg-red-100 text-red-700":m.includes("must be")?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[m,x>0&&x<3&&e.jsxs("p",{className:"text-xs mt-1",children:[3-x," attempt",3-x!==1?"s":""," remaining"]}),d&&e.jsx("p",{className:"text-xs mt-1",children:"Locked. Try again in 30 seconds."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[[1,2,3,4,5,6,7,8,9].map(D=>e.jsx("button",{onClick:()=>p(String(D)),disabled:d||n.length>=4,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white font-bold py-3 rounded-lg transition-colors text-lg",children:D},D)),e.jsx("button",{onClick:()=>p("0"),disabled:d||n.length>=4,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white font-bold py-3 rounded-lg transition-colors col-span-1 text-lg",children:"0"}),e.jsxs("button",{onClick:T,disabled:d||n.length===0,className:"bg-red-500 hover:bg-red-600 disabled:bg-gray-300 text-white font-bold py-3 rounded-lg transition-colors col-span-2 flex items-center justify-center gap-2",children:[e.jsx(Pe,{size:16}),"Back"]})]}),e.jsx("button",{onClick:L,disabled:d||n.length!==4,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-300 text-white font-bold py-3 rounded-lg transition-colors mb-3",children:d?"Locked":"Unlock"}),e.jsx("p",{className:"text-center text-xs text-gray-500 mt-4",children:"Enter your 4-digit PIN"})]})}):null}function Js(){const[t,r]=a.useState([]),[l,c]=a.useState([]);a.useEffect(()=>{const m=async()=>{try{const x=await ce.getLowStockWarnings?.();x?.warnings&&r(x.warnings)}catch(x){console.warn("Failed to fetch low-stock warnings:",x)}};m();const i=setInterval(m,1e4);return()=>clearInterval(i)},[]);const n=t.filter(m=>!l.includes(m.id));if(n.length===0)return null;const o=m=>{c([...l,m])};return e.jsx("div",{className:"fixed top-24 right-6 max-w-md space-y-2 z-40",children:n.map(m=>e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded shadow-lg animate-pulse",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ge,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900",children:"âš ï¸ Stock Warning"}),e.jsxs("p",{className:"text-sm text-red-800 mt-1",children:[e.jsx("strong",{children:m.name}),": ",m.quantity,m.unit," remaining"]}),e.jsxs("p",{className:"text-xs text-red-700 mt-0.5",children:["Threshold: ",m.threshold,m.unit]})]})]}),e.jsx("button",{onClick:()=>o(m.id),className:"text-red-600 hover:text-red-900 flex-shrink-0",children:e.jsx(Pe,{className:"w-4 h-4"})})]})},m.id))})}function Ws(){const{user:t,logout:r}=ee(),{products:l,refreshProducts:c}=Lt(),{isLocked:n,lock:o,unlock:m}=$t(),[i,x]=a.useState([]),[g,d]=a.useState([]),[f,p]=a.useState([]),[T,L]=a.useState("cash"),[D,W]=a.useState("pos"),[I,k]=a.useState({sales:[],expenses:[],stats:{}}),[U,F]=a.useState(""),[H,q]=a.useState(!1),[u,P]=a.useState(!1),[v,A]=a.useState(null),[M,N]=a.useState({name:"",price:"",cost:"",category:"finished",image:""}),[$,Y]=a.useState({quantity:"",expiryDate:"",batchNumber:"",cost:""}),[Z,he]=a.useState(!1),[pe,je]=a.useState(!1),[G,ge]=a.useState({customerName:"",amount:"",reason:"",notes:""}),[h,w]=a.useState(!1),[O,R]=a.useState({description:"",amount:"",category:""}),[K,z]=a.useState(""),[te,oe]=a.useState([]),[E,Ne]=a.useState(null),[se,Ue]=a.useState("exclusive"),[Qe,Ie]=a.useState(!1),[oa,Re]=a.useState(null),[mt,Ae]=a.useState(null),[Xe,xt]=a.useState({}),[Be,ut]=a.useState(!1),[ia,ht]=a.useState(!1),[ca,ve]=a.useState(!1),[da,Ut]=a.useState(Date.now()),[ma,Rt]=a.useState(0);a.useEffect(()=>{fe(),c();const s=localStorage.getItem(`cart_${t?.id}`),b=localStorage.getItem(`paymentMethod_${t?.id}`),y=localStorage.getItem(`selectedDiscount_${t?.id}`),S=localStorage.getItem(`taxType_${t?.id}`);if(s)try{p(JSON.parse(s))}catch(B){console.warn("Failed to restore cart:",B)}if(b&&L(b),S&&Ue(S),y)try{Ne(JSON.parse(y))}catch{}qt();const C=localStorage.getItem("token");C&&Me.connect(C,B=>{if(console.log("ðŸ“¡ WebSocket callback received:",B),B&&B.allProducts){console.log(`ðŸ“¦ Merging ${B.allProducts.length} products from WebSocket`);const _=B.allProducts.filter(me=>me.visibleToCashier!==!1&&!me.expenseOnly);x(_)}B&&B.productId!==void 0&&B.newQuantity!==void 0&&(console.log(`ðŸ“¦ Stock update for product ${B.productId}: ${B.newQuantity}${B.unit||""}`),x(_=>_.map(ie=>ie.id===B.productId?{...ie,quantity:B.newQuantity}:ie))),B&&B.discounts&&(console.log("ðŸ“Š Discount list updated"),oe(B.discounts)),B&&B.sale&&(console.log("ðŸ’° Sale detected, reloading stats"),fe())}).catch(B=>{console.warn("âš ï¸ WebSocket connection failed:",B)});const V=vt(B=>{try{if(!B)return;console.log("ðŸ“¨ Product subscription message:",B.type),(B.type==="initial"||B.type==="products_snapshot"||B.type==="product_created"||B.type==="product_updated"||B.type==="product_deleted")&&ce.getAll().then(_=>{const me=_.filter(ie=>ie.visibleToCashier!==!1&&!ie.expenseOnly);console.log(`âœ… Subscription update: ${me.length} products`),x(me)}).catch(_=>{console.error("Failed to fetch products from subscription:",_)})}catch(_){console.error("âŒ Product subscription handler error",_)}}),we=setInterval(()=>{console.log("ðŸ”„ Auto-refreshing products..."),ht(!0),c().finally(()=>ht(!1))},3e4);return()=>{clearInterval(we);try{V()}catch{}Me.disconnect()}},[t?.id]),a.useEffect(()=>{if(l){const s=l.filter(b=>b.visibleToCashier!==!1&&!b.expenseOnly&&!b.pendingDelete);x(s),Ut(Date.now()),Rt(b=>b+1)}},[l]),a.useEffect(()=>{const s=localStorage.getItem("token");s&&Me.connect(s,y=>{if(console.log("ðŸ“¡ WebSocket callback received:",y),y&&y.allProducts){console.log(`ðŸ“¦ Merging ${y.allProducts.length} products from WebSocket`);const S=y.allProducts.filter(C=>C.visibleToCashier!==!1&&!C.expenseOnly);x(S)}y&&y.productId!==void 0&&y.newQuantity!==void 0&&(console.log(`ðŸ“¦ Stock update for product ${y.productId}: ${y.newQuantity}${y.unit||""}`),x(S=>S.map(V=>V.id===y.productId?{...V,quantity:y.newQuantity}:V))),y&&y.discounts&&(console.log("ðŸ“Š Discount list updated"),oe(y.discounts)),y&&y.sale&&(console.log("ðŸ’° Sale detected, reloading stats"),fe())}).catch(y=>{console.warn("âš ï¸ WebSocket connection failed:",y)});const b=vt(y=>{try{if(!y)return;console.log("ðŸ“¨ Product subscription message:",y.type),(y.type==="initial"||y.type==="products_snapshot"||y.type==="product_created"||y.type==="product_updated"||y.type==="product_deleted")&&ce.getAll().then(S=>{const C=S.filter(V=>V.visibleToCashier!==!1&&!V.expenseOnly);console.log(`âœ… Subscription update: ${C.length} products`),x(C)}).catch(S=>{console.error("Failed to fetch products from subscription:",S)})}catch(S){console.error("âŒ Product subscription handler error",S)}});return()=>{try{b()}catch{}Me.disconnect()}},[]),a.useEffect(()=>{(f.length>0||T||se)&&pt()},[f,T,se,E,t?.id]);const pt=()=>{localStorage.setItem(`cart_${t?.id}`,JSON.stringify(f)),localStorage.setItem(`paymentMethod_${t?.id}`,T),localStorage.setItem(`taxType_${t?.id}`,se),E&&localStorage.setItem(`selectedDiscount_${t?.id}`,JSON.stringify(E))},Bt=async()=>{try{ve(!0);const s=await st.create("clock_in");Re(s),Ie(!0);const b=new Date(s.clockInTime);Ae(b),localStorage.setItem(`clockIn_${t?.id}_${new Date().toDateString()}`,b.toISOString()),console.log("âœ… Clocked in successfully"),alert("âœ… Clocked in successfully at "+b.toLocaleTimeString())}catch(s){console.error("Clock in failed:",s),alert("âŒ Clock in failed: "+(s.message||"Unknown error"))}finally{ve(!1)}},Ft=async()=>{try{ve(!0);const s=await st.create("clock_out");Re(s),Ie(!1),Ae(null),localStorage.removeItem(`clockIn_${t?.id}_${new Date().toDateString()}`),console.log("âœ… Clocked out successfully");const b=s.duration?`${s.duration} minutes`:"unknown duration";alert("âœ… Clocked out successfully. Duration: "+b)}catch(s){console.error("Clock out failed:",s),alert("âŒ Clock out failed: "+(s.message||"Unknown error"))}finally{ve(!1)}},qt=async()=>{try{const s=await st.getStatus();s.isClockedIn?(Ie(!0),Ae(new Date(s.clockInTime)),Re(s),console.log("âœ… User is clocked in since:",s.clockInTime)):(Ie(!1),Ae(null),Re(null),console.log("User is not clocked in"))}catch(s){console.warn("Failed to check clock status:",s),Ie(!1),Ae(null)}},fe=async()=>{try{const[s,b,y,S,C,V]=await Promise.all([ce.getAll(),Ee.getAll(),ct.getAll(),dt.get(),Nt.getAll(),Is.getAll().catch(()=>[])]);x(s.filter(we=>we.visibleToCashier!==!1&&!we.expenseOnly)),k({sales:b,expenses:y,stats:S}),d(C),oe(V||[])}catch(s){console.error("Failed to load data:",s)}},Mt=(s,b=!0)=>{const y=s.target.files[0];if(y){const S=new FileReader;S.onload=C=>{const V=C.target.result;z(V),b&&N({...M,image:V})},S.readAsDataURL(y)}},Fe=s=>g.filter(y=>y.productId===s&&y.quantity>0).reduce((y,S)=>y+S.quantity,0),zt=s=>{const b=Fe(s.id);if(b<=0){alert("Product is out of stock!");return}const y=f.find(C=>C.id===s.id);if((y?y.quantity:0)>=b){alert(`Only ${b} units available in stock!`);return}p(y?f.map(C=>C.id===s.id?{...C,quantity:C.quantity+1}:C):[...f,{...s,quantity:1}])},Ze=(s,b)=>{i.find(S=>S.id===s);const y=Fe(s);p(f.map(S=>{if(S.id===s){const C=S.quantity+b;return C>y?(alert(`Only ${y} units available!`),S):{...S,quantity:Math.max(1,C)}}return S}).filter(S=>S.quantity>0))},_t=s=>{p(f.filter(b=>b.id!==s))},X=f.reduce((s,b)=>s+b.price*b.quantity,0),Jt=async()=>{if(console.log("ðŸ›’ handleCheckout called, cart:",f,"checkoutLoading:",Be),f.length===0||Be){console.log("âš ï¸ Checkout blocked: cart empty or already processing");return}ut(!0),ve(!0);try{console.log("ðŸ’³ Processing checkout...");const s=E?E.type==="percentage"?X*E.value/100:E.value:0;let b=0,y=0;se==="inclusive"?(b=X/1.16*.16,y=X-s):(b=(X-s)*.16,y=X-s+b);const S=f.map(_=>({productId:_.id,quantity:_.quantity,unit:Xe[_.id]||_.unit||"piece",price:_.price}));if(console.log("ðŸ“¤ Creating ATOMIC sale with items:",S),console.log("ðŸ’° Total:",y,"Discount:",s,"Tax:",b,"Tax Type:",se),!Ee||typeof Ee.create!="function")throw new Error("Sales API not properly loaded");const C=await Ee.create({items:S,total:y,discount:s,tax:b,taxType:se,paymentMethod:T});if(console.log("âœ… ATOMIC Sale completed successfully:",C),!C)throw new Error("No response from server");if(!C.success)throw new Error(C.error||"Sale creation failed");if(!C.saleId)throw console.error("âŒ Invalid response structure:",C),new Error("Invalid sale response - no saleId returned");const V=C.saleId;console.log(`âœ… Sale ID: ${V}, Processing Time: ${C.processingTime}, Stock deductions:`,C.stockDeductions);const we={id:V,items:S,total:y,discount:s,tax:b,taxType:se,paymentMethod:T,accountId:t?.accountId,cashierId:t?.id,cashierName:t?.name||"Cashier",stockDeductions:C.stockDeductions||{products:[],expenses:[]},createdAt:new Date().toISOString()};C.updatedProducts&&(x(C.updatedProducts),console.log("âœ… Product quantities updated with atomic deductions")),k(_=>({..._,sales:[we,..._.sales]})),console.log("âœ… Sale added to UI immediately"),p([]),xt({}),Ne(null),Ue("exclusive");const B=C.stockDeductions?.map?.(_=>`${_.name||_.productName}: -${_.quantity}${_.unit}`).join(`
`)||"None";console.log("âœ… Sale completed successfully!"),console.log("ðŸ”” Low-stock warnings:",C.lowStockWarnings),alert(`âœ… SALE COMPLETE!
Sale ID: #${V}
Amount: KSH ${y.toLocaleString()}
Time: ${C.processingTime}

Stock Deducted:
${B}`),console.log("ðŸ”„ Refreshing product inventory and checking warnings in background..."),(async()=>{try{const _=await ce.getAll();console.log(`ðŸ“¦ Received ${_.length} products from server`);const me=_.filter(ie=>ie.visibleToCashier!==!1&&!ie.expenseOnly);if(console.log(`âœ… Filtered to ${me.length} visible products`),x(me),C.lowStockWarnings&&C.lowStockWarnings.length>0){const ie=C.lowStockWarnings.map(et=>`${et.name}: ${et.quantity}${et.unit} (âš ï¸ Low!)`).join(`
`);console.warn(`âš ï¸ Low-stock warning:
`+ie)}}catch(_){console.warn("Background product refresh failed:",_)}})()}catch(s){console.error("âŒ Checkout failed:",s.message,s),alert(`âŒ Sale failed: ${s.message||"Unknown error occurred"}`)}finally{ut(!1),ve(!1)}},Wt=async s=>{s.preventDefault();try{console.log("âž• Creating new product:",M.name);const b=await ce.create({...M,price:parseFloat(M.price),cost:parseFloat(M.cost||0),quantity:0});console.log("âœ… Product created:",b),N({name:"",price:"",cost:"",category:"finished",image:""}),z(""),q(!1),console.log("ðŸ”„ Reloading data..."),await fe(),console.log("âœ… Product added successfully!"),alert("âœ… Product added successfully!")}catch(b){console.error("âŒ Failed to add product:",b.message,b),alert(`âŒ Failed to add product: ${b.message||"Unknown error"}`)}},Kt=async s=>{s.preventDefault();try{const b=Array.isArray(g)?g:[],S={id:b.length>0?Math.max(...b.map(C=>C.id||0))+1:1,productId:v.id,quantity:parseInt($.quantity),expiryDate:$.expiryDate,batchNumber:$.batchNumber||`BATCH-${Date.now()}`,cost:parseFloat($.cost||v.cost||0)};d(C=>[...C,S]),await Nt.create({productId:v.id,quantity:parseInt($.quantity),expiryDate:$.expiryDate,batchNumber:$.batchNumber||`BATCH-${Date.now()}`,cost:parseFloat($.cost||v.cost||0)}),Y({quantity:"",expiryDate:"",batchNumber:"",cost:""}),P(!1),A(null),await fe(),alert("Stock added successfully!")}catch(b){console.error("Failed to add stock:",b),alert("Failed to add stock")}},Ht=async s=>{s.preventDefault();try{await ct.create({...O,amount:parseFloat(O.amount)}),R({description:"",amount:"",category:""}),he(!1),await fe()}catch(b){console.error("Failed to add expense:",b),alert("Failed to add expense")}},Gt=async s=>{if(s.preventDefault(),!G.customerName||!G.amount){alert("Please fill in all required fields");return}w(!0);try{const b=await As.create({customerName:G.customerName,amount:parseFloat(G.amount),reason:G.reason,notes:G.notes});console.log("âœ… Credit request submitted:",b),ge({customerName:"",amount:"",reason:"",notes:""}),je(!1),alert("âœ… Credit request submitted successfully!")}catch(b){console.error("Failed to submit credit request:",b),alert("âŒ Failed to submit credit request: "+(b.message||"Unknown error"))}finally{w(!1)}},Yt=async()=>{if(window.confirm("Are you sure you want to clear all sales and expenses? This action cannot be undone."))try{const s=localStorage.getItem("token"),y=await fetch(`${xe}/clear-data`,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({type:"all"})});if(!y.ok){const S=await y.json();throw new Error(S.message||"Failed to clear data")}k({sales:[],expenses:[],stats:{totalSales:0,totalExpenses:0,profit:0}}),p([]),alert("Data cleared successfully!"),await fe()}catch(s){console.error("Failed to clear data:",s),alert("Failed to clear data: "+s.message)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex flex-col",children:[e.jsx(Js,{}),e.jsx("nav",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 px-6 py-4 sticky top-0 z-50 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-green-600 to-teal-600 bg-clip-text text-transparent",children:"Cashier Dashboard"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Cashier Plan - KSH 900/month"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t?.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t?.email})]}),Qe&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs text-green-600 font-semibold",children:"ðŸŸ¢ Clocked In"}),e.jsxs("button",{onClick:Ft,className:"px-4 py-2 rounded-lg font-medium transition-all bg-red-600 hover:bg-red-700 text-white flex items-center gap-2 shadow-md",children:[e.jsx(os,{className:"w-4 h-4"}),"Clock Out"]})]}),!Qe&&e.jsxs("button",{onClick:Bt,className:"px-4 py-2 rounded-lg font-medium transition-all bg-green-600 hover:bg-green-700 text-white flex items-center gap-2 shadow-md",children:[e.jsx(Ct,{className:"w-4 h-4"}),"Clock In"]}),e.jsxs("button",{onClick:()=>{pt(),r()},className:"px-4 py-2 rounded-lg font-medium transition-all bg-red-100 hover:bg-red-200 text-red-600 border border-red-300 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Logout"]}),e.jsxs("button",{onClick:Yt,className:"px-4 py-2 rounded-lg font-medium transition-all bg-orange-100 hover:bg-orange-200 text-orange-600 border border-orange-300 flex items-center gap-2",children:[e.jsx(lt,{className:"w-4 h-4"}),"Clear"]}),e.jsxs("button",{onClick:()=>je(!0),className:"px-4 py-2 rounded-lg font-medium transition-all bg-blue-100 hover:bg-blue-200 text-blue-600 border border-blue-300 flex items-center gap-2",children:[e.jsx(ft,{className:"w-4 h-4"}),"Request Credit"]}),Qe&&mt&&e.jsx("div",{className:"ml-auto text-right text-xs",children:e.jsxs("p",{className:"text-green-600 font-semibold flex items-center gap-1",children:[e.jsx(Oe,{className:"w-4 h-4"}),"Clocked In: ",mt.toLocaleTimeString()]})})]})]})}),e.jsxs("div",{className:"flex gap-2 px-6 py-4 bg-white border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>W("pos"),className:`px-6 py-2 rounded-lg font-medium transition-all ${D==="pos"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(ze,{className:"w-4 h-4 inline mr-2"}),"POS"]}),e.jsxs("button",{onClick:()=>W("monitor"),className:`px-6 py-2 rounded-lg font-medium transition-all ${D==="monitor"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(We,{className:"w-4 h-4 inline mr-2"}),"Monitor"]}),e.jsxs("button",{onClick:()=>W("products"),className:`px-6 py-2 rounded-lg font-medium transition-all ${D==="products"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(ke,{className:"w-4 h-4 inline mr-2"}),"Products"]}),e.jsxs("button",{onClick:()=>W("expenses"),className:`px-6 py-2 rounded-lg font-medium transition-all ${D==="expenses"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(Le,{className:"w-4 h-4 inline mr-2"}),"Expenses"]})]}),D==="pos"&&e.jsxs("div",{className:"flex-1 flex",children:[e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"input pl-10",value:U,onChange:s=>F(s.target.value)})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:i.filter(s=>s.name?.toLowerCase().includes(U.toLowerCase())).map(s=>{const b=Fe(s.id),y=b<10,S=b<=0;return e.jsxs("button",{onClick:()=>zt(s),disabled:S,className:`card text-left hover:shadow-xl transition-all transform hover:scale-105 relative ${S?"opacity-50 cursor-not-allowed bg-gray-100":"bg-gradient-to-br from-white to-gray-50"}`,children:[s.image&&e.jsx("div",{className:"w-full h-32 mb-3 rounded-lg overflow-hidden bg-gray-100",children:e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover"})}),y&&!S&&e.jsx("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white p-1 rounded-full",children:e.jsx(Ge,{className:"w-4 h-4"})}),S&&e.jsx("div",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:"OUT"}),e.jsx("h3",{className:"font-semibold mb-2 text-gray-900",children:s.name}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:["KSH ",s.price?.toLocaleString()]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("p",{className:`text-xs font-medium ${S?"text-red-600":y?"text-yellow-600":"text-gray-500"}`,children:["Stock: ",b]}),y&&!S&&e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full font-medium",children:"Low Stock"})]})]},s.id)})})]}),e.jsxs("div",{className:"w-96 bg-white border-l border-gray-200 p-6 flex flex-col shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-600 to-teal-600 rounded-xl flex items-center justify-center",children:e.jsx(ze,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Cart"}),e.jsxs("span",{className:"ml-auto bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-semibold",children:[f.length," items"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-6",children:f.length===0?e.jsxs("div",{className:"text-center mt-16",children:[e.jsx(ze,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Cart is empty"})]}):e.jsx("div",{className:"space-y-3",children:f.map(s=>e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("button",{onClick:()=>_t(s.id),className:"text-red-600 hover:bg-red-50 p-1 rounded",children:e.jsx(lt,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ze(s.id,-1),className:"w-8 h-8 rounded-lg bg-white shadow-sm flex items-center justify-center hover:bg-gray-100 transition-colors",children:e.jsx(is,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-10 text-center font-semibold",children:s.quantity}),e.jsx("button",{onClick:()=>Ze(s.id,1),className:"w-8 h-8 rounded-lg bg-white shadow-sm flex items-center justify-center hover:bg-gray-100 transition-colors",children:e.jsx(be,{className:"w-4 h-4"})})]}),e.jsxs("span",{className:"font-bold text-green-600",children:["KSH ",(s.price*s.quantity).toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2 items-center mt-2",children:[e.jsx("label",{className:"text-xs font-semibold text-gray-600",children:"Unit:"}),e.jsxs("select",{value:Xe[s.id]||s.unit||"piece",onChange:b=>{xt({...Xe,[s.id]:b.target.value})},className:"text-xs px-2 py-1 border border-gray-300 rounded bg-white",children:[e.jsx("option",{value:"piece",children:"Piece"}),e.jsx("option",{value:"kg",children:"Kilogram (kg)"}),e.jsx("option",{value:"g",children:"Grams (g)"}),e.jsx("option",{value:"l",children:"Liters (L)"})]}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",max:"999",placeholder:"qty",defaultValue:s.quantity,className:"text-xs px-2 py-1 border border-gray-300 rounded w-16",onChange:b=>{const y=parseFloat(b.target.value);!isNaN(y)&&y>0&&Ze(s.id,y-s.quantity)}})]})]},s.id))})}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2 bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{className:"text-gray-700",children:["KSH ",X.toLocaleString()]})]}),E&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-KSH ",(E.type==="percentage"?X*E.value/100:E.value).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-orange-600",children:[e.jsxs("span",{children:["Tax (",se==="exclusive"?"Added":"Included","):"]}),e.jsxs("span",{children:[se==="exclusive"?"+":"","KSH ",((X-(E?E.type==="percentage"?X*E.value/100:E.value:0))*.16).toLocaleString()]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Final Total:"}),e.jsxs("span",{className:"text-green-600",children:["KSH ",(se==="exclusive"?X-(E?E.type==="percentage"?X*E.value/100:E.value:0)+(X-(E?E.type==="percentage"?X*E.value/100:E.value:0))*.16:X-(E?E.type==="percentage"?X*E.value/100:E.value:0)).toLocaleString()]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Discount (Optional)"}),e.jsxs("select",{value:E?.id||"",onChange:s=>{s.target.value?Ne(te.find(b=>b.id===parseInt(s.target.value))):Ne(null)},className:"input",children:[e.jsx("option",{value:"",children:"No Discount"}),te.filter(s=>s.active).map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.type==="percentage"?`${s.value}%`:`KSH ${s.value}`]},s.id))]}),E&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Discount: KSH ",(E.type==="percentage"?X*E.value/100:E.value).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Tax Type"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"exclusive",checked:se==="exclusive",onChange:s=>Ue(s.target.value)}),e.jsx("span",{className:"text-sm",children:"Tax Exclusive (16% added)"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"inclusive",checked:se==="inclusive",onChange:s=>Ue(s.target.value)}),e.jsx("span",{className:"text-sm",children:"Tax Inclusive"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Payment Method"}),e.jsxs("select",{value:T,onChange:s=>L(s.target.value),className:"input",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"mpesa",children:"M-Pesa"}),e.jsx("option",{value:"card",children:"Card"})]})]}),e.jsx("button",{onClick:()=>{try{console.log("ðŸ›’ Complete Sale button clicked"),Jt()}catch(s){console.error("âŒ Button handler error:",s),alert(`Error: ${s.message}`)}},disabled:f.length===0||Be,className:"btn-primary w-full py-4 text-lg bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:Be?"â³ Processing Sale...":"Complete Sale"})]})]})]}),D==="monitor"&&e.jsxs("div",{className:"p-6 max-w-7xl mx-auto w-full",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"card bg-gradient-to-br from-green-500 to-emerald-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-100 mb-1",children:"Total Sales"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",I.stats.totalSales?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(Je,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-red-500 to-pink-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-100 mb-1",children:"Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",I.stats.totalExpenses?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(Le,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-blue-500 to-indigo-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Net Profit"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",I.stats.profit?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(Je,{className:"w-8 h-8"})})]})})]}),e.jsxs("div",{className:"card shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Sales"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock Deducted"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"})]})}),e.jsx("tbody",{children:I.sales&&I.sales.slice(-15).reverse().map((s,b)=>{const y=s.stockDeductions?.products?.slice(0,2).map(S=>`${S.name}: -${S.deducted}${S.unit}`).join(", ")+(s.stockDeductions?.products?.length>2?"...":"")||"None";return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:new Date(s.createdAt).toLocaleString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[s.items?.length||0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:s.paymentMethod||"cash"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-orange-600 font-semibold",children:y}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",s.total?.toLocaleString()]})]},b)})})]})})]}),e.jsxs("div",{className:"card shadow-lg mt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-orange-600"}),"Stock Deductions Log"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-orange-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Sale ID"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Before"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Deducted"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"After"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Unit"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Time"})]})}),e.jsx("tbody",{children:I.sales&&I.sales.slice(-20).reverse().map(s=>s.stockDeductions?.products?.map((b,y)=>e.jsxs("tr",{className:"border-t border-orange-100 hover:bg-orange-50 transition-colors",children:[e.jsxs("td",{className:"px-4 py-3 font-medium text-blue-600",children:["#",s.id]}),e.jsx("td",{className:"px-4 py-3",children:b.name}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:b.before}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-red-600",children:["-",b.deducted]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-green-600",children:b.after}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:b.unit}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:new Date(s.createdAt).toLocaleTimeString()})]},`${s.id}-${y}`)))})]}),(!I.sales||I.sales.length===0||!I.sales.some(s=>s.stockDeductions?.products?.length>0))&&e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No stock deductions yet"})]})]})]}),e.jsx("div",{className:"p-6 max-w-7xl mx-auto w-full",children:e.jsxs("div",{className:"card shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Manage Products & Stock"}),e.jsxs("button",{onClick:()=>q(!0),className:"btn-primary flex items-center gap-2 bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700",children:[e.jsx(be,{className:"w-4 h-4"}),"Add Product"]})]}),H&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-green-50 to-teal-50 rounded-xl border-2 border-green-200",children:[e.jsx("h4",{className:"font-semibold mb-4 text-lg",children:"Add New Product"}),e.jsxs("form",{onSubmit:Wt,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name",className:"input",value:M.name,onChange:s=>N({...M,name:s.target.value}),required:!0}),e.jsxs("select",{className:"input",value:M.category,onChange:s=>N({...M,category:s.target.value}),children:[e.jsx("option",{value:"finished",children:"Finished Product"}),e.jsx("option",{value:"raw",children:"Raw Material"}),e.jsx("option",{value:"service",children:"Service"})]}),e.jsx("input",{type:"number",placeholder:"Selling Price",className:"input",value:M.price,onChange:s=>N({...M,price:s.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Cost Price (Optional)",className:"input",value:M.cost,onChange:s=>N({...M,cost:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Product Image"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:s=>Mt(s,!0),className:"input"}),e.jsx(cs,{className:"w-5 h-5 text-gray-400"})]}),K&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:K,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Product"}),e.jsx("button",{type:"button",onClick:()=>{q(!1),z(""),N({name:"",price:"",cost:"",category:"finished",image:""})},className:"btn-secondary",children:"Cancel"})]})]})]}),u&&v&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border-2 border-blue-200",children:[e.jsxs("h4",{className:"font-semibold mb-4 text-lg",children:["Add Stock for ",v.name]}),e.jsxs("form",{onSubmit:Kt,className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("input",{type:"number",placeholder:"Quantity",className:"input",value:$.quantity,onChange:s=>Y({...$,quantity:s.target.value}),required:!0}),e.jsx("input",{type:"date",placeholder:"Expiry Date (Optional)",className:"input",value:$.expiryDate,onChange:s=>Y({...$,expiryDate:s.target.value})}),e.jsx("input",{type:"text",placeholder:"Batch Number (Optional)",className:"input",value:$.batchNumber,onChange:s=>Y({...$,batchNumber:s.target.value})}),e.jsx("input",{type:"number",placeholder:"Cost per Unit",className:"input",value:$.cost,onChange:s=>Y({...$,cost:s.target.value})}),e.jsxs("div",{className:"flex gap-2 md:col-span-4",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Stock"}),e.jsx("button",{type:"button",onClick:()=>{P(!1),A(null),Y({quantity:"",expiryDate:"",batchNumber:"",cost:""})},className:"btn-secondary",children:"Cancel"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Batches"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:i.map(s=>{const b=Fe(s.id),y=g.filter(C=>C.productId===s.id&&C.quantity>0),S=b<10;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.image&&e.jsx("img",{src:s.image,alt:s.name,className:"w-10 h-10 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.category})]})]})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",s.price?.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-medium ${b===0?"text-red-600":S?"text-yellow-600":"text-gray-900"}`,children:b}),S&&b>0&&e.jsx(Ge,{className:"w-4 h-4 text-yellow-500"}),b===0&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full font-medium",children:"Out of Stock"})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:"text-gray-600",children:[y.length," active"]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{A(s),P(!0)},className:"p-2 hover:bg-blue-50 rounded-lg text-blue-600 transition-colors",title:"Add Stock",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 hover:bg-green-50 rounded-lg text-green-600 transition-colors",title:"Edit Product",children:e.jsx(Pt,{className:"w-4 h-4"})})]})})]},s.id)})})]})})]})}),")}",D==="expenses"&&e.jsx("div",{className:"p-6 max-w-7xl mx-auto w-full",children:e.jsxs("div",{className:"card shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Track Expenses"}),e.jsxs("button",{onClick:()=>he(!0),className:"btn-primary flex items-center gap-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700",children:[e.jsx(be,{className:"w-4 h-4"}),"Add Expense"]})]}),Z&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-red-50 to-pink-50 rounded-xl border-2 border-red-200",children:[e.jsx("h4",{className:"font-semibold mb-4 text-lg",children:"Add New Expense"}),e.jsxs("form",{onSubmit:Ht,className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Description",className:"input",value:O.description,onChange:s=>R({...O,description:s.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Amount",className:"input",value:O.amount,onChange:s=>R({...O,amount:s.target.value}),required:!0}),e.jsx("input",{type:"text",placeholder:"Category",className:"input",value:O.category,onChange:s=>R({...O,category:s.target.value})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add"}),e.jsx("button",{type:"button",onClick:()=>he(!1),className:"btn-secondary",children:"Cancel"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Amount"})]})}),e.jsx("tbody",{children:I.expenses.slice().reverse().map((s,b)=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.description}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-warning",children:s.category||"General"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-red-600",children:["KSH ",s.amount?.toLocaleString()]})]},b))})]})})]})}),pe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-96 overflow-y-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white flex justify-between items-center sticky top-0",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ft,{}),"Request Credit"]}),e.jsx("button",{onClick:()=>je(!1),className:"hover:bg-white/20 p-2 rounded-lg transition",children:e.jsx(Pe,{size:24})})]}),e.jsxs("form",{onSubmit:Gt,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Customer Name *"}),e.jsx("input",{type:"text",placeholder:"Enter customer name",value:G.customerName,onChange:s=>ge({...G,customerName:s.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:h})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Amount (KES) *"}),e.jsx("input",{type:"number",placeholder:"0.00",value:G.amount,onChange:s=>ge({...G,amount:s.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",step:"0.01",required:!0,disabled:h})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason"}),e.jsxs("select",{value:G.reason,onChange:s=>ge({...G,reason:s.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:h,children:[e.jsx("option",{value:"",children:"Select reason..."}),e.jsx("option",{value:"regular_customer",children:"Regular Customer"}),e.jsx("option",{value:"emergency",children:"Emergency"}),e.jsx("option",{value:"bulk_order",children:"Bulk Order"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes"}),e.jsx("textarea",{placeholder:"Add any additional notes...",value:G.notes,onChange:s=>ge({...G,notes:s.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",disabled:h})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"submit",disabled:h,className:"flex-1 bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-3 rounded-lg font-bold hover:shadow-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Submitting...":"Submit Request"}),e.jsx("button",{type:"button",onClick:()=>je(!1),disabled:h,className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition disabled:opacity-50",children:"Cancel"})]})]})]})}),e.jsx(_s,{isLocked:n,onUnlock:m,userPin:t?.pin||"1234",userName:t?.name})]})}function Ks(){const[t,r]=a.useState({totalSales:0,totalExpenses:0,netProfit:0,transactionCount:0}),[l,c]=a.useState(!0);return a.useEffect(()=>{const n=async()=>{try{const m=localStorage.getItem("token"),x=await(await fetch("http://localhost:5000/api/v2/monitor/stats",{headers:{Authorization:`Bearer ${m}`}})).json();r(x),c(!1)}catch(m){console.error("Failed to fetch stats:",m),c(!1)}};n();const o=setInterval(n,2e3);return()=>clearInterval(o)},[]),l?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin",children:e.jsx(ue,{size:48,className:"text-blue-600"})}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading statistics..."})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Sales"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 mt-2",children:t.totalSales.toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:[t.transactionCount," transactions"]})]}),e.jsx(ye,{size:48,className:"text-green-600 opacity-50"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-red-50 to-red-100 rounded-lg p-6 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Expenses"}),e.jsx("p",{className:"text-3xl font-bold text-red-600 mt-2",children:t.totalExpenses.toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Today's costs"})]}),e.jsx(Le,{size:48,className:"text-red-600 opacity-50"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Net Profit"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:t.netProfit.toLocaleString()}),e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:[t.totalSales>0?`${(t.netProfit/t.totalSales*100).toFixed(1)}%`:"0%"," margin"]})]}),e.jsx(ue,{size:48,className:"text-blue-600 opacity-50"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Profit %"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600 mt-2",children:[t.totalSales>0?(t.netProfit/t.totalSales*100).toFixed(1):"0","%"]}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Profitability"})]}),e.jsx(ye,{size:48,className:"text-purple-600 opacity-50"})]})})]})}function Hs({shiftId:t,onClockOut:r}){const[l,c]=a.useState(null),[n,o]=a.useState(!0),[m,i]=a.useState("00:00:00");a.useEffect(()=>{if(!t)return;(async()=>{try{const d=localStorage.getItem("token"),p=await(await fetch("http://localhost:5000/api/v2/shifts/current",{headers:{Authorization:`Bearer ${d}`}})).json();p.shift&&c(p.shift),o(!1)}catch(d){console.error("Failed to fetch shift:",d),o(!1)}})()},[t]),a.useEffect(()=>{if(!l||!l.clockInTime)return;const g=setInterval(()=>{const d=new Date(l.clockInTime),p=Math.floor((new Date-d)/1e3),T=Math.floor(p/3600),L=Math.floor(p%3600/60),D=p%60;i(`${String(T).padStart(2,"0")}:${String(L).padStart(2,"0")}:${String(D).padStart(2,"0")}`)},1e3);return()=>clearInterval(g)},[l]);const x=async()=>{if(t)try{const g=localStorage.getItem("token"),f=await(await fetch("http://localhost:5000/api/v2/shifts/clock-out",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({shiftId:t})})).json();f.success?(alert(`âœ… Clock Out Successful!

Total Sales: ${f.totalSales.toLocaleString()}
Total Expenses: ${f.totalExpenses.toLocaleString()}`),r()):alert(`âŒ Error: ${f.error}`)}catch(g){console.error("Clock out failed:",g),alert("Clock out failed")}};return n?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin",children:e.jsx(Oe,{size:48,className:"text-blue-600"})}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading shift information..."})]}):l?e.jsx("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md mx-auto",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Oe,{size:64,className:"mx-auto text-blue-600 mb-6"}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-6 mb-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Shift Duration"}),e.jsx("p",{className:"text-5xl font-bold text-blue-600 font-mono",children:m}),e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:["Started: ",new Date(l.clockInTime).toLocaleTimeString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sales"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:l.totalSales.toLocaleString()})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Expenses"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:l.totalExpenses.toLocaleString()})]})]}),e.jsxs("button",{onClick:x,className:"w-full bg-red-600 text-white py-3 rounded-lg font-bold hover:bg-red-700 flex items-center justify-center gap-2 transition-colors",children:[e.jsx(de,{size:20}),"Clock Out"]})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[e.jsx($e,{size:48,className:"mx-auto text-yellow-600 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"No Active Shift"}),e.jsx("p",{className:"text-gray-600",children:"Please return to POS to start a new shift."})]})}function Ce(){const{user:t}=ee(),r=ne(),[l,c]=a.useState("pos"),[n,o]=a.useState(null),[m,i]=a.useState([]),[x,g]=a.useState([]),[d,f]=a.useState(""),[p,T]=a.useState(0),[L,D]=a.useState(0),[W,I]=a.useState(!1);a.useEffect(()=>{k()},[]);const k=async()=>{try{const N=localStorage.getItem("token"),Y=await(await fetch("http://localhost:5000/api/v2/shifts/clock-in",{method:"POST",headers:{Authorization:`Bearer ${N}`}})).json();Y.shiftId&&o(Y.shiftId)}catch(N){console.error("Clock in failed:",N)}};a.useEffect(()=>{(async()=>{try{const $=localStorage.getItem("token"),Z=await(await fetch("http://localhost:5000/api/products",{headers:{Authorization:`Bearer ${$}`}})).json();g(Z||[])}catch($){console.error("Failed to fetch products:",$)}})()},[]);const U=x.filter(N=>N.name.toLowerCase().includes(d.toLowerCase())),F=N=>{const $=m.find(Y=>Y.productId===N.id);$?($.quantity+=1,i([...m])):i([...m,{productId:N.id,name:N.name,price:N.price,quantity:1}])},H=N=>{i(m.filter($=>$.productId!==N))},q=()=>{let N=m.reduce((Y,Z)=>Y+Z.price*Z.quantity,0),$=N*L/100;return N+$-p},u=async()=>{if(m.length===0){alert("Please add items to the sale");return}I(!0);try{const N=localStorage.getItem("token"),$=q(),Z=await(await fetch("http://localhost:5000/api/v2/sales/complete",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify({items:m,total:$,discount:p,tax:m.reduce((he,pe)=>he+pe.price*pe.quantity,0)*L/100,paymentMethod:"cash",shiftId:n})})).json();Z.success?(alert(`âœ… Sale completed! ID: ${Z.saleId}`),i([]),T(0),D(0)):alert(`âŒ Error: ${Z.error}`)}catch(N){console.error("Sale failed:",N),alert("Sale failed. Check console for details.")}finally{I(!1)}};if(!t)return r("/auth/login"),null;const P=[{id:"pos",label:"POS",icon:ze},{id:"monitor",label:"Monitor",icon:ye},{id:"shift",label:"Shift",icon:Oe}],v=m.reduce((N,$)=>N+$.price*$.quantity,0),A=v*L/100,M=v+A-p;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cashier POS"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome, ",t.name]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Shift ID: ",n||"Not Started"]})})]})})}),e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsx("div",{className:"flex gap-4",children:P.map(N=>{const $=N.icon;return e.jsxs("button",{onClick:()=>c(N.id),className:`flex items-center gap-2 px-4 py-3 font-medium transition-colors ${l===N.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx($,{size:18}),N.label]},N.id)})})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[l==="pos"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx("input",{type:"text",placeholder:"Search products...",value:d,onChange:N=>f(N.target.value),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:U.map(N=>e.jsxs("button",{onClick:()=>F(N),className:"p-4 border rounded-lg hover:bg-blue-50 transition-colors text-left",children:[e.jsx("p",{className:"font-semibold text-sm",children:N.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Stock: ",N.quantity||0]}),e.jsx("p",{className:"text-lg font-bold text-blue-600 mt-2",children:N.price})]},N.id))}),U.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx($e,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No products found"})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 sticky top-24",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Cart"}),e.jsx("div",{className:"space-y-3 mb-6 max-h-96 overflow-y-auto",children:m.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No items selected"}):m.map(N=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-sm",children:N.name}),e.jsxs("p",{className:"text-xs text-gray-600",children:[N.quantity," Ã— ",N.price]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-bold text-sm",children:(N.price*N.quantity).toLocaleString()}),e.jsx("button",{onClick:()=>H(N.productId),className:"text-red-600 hover:text-red-700",children:"âœ•"})]})]},N.productId))}),e.jsxs("div",{className:"space-y-2 border-t pt-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{className:"font-semibold",children:v.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Discount:"}),e.jsx("input",{type:"number",value:p,onChange:N=>T(parseFloat(N.target.value)||0),className:"w-24 px-2 py-1 border rounded"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Tax (%):"}),e.jsx("input",{type:"number",value:L,onChange:N=>D(parseFloat(N.target.value)||0),className:"w-24 px-2 py-1 border rounded"})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[e.jsx("span",{children:"TOTAL:"}),e.jsx("span",{className:"text-green-600",children:M.toLocaleString()})]})]}),e.jsx("button",{onClick:u,disabled:W||m.length===0,className:"w-full bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 disabled:bg-gray-400 transition-colors",children:W?"Processing...":"âœ“ Complete Sale"})]})})]}),l==="monitor"&&e.jsx(Ks,{}),l==="shift"&&e.jsx(Hs,{shiftId:n,onClockOut:()=>r("/auth/login")})]})]})}function Gs(){const{user:t,logout:r}=ee(),l=ne(),[c,n]=a.useState({sales:0,count:0});return a.useEffect(()=>{const o=JSON.parse(localStorage.getItem("dayStats")||'{"sales": 0, "count": 0}');n(o)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-900 to-amber-700",children:[e.jsx("div",{className:"bg-amber-900 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ds,{size:32,className:"text-amber-300"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Bar POS"}),e.jsx("p",{className:"text-amber-200 text-sm",children:"Drinks & Beverages"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-amber-200 text-sm",children:"Today's Sales"}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:[c.sales.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-amber-300 text-xs",children:[c.count," transactions"]})]}),e.jsxs("button",{onClick:()=>{r(),l("/auth/login")},className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg transition",children:[e.jsx(de,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-amber-800 text-white border-b border-amber-700",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-amber-600 rounded-lg font-semibold",children:"ðŸº Beer"}),e.jsx("div",{className:"px-4 py-2 hover:bg-amber-700 rounded-lg cursor-pointer transition",children:"ðŸ· Wine"}),e.jsx("div",{className:"px-4 py-2 hover:bg-amber-700 rounded-lg cursor-pointer transition",children:"ðŸ¥ƒ Spirits"}),e.jsx("div",{className:"px-4 py-2 hover:bg-amber-700 rounded-lg cursor-pointer transition",children:"ðŸ§Š Mixers"}),e.jsx("div",{className:"px-4 py-2 hover:bg-amber-700 rounded-lg cursor-pointer transition",children:"ðŸ¸ Cocktails"})]})}),e.jsx("div",{className:"bg-amber-50",children:e.jsx(Ce,{businessType:"bar"})}),e.jsx("div",{className:"bg-amber-900 text-white py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(ue,{size:16,className:"text-yellow-400"}),e.jsx("p",{className:"text-sm",children:"Fast checkout â€¢ Age verification on premium items â€¢ Real-time inventory"})]})})]})}function Ys(){const{user:t,logout:r}=ee(),l=ne(),[c,n]=a.useState(""),[o,m]=a.useState({revenue:0,patients:0});return a.useEffect(()=>{const i=JSON.parse(localStorage.getItem("dayStats")||'{"revenue": 0, "patients": 0}');m(i)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-red-100",children:[e.jsx("div",{className:"bg-red-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ms,{size:32,className:"text-red-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Hospital POS"}),e.jsx("p",{className:"text-red-200 text-sm",children:"Patient Billing System"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-red-200 text-sm",children:"Daily Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-green-300",children:[o.revenue.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-red-200 text-xs",children:[o.patients," patients served"]})]}),e.jsxs("button",{onClick:()=>{r(),l("/auth/login")},className:"flex items-center gap-2 bg-red-900 hover:bg-red-950 px-4 py-2 rounded-lg transition",children:[e.jsx(de,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ve,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search patient by ID or name...",value:c,onChange:i=>n(i.target.value),className:"w-full pl-10 pr-4 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),e.jsxs("button",{className:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition flex items-center gap-2",children:[e.jsx(Oe,{size:18}),"Recent Patients"]})]})})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-red-600 text-white rounded-lg font-semibold",children:"ðŸ¥ Services"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ’Š Medicines"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ§ª Lab Tests"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ“‹ Procedures"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(Ce,{businessType:"hospital"})}),e.jsx("div",{className:"bg-red-700 text-white py-4 text-center",children:e.jsx("p",{className:"text-sm",children:"Patient records integrated â€¢ Invoice generation â€¢ Real-time inventory tracking"})})]})}function Vs(){const{user:t,logout:r}=ee(),l=ne(),[c,n]=a.useState(""),[o,m]=a.useState({feesCollected:0,transactions:0});return a.useEffect(()=>{const i=JSON.parse(localStorage.getItem("dayStats")||'{"feesCollected": 0, "transactions": 0}');m(i)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100",children:[e.jsx("div",{className:"bg-blue-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xs,{size:32,className:"text-blue-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"School POS"}),e.jsx("p",{className:"text-blue-200 text-sm",children:"Student & Fee Management"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-blue-200 text-sm",children:"Fees Collected Today"}),e.jsxs("p",{className:"text-2xl font-bold text-green-300",children:[o.feesCollected.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-blue-200 text-xs",children:[o.transactions," transactions"]})]}),e.jsxs("button",{onClick:()=>{r(),l("/auth/login")},className:"flex items-center gap-2 bg-blue-900 hover:bg-blue-950 px-4 py-2 rounded-lg transition",children:[e.jsx(de,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ke,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search student by name, admission number, or class...",value:c,onChange:i=>n(i.target.value),className:"w-full pl-10 pr-4 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition flex items-center gap-2",children:[e.jsx(us,{size:18}),"Fee Slip"]})]})})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold",children:"ðŸ’° Term Fees"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ½ï¸ Canteen"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ‘• Uniforms"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ“š Books"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"âœï¸ Supplies"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(Ce,{businessType:"school"})}),e.jsx("div",{className:"bg-blue-700 text-white py-4 text-center",children:e.jsx("p",{className:"text-sm",children:"Student records linked â€¢ Receipt generation â€¢ Year-end reports"})})]})}function Qs(){const{user:t,logout:r}=ee(),l=ne(),[c,n]=a.useState({sales:0,itemsSold:0,lowStockItems:0});return a.useEffect(()=>{const o=JSON.parse(localStorage.getItem("dayStats")||'{"sales": 0, "itemsSold": 0, "lowStockItems": 0}');n(o)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-green-100",children:[e.jsx("div",{className:"bg-green-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(hs,{size:32,className:"text-green-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Kiosk POS"}),e.jsx("p",{className:"text-green-200 text-sm",children:"Fast & Simple Checkout"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-green-200 text-sm",children:"Today's Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-300",children:[c.sales.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-green-200 text-xs",children:[c.itemsSold," items sold"]})]}),e.jsxs("button",{onClick:()=>{r(),l("/auth/login")},className:"flex items-center gap-2 bg-green-900 hover:bg-green-950 px-4 py-2 rounded-lg transition",children:[e.jsx(de,{size:20}),"Logout"]})]})]})})}),c.lowStockItems>0&&e.jsx("div",{className:"bg-yellow-50 border-b border-yellow-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center gap-2 text-yellow-800",children:[e.jsx($e,{size:20}),e.jsxs("span",{className:"font-semibold",children:[c.lowStockItems," items running low on stock"]})]})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold",children:"ðŸª All Items"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ”Œ Electronics"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸª Food"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ¥¤ Drinks"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ›’ Supplies"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(Ce,{businessType:"kiosk"})}),e.jsxs("div",{className:"bg-green-700 text-white py-4 text-center flex items-center justify-center gap-2",children:[e.jsx(ue,{size:18,className:"text-yellow-300"}),e.jsx("p",{className:"text-sm",children:"Lightning-fast checkout â€¢ Low stock alerts â€¢ Real-time updates"})]})]})}function Xs(){const{user:t,logout:r}=ee(),l=ne(),[c,n]=a.useState("1"),[o,m]=a.useState({revenue:0,liters:0,pumpTotal:0});return a.useEffect(()=>{const i=JSON.parse(localStorage.getItem("dayStats")||'{"revenue": 0, "liters": 0, "pumpTotal": 0}');m(i)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-yellow-100",children:[e.jsx("div",{className:"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ps,{size:32,className:"text-yellow-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Petrol POS"}),e.jsx("p",{className:"text-yellow-200 text-sm",children:"Fuel & Tank Management"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-yellow-200 text-sm",children:"Daily Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-green-300",children:[o.revenue.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-yellow-200 text-xs",children:[o.liters.toLocaleString()," liters sold"]})]}),e.jsxs("button",{onClick:()=>{r(),l("/auth/login")},className:"flex items-center gap-2 bg-yellow-900 hover:bg-yellow-950 px-4 py-2 rounded-lg transition",children:[e.jsx(de,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Select Pump:"}),e.jsx("div",{className:"flex gap-3",children:[1,2,3,4,5,6].map(i=>e.jsxs("button",{onClick:()=>n(i.toString()),className:`px-6 py-2 rounded-lg font-bold transition ${c===i.toString()?"bg-yellow-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[e.jsx(gs,{size:18,className:"inline mr-2"}),"Pump ",i]},i))}),e.jsxs("div",{className:"ml-auto text-right",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Pump ",c," Total"]}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:[o.pumpTotal.toLocaleString()," KES"]})]})]})})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-yellow-600 text-white rounded-lg font-semibold",children:"â›½ Super"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"â›½ Regular"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"â›½ Diesel"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ›¢ï¸ LPG"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(Ce,{businessType:"petrol",pumpNumber:c})}),e.jsxs("div",{className:"bg-yellow-700 text-white py-4 text-center flex items-center justify-center gap-2",children:[e.jsx(ye,{size:18}),e.jsx("p",{className:"text-sm",children:"Pump tracking â€¢ Tank management â€¢ Shift reconciliation â€¢ Real-time readings"})]})]})}function Zs(){const{user:t,logout:r}=ee(),l=ne(),[c,n]=a.useState({size:"",color:""}),[o,m]=a.useState({sales:0,pairs:0,topSize:""});a.useEffect(()=>{const g=JSON.parse(localStorage.getItem("dayStats")||'{"sales": 0, "pairs": 0, "topSize": ""}');m(g)},[]);const i=["5","6","7","8","9","10","11","12","13"],x=["Black","White","Brown","Blue","Red","Green","Pink","Gray"];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-purple-100",children:[e.jsx("div",{className:"bg-purple-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 text-purple-200",children:"ðŸ‘Ÿ"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Shoes POS"}),e.jsx("p",{className:"text-purple-200 text-sm",children:"Footwear & Variants"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-purple-200 text-sm",children:"Daily Sales"}),e.jsxs("p",{className:"text-2xl font-bold text-green-300",children:[o.sales.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-purple-200 text-xs",children:[o.pairs," pairs sold â€¢ Top: Size ",o.topSize]})]}),e.jsxs("button",{onClick:()=>{r(),l("/auth/login")},className:"flex items-center gap-2 bg-purple-900 hover:bg-purple-950 px-4 py-2 rounded-lg transition",children:[e.jsx(de,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx(fs,{size:18,className:"inline mr-2"}),"Filter by Size"]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:i.map(g=>e.jsx("button",{onClick:()=>n({...c,size:g===c.size?"":g}),className:`w-10 h-10 rounded-lg font-bold transition ${c.size===g?"bg-purple-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:g},g))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx(ke,{size:18,className:"inline mr-2"}),"Filter by Color"]}),e.jsxs("select",{value:c.color,onChange:g=>n({...c,color:g.target.value}),className:"px-4 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Colors"}),x.map(g=>e.jsx("option",{value:g,children:g},g))]})]})]})})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold",children:"ðŸ‘Ÿ All Shoes"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸƒ Sports"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ‘ž Formal"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ‘  Casual"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ‘¢ Boots"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(Ce,{businessType:"shoes",filters:c})}),e.jsx("div",{className:"bg-purple-700 text-white py-4 text-center",children:e.jsx("p",{className:"text-sm",children:"Variant management â€¢ Size & color tracking â€¢ Stock by variant â€¢ Real-time availability"})})]})}function kt(){const[t,r]=a.useState([]),[l,c]=a.useState([]),[n,o]=a.useState("all"),[m,i]=a.useState(""),[x,g]=a.useState(!1),[d,f]=a.useState([]),[p,T]=a.useState({subject:"",message:""}),[L,D]=a.useState(!0),[W,I]=a.useState(null),[k,U]=a.useState(!0),[F,H]=a.useState(null),q=ne(),[u,P]=a.useState({totalUsers:0,activeUsers:0,lockedUsers:0,totalRevenue:0,pendingPayments:0,overduePayments:0}),[v,A]=a.useState([]);a.useEffect(()=>{const h=localStorage.getItem("token")||localStorage.getItem("mainAdminToken"),w=localStorage.getItem("user")||localStorage.getItem("mainAdminUser");if(!h||!w){q("/main-admin/login");return}try{if(JSON.parse(w).role!=="owner"){q("/main-admin/login");return}}catch{q("/main-admin/login");return}M().finally(()=>D(!1));const O=JSON.parse(localStorage.getItem("authActivities")||"[]");A(O.slice(0,10));const R=setInterval(()=>{const K=JSON.parse(localStorage.getItem("authActivities")||"[]");A(K.slice(0,10))},5e3);return()=>clearInterval(R)},[q]);const M=async()=>{try{I(null);let h=[],w=!0;try{h=await at.getUsers()}catch(O){console.warn("MainAdmin API not available, falling back to regular users API:",O.message);try{h=await Ye.getAll()}catch(R){console.warn("Users API also failed:",R.message),w=!1}}h.length===0&&!w&&(h=$()),r(h),U(w),Z(h,[])}catch(h){console.error("Failed to load data:",h),I("Failed to load dashboard data");const w=$();r(w),c(Y(w)),U(!1),Z(w,[])}},N=()=>{localStorage.removeItem("mainAdminToken"),localStorage.removeItem("mainAdminUser"),q("/main-admin/login")},$=()=>{const h=localStorage.getItem("user"),w=[];if(h){const R=JSON.parse(h);w.push({...R,id:R.id||"real-user"})}return[{name:"John Doe",email:"john@example.com",plan:"ultra",price:1600,active:!0,locked:!1,role:"admin"},{name:"Jane Smith",email:"jane@example.com",plan:"basic",price:900,active:!0,locked:!1,role:"cashier"},{name:"Bob Wilson",email:"bob@example.com",plan:"ultra",price:1600,active:!1,locked:!1,role:"admin"},{name:"Alice Brown",email:"alice@example.com",plan:"basic",price:900,active:!0,locked:!0,role:"cashier"},{name:"Mike Johnson",email:"mike@example.com",plan:"ultra",price:1600,active:!0,locked:!1,role:"admin"},{name:"Sarah Davis",email:"sarah@example.com",plan:"basic",price:900,active:!1,locked:!1,role:"cashier"}].forEach((R,K)=>{w.push({id:`demo-${K+1}`,...R,createdAt:new Date(Date.now()-K*864e5).toISOString(),lastLogin:new Date(Date.now()-Math.random()*864e5).toISOString()})}),w},Y=h=>h.flatMap(w=>[{id:`payment-${w.id}-1`,userId:w.id,amount:w.plan==="ultra"?1600:900,status:Math.random()>.3?"paid":"pending",createdAt:new Date(Date.now()-30*864e5).toISOString(),dueDate:new Date(Date.now()+5*864e5).toISOString()},{id:`payment-${w.id}-2`,userId:w.id,amount:w.plan==="ultra"?1600:900,status:Math.random()>.7?"paid":Math.random()>.5?"pending":"overdue",createdAt:new Date(Date.now()-60*864e5).toISOString(),dueDate:new Date(Date.now()-5*864e5).toISOString()}]),Z=(h,w)=>{const O=h.length,R=h.filter(E=>E.active).length,K=h.filter(E=>E.locked).length,z=w.filter(E=>E.status==="paid").reduce((E,Ne)=>E+Ne.amount,0),te=w.filter(E=>E.status==="pending").length,oe=w.filter(E=>E.status==="overdue").length;P({totalUsers:O,activeUsers:R,lockedUsers:K,totalRevenue:z,pendingPayments:te,overduePayments:oe})},he=async(h,w)=>{try{H(h);const O=!w;try{await at.lockUser(h,O);const R=t.map(te=>te.id===h?{...te,locked:O,active:!O}:te);r(R),Z(R,l);const K=t.find(te=>te.id===h),z=O?"locked":"unlocked";alert(`âœ… ${K?.name||`User ${h}`} has been ${z} successfully!`)}catch(R){console.error("API lock failed:",R);const K=t.map(oe=>oe.id===h?{...oe,locked:O,active:!O}:oe);r(K),Z(K,l);const z=t.find(oe=>oe.id===h),te=O?"locked":"unlocked";alert(`âš ï¸ Backend not available. ${z?.name||`User ${h}`} ${te} locally. Changes will sync when backend is available.`)}}catch(O){console.error("Failed to toggle lock:",O),alert(`âŒ Failed to update user status: ${O.message}`)}finally{H(null)}},pe=async(h,w,O)=>{try{D(!0);try{await at.sendEmail({userIds:h,subject:w,message:O}),alert("Emails sent successfully!"),g(!1),f([]),T({subject:"",message:""});return}catch(z){console.warn("Backend email operation failed, simulating email send:",z.message)}const R=t.filter(z=>h.includes(z.id)),K=JSON.parse(localStorage.getItem("emailLogs")||"[]");K.push({timestamp:new Date().toISOString(),recipients:R.map(z=>({id:z.id,name:z.name,email:z.email})),subject:w,message:O,status:"simulated"}),localStorage.setItem("emailLogs",JSON.stringify(K)),alert(`âœ… Email simulation successful!

ðŸ“§ Sent to ${R.length} user(s):
${R.map(z=>`${z.name} (${z.email})`).join(`
`)}

${k?"":`ðŸ“Œ Backend not deployed - this was a simulation.
`}ðŸ’¡ Deploy backend to send real emails.`),g(!1),f([]),T({subject:"",message:""})}catch(R){console.error("Failed to send email:",R),alert("Failed to process email request.")}finally{D(!1)}},je=async h=>{const w=t.find(O=>O.id===h);w&&await pe([h],"Payment Reminder - Subscription",`Dear ${w.name},

This is a friendly reminder about your pending subscription payment for ${w.plan?.toUpperCase()} plan (KSH ${w.price}).

Please complete your payment to continue enjoying our services.

Thank you!`)},G=t.filter(h=>{const w=h.name?.toLowerCase().includes(m.toLowerCase())||h.email?.toLowerCase().includes(m.toLowerCase());if(n==="all")return w;if(n==="active")return w&&h.active&&!h.locked;if(n==="locked")return w&&h.locked;if(n==="trial")return w&&(!h.active||!h.plan);if(n==="pending-payment"){const O=l.filter(R=>R.userId===h.id&&R.status==="pending");return w&&O.length>0}if(n==="overdue"){const O=l.filter(R=>R.userId===h.id&&R.status==="overdue");return w&&O.length>0}return w}),ge=h=>{const w=l.filter(z=>z.userId===h),O=w.filter(z=>z.status==="pending").length,R=w.filter(z=>z.status==="overdue").length,K=w.filter(z=>z.status==="paid").length;return{pending:O,overdue:R,paid:K,total:w.length}};return L&&t.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-white mx-auto mb-4"}),e.jsx("p",{className:"text-white text-xl",children:"Loading Main Admin Dashboard..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900",children:[!k&&e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 text-center",children:e.jsxs("p",{className:"text-sm md:text-base font-semibold",children:["âš ï¸ Demo Mode: Backend not available. Actions are simulated locally.",e.jsx("a",{href:"/BACKEND_NOT_DEPLOYED.md",className:"underline ml-2",children:"Deploy Backend â†’"})]})}),W&&e.jsx("div",{className:"bg-red-500 text-white px-6 py-3 text-center",children:e.jsxs("p",{className:"text-sm font-semibold",children:["âš ï¸ ",W]})}),e.jsx("header",{className:"bg-black/30 backdrop-blur-lg border-b border-white/10 px-6 py-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Main Admin Dashboard"}),e.jsx("p",{className:"text-gray-300",children:"Monitor all users, payments, and system activity"})]}),e.jsxs("button",{onClick:N,className:"flex items-center gap-2 bg-red-500/20 hover:bg-red-500/30 text-red-300 px-4 py-2 rounded-lg transition-colors",children:[e.jsx(de,{className:"w-4 h-4"}),"Logout"]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ke,{className:"w-8 h-8 text-blue-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:u.totalUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Total Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(it,{className:"w-8 h-8 text-green-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:u.activeUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Active Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(le,{className:"w-8 h-8 text-red-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:u.lockedUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Locked Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Je,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("span",{className:"text-2xl font-bold text-white",children:["KSH ",u.totalRevenue.toLocaleString()]})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Total Revenue"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ge,{className:"w-8 h-8 text-orange-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:u.pendingPayments})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Pending Payments"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(bs,{className:"w-8 h-8 text-red-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:u.overduePayments})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Overdue Payments"})]})]}),e.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-4 flex-1 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-80",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users...",className:"w-full pl-10 pr-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",value:m,onChange:h=>i(h.target.value)})]}),e.jsxs("select",{value:n,onChange:h=>o(h.target.value),className:"px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Users"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"locked",children:"Locked"}),e.jsx("option",{value:"trial",children:"Free Trial"}),e.jsx("option",{value:"pending-payment",children:"Pending Payment"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]}),e.jsxs("button",{onClick:()=>g(!0),disabled:d.length===0||L,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-lg font-bold flex items-center gap-2 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ot,{className:"w-5 h-5"}),"Send Email to Selected (",d.length,")"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsx("h2",{className:"text-xl font-bold text-white",children:"All Users"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-black/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 text-left",children:e.jsx("input",{type:"checkbox",checked:d.length===G.length&&G.length>0,onChange:h=>{h.target.checked?f(G.map(w=>w.id)):f([])},className:"w-5 h-5 rounded"})}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"User"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Plan"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Status"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Actions"})]})}),e.jsxs("tbody",{children:[G.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",className:"px-4 py-12 text-center",children:[e.jsx(Ke,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No users found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:m||n!=="all"?"Try adjusting your filters":"Users will appear here once they sign up"})]})}),G.map(h=>(ge(h.id),e.jsxs("tr",{className:"border-t border-white/10 hover:bg-white/5 transition",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:d.includes(h.id),onChange:w=>{w.target.checked?f([...d,h.id]):f(d.filter(O=>O!==h.id))},className:"w-5 h-5 rounded"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[h.profilePicture?e.jsx("img",{src:h.profilePicture,alt:h.name,className:"w-10 h-10 rounded-full"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white font-bold",children:h.name?.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:h.name}),e.jsx("p",{className:"text-sm text-gray-400",children:h.email})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${h.plan==="ultra"?"bg-purple-500/20 text-purple-300":"bg-blue-500/20 text-blue-300"}`,children:[h.plan?.toUpperCase()," - KSH ",h.price]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center gap-2",children:h.locked?e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-red-500/20 text-red-300 flex items-center gap-1",children:[e.jsx(le,{className:"w-3 h-3"}),"Locked"]}):h.active?e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-green-500/20 text-green-300 flex items-center gap-1",children:[e.jsx(it,{className:"w-3 h-3"}),"Active"]}):e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-gray-500/20 text-gray-300",children:"Inactive"})})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>he(h.id,h.locked),disabled:F===h.id,className:`p-2 rounded-lg transition ${h.locked?"bg-green-500/20 hover:bg-green-500/30 text-green-300":"bg-red-500/20 hover:bg-red-500/30 text-red-300"} ${F===h.id?"opacity-50 cursor-not-allowed":""}`,title:h.locked?"Unlock User":"Lock User",children:F===h.id?e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):h.locked?e.jsx(ys,{className:"w-4 h-4"}):e.jsx(le,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>je(h.id),disabled:L,className:"p-2 rounded-lg bg-blue-500/20 hover:bg-blue-500/30 text-blue-300 transition",title:"Send Payment Reminder",children:e.jsx(js,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{h.role==="cashier"?window.open("/dashboard/cashier","_blank"):window.open("/admin","_blank")},className:"p-2 rounded-lg bg-purple-500/20 hover:bg-purple-500/30 text-purple-300 transition",title:"View User Dashboard",children:e.jsx(Ns,{className:"w-4 h-4"})})]})})]},h.id)))]})]})})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5"}),"Recent Activity"]})}),e.jsx("div",{className:"p-4 space-y-3 max-h-96 overflow-y-auto",children:v.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No recent activity"}):v.map(h=>e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${h.type==="login"?"bg-green-400":"bg-blue-400"}`}),e.jsx("span",{className:"text-white font-medium",children:h.user.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${h.type==="login"?"bg-green-500/20 text-green-300":"bg-blue-500/20 text-blue-300"}`,children:h.type})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:h.user.email}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:new Date(h.timestamp).toLocaleString()})]},h.id))})]})]})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-purple-900 rounded-2xl shadow-2xl max-w-2xl w-full border border-white/20",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white rounded-t-2xl",children:e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ot,{}),"Send Email to ",d.length," User(s)"]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:p.subject,onChange:h=>T({...p,subject:h.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Email subject..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Message"}),e.jsx("textarea",{value:p.message,onChange:h=>T({...p,message:h.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 h-40",placeholder:"Email message..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>pe(d,p.subject,p.message),disabled:L,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-3 rounded-lg font-bold transition disabled:opacity-50",children:L?"Sending...":"Send Email"}),e.jsx("button",{onClick:()=>g(!1),className:"px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-lg font-bold transition",children:"Cancel"})]})]})]})})]})}function ea({onClose:t}){const[r,l]=a.useState([]),[c,n]=a.useState(!0),o=a.useRef({data:null,timestamp:null}),m=3e4;a.useEffect(()=>{i()},[]);const i=async()=>{try{const g=Date.now();if(o.current.data&&o.current.timestamp&&g-o.current.timestamp<m){console.log("ðŸ“¦ Using cached reminders"),l(o.current.data),n(!1);return}const d=localStorage.getItem("token"),f=await fetch(`${xe}/reminders/today`,{headers:{Authorization:`Bearer ${d}`}});if(!f.ok){console.error("API Error:",f.status,f.statusText),l([]),n(!1);return}const p=await f.json();Array.isArray(p)?(o.current.data=p,o.current.timestamp=Date.now(),l(p)):(console.error("Expected array but got:",typeof p,p),l([]))}catch(g){console.error("Failed to fetch reminders:",g),l([])}finally{n(!1)}},x=async g=>{try{const d=localStorage.getItem("token");await fetch(`${xe}/reminders/${g}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},body:JSON.stringify({status:"fulfilled"})}),o.current={data:null,timestamp:null},i()}catch(d){console.error("Failed to update reminder:",d)}};return c?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Today's Reminders"}),e.jsx("button",{onClick:t,className:"hover:bg-white/20 p-2 rounded-lg transition",children:e.jsx(Pe,{size:24})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx($e,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"No reminders for today"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"You're all caught up!"})]}):r.map(g=>e.jsxs("div",{className:"mb-4 p-4 border-l-4 border-red-500 bg-red-50 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:g.customerName}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Product ID: ",g.productId]}),e.jsx("p",{className:"text-xs text-gray-500",children:g.frequency})]}),e.jsxs("button",{onClick:()=>x(g.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition",children:[e.jsx(it,{size:18}),"Mark Done"]})]},g.id))})]})})}function ta({onUnlock:t,userType:r="user"}){const[l,c]=a.useState(""),[n,o]=a.useState(""),[m,i]=a.useState("password"),[x,g]=a.useState(!1),[d,f]=a.useState(""),[p,T]=a.useState(!1),[L,D]=a.useState("2005"),W=JSON.parse(localStorage.getItem("user")||"{}");a.useEffect(()=>{(async()=>{try{const F=await Ts.get();F?.screenLockPassword&&D(F.screenLockPassword)}catch(F){console.warn("Failed to load settings, using default password:",F)}})()},[]),a.useEffect(()=>{const U=document.getElementById(m==="password"?"unlock-password":"unlock-pin");U&&U.focus()},[m]);const I=async U=>{U.preventDefault(),U.stopPropagation(),T(!0),f("");try{const F=localStorage.getItem("token");if(!F)throw new Error("No authentication token found");const H=await fetch("https://universal-backend-w0x1.onrender.com/api/auth/unlock-screen",{method:"POST",headers:{Authorization:`Bearer ${F}`,"Content-Type":"application/json"},body:JSON.stringify({pin:n})});if(!H.ok){const u=await H.json();throw H.status===429?new Error(u.message||"Too many failed attempts. Try again later."):H.status===401?new Error(u.message||"Incorrect PIN"):new Error(u.message||"Unlock failed")}const q=await H.json();q.token&&localStorage.setItem("token",q.token),o(""),c(""),t(q)}catch(F){f(F.message||"Unlock failed")}finally{T(!1)}},k=U=>{const F=U.replace(/\D/g,"").slice(0,4);o(F)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:U=>U.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 p-8",onClick:U=>U.stopPropagation(),children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:`w-16 h-16 rounded-2xl mx-auto mb-4 flex items-center justify-center ${r==="main_admin"?"bg-gradient-to-br from-red-600 to-orange-600":"bg-gradient-to-br from-blue-600 to-purple-600"}`,children:e.jsx(le,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Screen Locked"}),e.jsx("p",{className:"text-gray-600",children:r==="main_admin"?"Main Admin":W.name||"User"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Enter your ",m," to continue"]})]}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter PIN to unlock"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",id:"unlock-pin",value:n,onChange:U=>k(U.target.value),placeholder:"0000",maxLength:"4",className:"w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-center tracking-widest text-2xl",disabled:p})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"ðŸ”’ PIN validated securely on server"})]}),d&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-red-700 text-sm font-medium",children:[d.includes("Too many")?"âŒ ":"âš ï¸ ",d]})}),e.jsx("button",{type:"submit",disabled:p||n.length<4,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 rounded-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Verifying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-5 h-5"}),"Unlock Screen"]})})]})]})})}function sa({user:t}){const[r,l]=a.useState(!1);if(r||!t)return null;const c=t?.serviceStartDate?new Date(t.serviceStartDate):null,n=t?.daysUsed||0,o=t?.plan||"",i=Math.max(0,30-n);return i>7?null:e.jsxs("div",{className:"bg-amber-50 border-l-4 border-amber-500 p-3 md:p-4 flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx($e,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-amber-900",children:i===0?`Your ${o} plan has expired. Please renew to continue.`:`Your ${o} plan expires in ${i} day${i!==1?"s":""}. Consider upgrading.`}),e.jsxs("p",{className:"text-xs text-amber-700 mt-1",children:["Service started: ",c?.toLocaleDateString()||"Unknown"]})]})]}),e.jsx("button",{onClick:()=>l(!0),className:"flex-shrink-0 text-amber-600 hover:text-amber-900",children:e.jsx(Pe,{className:"w-5 h-5"})})]})}function aa(){const{refreshProducts:t}=Lt();return a.useEffect(()=>{const r=n=>{console.log(" Stock update received:",n.detail),t()},l=n=>{console.log(" Sale completed, refreshing stock:",n.detail),t()},c=n=>{console.log(" Products sync event:",n.detail)};return window.addEventListener("stockUpdate",r),window.addEventListener("saleComplete",l),window.addEventListener("productsSync",c),()=>{window.removeEventListener("stockUpdate",r),window.removeEventListener("saleComplete",l),window.removeEventListener("productsSync",c)}},[t]),null}function ra(t=6e4){const[r,l]=a.useState(!1),c=a.useRef(Date.now()),n=a.useCallback(()=>{c.current=Date.now(),l(!1)},[]),o=a.useCallback(()=>{l(!1),c.current=Date.now()},[]);return a.useEffect(()=>{const m=["mousedown","mousemove","keypress","scroll","touchstart","click"],i=()=>{c.current=Date.now(),r&&l(!1)};m.forEach(g=>{document.addEventListener(g,i,!0)});const x=setInterval(()=>{Date.now()-c.current>t&&!r&&l(!0)},5e3);return()=>{m.forEach(g=>{document.removeEventListener(g,i,!0)}),clearInterval(x)}},[t,r]),[r,o,n]}function ae({children:t,adminOnly:r=!1,ultraOnly:l=!1,ownerOnly:c=!1}){const{user:n,loading:o}=ee(),{isLocked:m,lock:i,unlock:x}=$t(),[g,d]=a.useState(!1),f=ra(6e4),p=f?.[0]||m||!1,T=a.useCallback(()=>{f?.[1]?.(),x()},[f,x]),[L,D]=a.useState({});if(a.useEffect(()=>{n&&!c&&((async()=>{try{const k=localStorage.getItem("token"),F=await fetch(`${xe}/settings`,{headers:{Authorization:`Bearer ${k}`}});if(F.ok){const H=await F.json();D(H)}}catch(k){console.error("Failed to load settings:",k)}})(),sessionStorage.getItem("reminderShown")||(d(!0),sessionStorage.setItem("reminderShown","true")))},[n,c]),a.useEffect(()=>{const I=k=>{console.log("ðŸ”’ Admin locked screen:",k.detail),i("admin")};return window.addEventListener("admin_locked_user_screen",I),()=>window.removeEventListener("admin_locked_user_screen",I)},[i]),o&&!c)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(c){const I=localStorage.getItem("ownerToken"),k=localStorage.getItem("ownerUser");if(!I||!k)return e.jsx(Q,{to:"/main.admin"});try{if(JSON.parse(k).type!=="main_admin")return e.jsx(Q,{to:"/main.admin"})}catch{return e.jsx(Q,{to:"/main.admin"})}}else{if(!n)return e.jsx(Q,{to:"/auth/login"});if(!n.active)return e.jsx(Q,{to:"/choose-subscription"});if(r&&n.role!=="admin")return e.jsx(Q,{to:"/dashboard"});if(l&&(n.role!=="admin"||n.plan!=="ultra"))return e.jsx(Q,{to:"/dashboard"})}const W=c?"owner":"user";return e.jsxs(e.Fragment,{children:[e.jsx(sa,{}),e.jsx(aa,{}),p&&e.jsx(ta,{onUnlock:T,userType:W}),g&&e.jsx(ea,{onClose:()=>d(!1)}),t]})}function la(){const{user:t}=ee();return!t||!t.active?e.jsx(Q,{to:"/choose-subscription"}):t.role==="admin"?e.jsx(Q,{to:"/admin"}):e.jsx(Q,{to:"/dashboard/cashier"})}function na(){return e.jsx(Ls,{children:e.jsx(Os,{children:e.jsx(Us,{children:e.jsx(es,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs(ts,{children:[e.jsx(J,{path:"/",element:e.jsx(Q,{to:"/get-started"})}),e.jsx(J,{path:"/get-started",element:e.jsx(Bs,{})}),e.jsx(J,{path:"/choose-subscription",element:e.jsx(Fs,{})}),e.jsx(J,{path:"/auth/login",element:e.jsx(St,{})}),e.jsx(J,{path:"/auth/signup",element:e.jsx(St,{})}),e.jsx(J,{path:"/plans",element:e.jsx(Q,{to:"/choose-subscription"})}),e.jsx(J,{path:"/build-pos",element:e.jsx(qs,{})}),e.jsx(J,{path:"/main.admin/*",element:e.jsx(kt,{})}),e.jsx(J,{path:"/main-admin",element:e.jsx(ae,{ownerOnly:!0,children:e.jsx(kt,{})})}),e.jsx(J,{path:"/dashboard",element:e.jsx(ae,{children:e.jsx(la,{})})}),e.jsx(J,{path:"/dashboard/cashier",element:e.jsx(ae,{children:e.jsx(Ws,{})})}),e.jsx(J,{path:"/cashier/bar",element:e.jsx(ae,{children:e.jsx(Gs,{})})}),e.jsx(J,{path:"/cashier/hospital",element:e.jsx(ae,{children:e.jsx(Ys,{})})}),e.jsx(J,{path:"/cashier/school",element:e.jsx(ae,{children:e.jsx(Vs,{})})}),e.jsx(J,{path:"/cashier/kiosk",element:e.jsx(ae,{children:e.jsx(Qs,{})})}),e.jsx(J,{path:"/cashier/petrol",element:e.jsx(ae,{children:e.jsx(Xs,{})})}),e.jsx(J,{path:"/cashier/shoes",element:e.jsx(ae,{children:e.jsx(Zs,{})})}),e.jsx(J,{path:"/admin/*",element:e.jsx(ae,{adminOnly:!0,children:e.jsx(wt,{})})}),e.jsx(J,{path:"/admin",element:e.jsx(ae,{adminOnly:!0,children:e.jsx(wt,{})})}),e.jsx(J,{path:"/login",element:e.jsx(Q,{to:"/auth/login"})}),e.jsx(J,{path:"/signup",element:e.jsx(Q,{to:"/auth/signup"})}),e.jsx(J,{path:"/subscription",element:e.jsx(Q,{to:"/choose-subscription"})}),e.jsx(J,{path:"/payment",element:e.jsx(Q,{to:"/choose-subscription"})}),e.jsx(J,{path:"/cashier",element:e.jsx(ae,{children:e.jsx(Q,{to:"/dashboard/cashier"})})})]})})})})})}Ps.createRoot(document.getElementById("root")).render(e.jsx(ss.StrictMode,{children:e.jsx(na,{})}));
