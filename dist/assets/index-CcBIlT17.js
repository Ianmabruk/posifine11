import{a as cc,b as dc,g as uc,r as h,u as Ee,c as Bi,N as ae,R as _i,d as X,B as mc,e as hc}from"./vendor-Ct1st1Nj.js";import{C as ft,D as $e,T as Ae,P as De,S as Ui,a as Xs,b as qi,c as ct,d as bn,e as it,f as Kt,g as ge,h as xc,i as pc,j as qt,k as Et,l as ze,m as zi,n as fc,o as Wi,L as Ve,U as nr,p as rr,q as Tt,E as Hi,M as ir,r as be,B as Ua,s as ua,H as pt,t as qa,X as Qe,u as tt,v as yn,w as or,x as At,y as jn,R as gc,I as bc,z as Xe,A as za,F as Ze,G as ls,J as zt,K as Ki,N as yc,O as jc,Q as vc,V as Nc,W as Gi,Y as wc,Z as Sc,_ as ot,$ as Ji,a0 as Yi,a1 as kc,a2 as Wa,a3 as Cc,a4 as Ha,a5 as Ka,a6 as Pc,a7 as Tc,a8 as Ac,a9 as Xi,aa as Dc,ab as Zs,ac as lr,ad as Vs,ae as Qs,af as ps,ag as Ec,ah as Ic,ai as Zi,aj as Rc,ak as Lc,al as Mc,am as Fc,an as Qi,ao as Oc,ap as $c,aq as Vc,ar as Bc,as as _c,at as Uc,au as eo,av as Wt,aw as cr}from"./icons-DM7M4H78.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();var va={exports:{}},es={};var dr;function qc(){if(dr)return es;dr=1;var t=cc(),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(l,c,d){var u,x={},m=null,b=null;d!==void 0&&(m=""+d),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(b=c.ref);for(u in c)n.call(c,u)&&!o.hasOwnProperty(u)&&(x[u]=c[u]);if(l&&l.defaultProps)for(u in c=l.defaultProps,c)x[u]===void 0&&(x[u]=c[u]);return{$$typeof:s,type:l,key:m,ref:b,props:x,_owner:r.current}}return es.Fragment=a,es.jsx=i,es.jsxs=i,es}var ur;function zc(){return ur||(ur=1,va.exports=qc()),va.exports}var e=zc(),Es={},mr;function Wc(){if(mr)return Es;mr=1;var t=dc();return Es.createRoot=t.createRoot,Es.hydrateRoot=t.hydrateRoot,Es}var Hc=Wc();const Kc=uc(Hc),Gc=()=>"https://universal-backend-w0x1.onrender.com/api",ee=Gc(),to=()=>localStorage.getItem("token"),so=async(t,s={},a=0,n=3)=>{const r=to(),o=t.startsWith("/")?t:`/${t}`,i={...s,headers:{"Content-Type":"application/json",...r&&!(o.startsWith("/auth")&&o!=="/auth/me")&&!o.includes("/main-admin/auth/login")&&{Authorization:`Bearer ${r}`},...s.headers}};try{const l=await fetch(`${ee}${o}`,i);if(l.status===401){if(o.includes("/auth/login")||o.includes("/main-admin/auth/login")){const b=await l.json().catch(()=>({error:"Unauthorized"}));throw new Error(b.error||"Invalid credentials")}localStorage.removeItem("token"),localStorage.removeItem("user");const d=window.location.pathname||"";if(!["/","/get-started","/choose-subscription","/plans","/subscription","/build-pos","/login","/signup","/auth","/main.admin"].some(b=>d===b||d.startsWith(b)))try{window.location.href="/auth/login"}catch{}const m=new Error("Unauthorized");throw m.status=401,m}if(l.status===500)throw new Error("Server error 500 - Backend unavailable");if(l.ok)return l.status===204?{success:!0}:await l.json();const c=await l.json().catch(()=>({error:"Network error"}));throw new Error(c.error||`HTTP ${l.status}: ${l.statusText}`)}catch(l){if(l.name==="TypeError"&&l.message.includes("fetch")){if(console.error(`API Fetch Error (attempt ${a+1}/${n+1}):`,l),console.error("Attempted URL:",`${ee}${o}`),a<n){const c=Math.min(1e3*Math.pow(2,a),1e4);return console.log(`Retrying in ${c}ms...`),await new Promise(d=>setTimeout(d,c)),so(t,s,a+1,n)}throw new Error("Cannot connect to server. The server may be waking up. Please try again in a moment.")}throw l}},z=(t,s={})=>so(t,s,0,3),Ft={login:t=>z("/auth/login",{method:"POST",body:JSON.stringify(t)}),pinLogin:t=>z("/auth/pin-login",{method:"POST",body:JSON.stringify(t)}),signup:t=>z("/auth/signup",{method:"POST",body:JSON.stringify(t)}),signupWithPayment:t=>z("/signup-with-payment",{method:"POST",body:JSON.stringify(t)}),me:()=>z("/auth/me"),updatePin:t=>z("/auth/update-pin",{method:"POST",body:JSON.stringify({pin:t})})},kt={getAll:()=>z("/users"),create:t=>z("/users",{method:"POST",body:JSON.stringify(t)}),update:(t,s)=>z(`/users/${t}`,{method:"PUT",body:JSON.stringify(s)}),delete:t=>z(`/users/${t}`,{method:"DELETE"}),setPin:(t,s)=>z(`/users/${t}/set-pin`,{method:"POST",body:JSON.stringify({pin:s})}),lock:(t,s)=>z(`/users/${t}/lock`,{method:"POST",body:JSON.stringify({locked:s})})},Ie={getAll:()=>z("/products"),create:t=>z("/products",{method:"POST",body:JSON.stringify(t)}),update:(t,s)=>z(`/products/${t}`,{method:"PUT",body:JSON.stringify(s)}),delete:t=>z(`/products/${t}`,{method:"DELETE"}),getLowStockWarnings:()=>z("/products/low-stock-warnings"),updateStock:(t,s)=>z(`/products/${t}/stock`,{method:"PUT",body:JSON.stringify(s)}),getMaxProducible:t=>z(`/products/${t}/max-producible`),getWeightPricing:t=>z(`/products/${t}/weight-pricing`),addWeightPrice:(t,s,a)=>z(`/products/${t}/weight-pricing`,{method:"POST",body:JSON.stringify({weight:s,price:a})}),updateWeightPrice:(t,s,a)=>z(`/products/${t}/weight-pricing`,{method:"PUT",body:JSON.stringify({weight:s,price:a})}),deleteWeightPrice:(t,s)=>z(`/products/${t}/weight-pricing`,{method:"DELETE",body:JSON.stringify({weight:s})})},ma={getAll:()=>z("/sales"),create:t=>z("/sales",{method:"POST",body:JSON.stringify(t)}),delete:t=>z(`/sales/${t}`,{method:"DELETE"}),adminComplete:t=>z("/admin-complete-sale",{method:"POST",body:JSON.stringify(t)})},ea={getAll:()=>z("/expenses"),create:t=>z("/expenses",{method:"POST",body:JSON.stringify(t)}),update:(t,s)=>z(`/expenses/${t}`,{method:"PUT",body:JSON.stringify(s)}),delete:t=>z(`/expenses/${t}`,{method:"DELETE"})},ao={get:()=>z("/stats")},rs={getAll:()=>z("/discounts"),create:t=>z("/discounts",{method:"POST",body:JSON.stringify(t)}),update:(t,s)=>z(`/discounts/${t}`,{method:"PUT",body:JSON.stringify(s)}),delete:t=>z(`/discounts/${t}`,{method:"DELETE"})},Bs={getAll:()=>z("/credit-requests"),create:t=>z("/credit-requests",{method:"POST",body:JSON.stringify(t)}),update:(t,s)=>z(`/credit-requests/${t}`,{method:"PUT",body:JSON.stringify(s)}),approve:t=>z(`/credit-requests/${t}/approve`,{method:"POST"}),reject:t=>z(`/credit-requests/${t}/reject`,{method:"POST"})},cs={get:()=>z("/settings"),update:t=>z("/settings",{method:"PUT",body:JSON.stringify(t)})},_s={getAll:()=>z("/time-entries"),getStatus:()=>z("/clock-status"),create:t=>z("/time-entries",{method:"POST",body:JSON.stringify({action:t})}),update:(t,s)=>z(`/time-entries/${t}`,{method:"PUT",body:JSON.stringify(s)}),delete:t=>z(`/time-entries/${t}`,{method:"DELETE"})},ta={getAll:t=>{const s=t?`/batches?productId=${t}`:"/batches";return z(s)},create:t=>z("/batches",{method:"POST",body:JSON.stringify(t)})},Na={login:t=>z("/main-admin/auth/login",{method:"POST",body:JSON.stringify(t)}),getUsers:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/users",{headers:{Authorization:`Bearer ${t}`}})},getStats:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/stats",{headers:{Authorization:`Bearer ${t}`}})},getActivities:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/activities",{headers:{Authorization:`Bearer ${t}`}})},getSalesAll:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/sales-all",{headers:{Authorization:`Bearer ${t}`}})},getTimeEntriesAll:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/time-entries-all",{headers:{Authorization:`Bearer ${t}`}})},lockUser:(t,s)=>{const a=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z(`/main-admin/users/${t}/lock`,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:JSON.stringify({locked:s})})},changePlan:(t,s)=>{const a=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z(`/main-admin/users/${t}/plan`,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:JSON.stringify({plan:s})})},clearData:t=>{const s=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/system/clear-data",{method:"POST",headers:{Authorization:`Bearer ${s}`},body:JSON.stringify({type:t})})},getSubscribers:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/subscribers",{headers:{Authorization:`Bearer ${t}`}})},getSubscribersAnalytics:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/subscribers/analytics",{headers:{Authorization:`Bearer ${t}`}})},getUsersWithSubscriptions:()=>{const t=localStorage.getItem("token")||localStorage.getItem("ownerToken")||localStorage.getItem("mainAdminToken");return z("/main-admin/users-with-subscriptions",{headers:{Authorization:`Bearer ${t}`}})}};let Ue=null,Us=new Set;function Jc(){const t=ee.replace(/\/api$/,"");return`${t.startsWith("https")?"wss":"ws"}://${t.replace(/^https?:\/\//,"")}/api/ws/products`}function Yc(){if(Ue&&(Ue.readyState===WebSocket.OPEN||Ue.readyState===WebSocket.CONNECTING))return;const t=to(),s=Jc()+(t?`?token=${encodeURIComponent(t)}`:"");Ue=new WebSocket(s),Ue.onopen=()=>{console.debug("Products WS connected")},Ue.onmessage=a=>{let n=null;try{n=JSON.parse(a.data)}catch{return}Us.forEach(r=>{try{r(n)}catch(o){console.error("ws callback error",o)}})},Ue.onclose=()=>{console.debug("Products WS closed"),Ue=null},Ue.onerror=a=>{console.error("Products WS error",a)}}function Xc(t){if(typeof t!="function")throw new Error("subscribeProducts requires a callback");return Us.add(t),Yc(),()=>{if(Us.delete(t),Ue&&Us.size===0){try{Ue.close()}catch{}Ue=null}}}const Pe={get:t=>z(t,{method:"GET"}),post:(t,s)=>z(t,{method:"POST",body:JSON.stringify(s)}),put:(t,s)=>z(t,{method:"PUT",body:JSON.stringify(s)}),delete:t=>z(t,{method:"DELETE"})},no=h.createContext(),re=()=>h.useContext(no),Zc=({children:t})=>{const[s,a]=h.useState(null),[n,r]=h.useState(!0),[o,i]=h.useState(!1),[l,c]=h.useState({});h.useEffect(()=>{d()},[]),h.useEffect(()=>{const E=()=>{const F=localStorage.getItem("user");if(F)try{const te=JSON.parse(F);a(te)}catch(te){console.warn("Failed to parse user from localStorage",te)}else a(null)};return window.addEventListener("storage",E),window.addEventListener("localStorageUpdated",E),()=>{window.removeEventListener("storage",E),window.removeEventListener("localStorageUpdated",E)}},[]);const d=async()=>{try{const E=localStorage.getItem("token"),F=localStorage.getItem("user");if(E)try{const te=await fetch(`${ee}/auth/me`,{headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"}});if(te.ok){const ye=await te.json();a(ye),localStorage.setItem("user",JSON.stringify(ye))}else throw new Error("Invalid token")}catch(te){console.warn("Auth check failed:",te),localStorage.removeItem("token"),localStorage.removeItem("user")}}catch(E){console.error("Error initializing auth:",E),localStorage.removeItem("token"),localStorage.removeItem("user"),a(null)}finally{r(!1),i(!0)}},u=async E=>{try{if(E&&E.token&&E.user)return localStorage.setItem("token",E.token),localStorage.setItem("user",JSON.stringify(E.user)),a(E.user),E;const F=await Ft.login(E);if(F.token&&F.user)return localStorage.setItem("token",F.token),localStorage.setItem("user",JSON.stringify(F.user)),a(F.user),F;throw new Error("Invalid response from server")}catch(F){throw console.error("Login failed:",F),F}},x=async E=>{try{const F=await Ft.signup(E);if(F.token&&F.user)return localStorage.setItem("token",F.token),localStorage.setItem("user",JSON.stringify(F.user)),a(F.user),F;throw new Error("Invalid response from server")}catch(F){throw console.error("Signup failed:",F),F}},m=async E=>{try{if(localStorage.setItem("user",JSON.stringify(E)),a(E),window.dispatchEvent(new Event("localStorageUpdated")),E&&E.id)try{await kt.update(E.id,E)}catch(F){console.warn("Failed to persist updated user to backend",F)}return E}catch(F){throw console.error("updateUser failed:",F),F}},b=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),a(null),window.location.href="/auth/login"},f=()=>!!s&&!!localStorage.getItem("token"),y=E=>s&&s.role===E,g=()=>s&&s.role==="owner",p=()=>s&&(s.role==="admin"||s.role==="main-admin"),v=()=>s&&s.role==="cashier",j=(E=null)=>{const F=E||s?.role;return F==="owner"?"/main-admin":F==="admin"?"/admin":F==="cashier"?"/cashier":"/dashboard"},S=()=>s&&s.plan==="ultra",P=()=>s&&s.plan==="basic",T=()=>s&&(s.role==="admin"||s.role==="cashier"),M=()=>s&&s.role==="admin"&&s.plan==="ultra",N=()=>s&&s.role==="admin",A=()=>!0,L=()=>!0;return s?.locked?e.jsx(LockedAccount,{}):e.jsx(no.Provider,{value:{user:s,loading:n,isInitialized:o,appSettings:l,login:u,signup:x,updateUser:m,logout:b,isAuthenticated:f,hasRole:y,isOwner:g,isAdmin:p,isCashier:v,getDashboardUrl:j,isUltraPackage:S,isBasicPackage:P,canEditStock:T,canManageUsers:M,canViewAnalytics:N,isRealTimeProductSyncEnabled:A,isCashierUserManagementEnabled:L},children:t})};new Date().toISOString();const ro=h.createContext(),vn=()=>h.useContext(ro),Qc=({children:t})=>{const{user:s}=re(),[a,n]=h.useState([]),[r,o]=h.useState(!0),[i,l]=h.useState(null),[c,d]=h.useState(Date.now()),u=h.useCallback(async()=>{if(!localStorage.getItem("token"))return o(!1),[];try{const m=await Ie.getAll(),f=(Array.isArray(m)?m:[]).filter(y=>!y.pendingDelete);return n(f),l(null),window.dispatchEvent(new CustomEvent("productsSync",{detail:{products:f,timestamp:Date.now()}})),typeof window<"u"&&setTimeout(()=>{window.dispatchEvent(new Event("productUpdated"))},100),f}catch(m){return console.error("Failed to fetch products:",m),l(`Failed to load products: ${m.message}`),n([]),[]}finally{o(!1),d(Date.now())}},[]);h.useEffect(()=>{u()},[]),h.useEffect(()=>{const m=()=>{console.log("ðŸ”„ Data cleared event received - forcing products refresh"),n([]),l(null),u()};return window.addEventListener("dataCleared",m),window.addEventListener("productsCleared",m),()=>{window.removeEventListener("dataCleared",m),window.removeEventListener("productsCleared",m)}},[]);const x=async()=>(o(!0),await u());return e.jsx(ro.Provider,{value:{products:a,loading:r,error:i,lastUpdated:c,refreshProducts:x},children:t})},io=h.createContext(),oo=()=>h.useContext(io),ed=900*1e3,td=({children:t})=>{const{user:s}=re(),[a,n]=h.useState(!1),r=h.useRef(null),o=h.useRef(Date.now()),i=h.useCallback(()=>{o.current=Date.now(),r.current&&clearTimeout(r.current),r.current=setTimeout(()=>{n(!0),console.log("ðŸ”’ Screen locked due to inactivity")},ed)},[]);h.useEffect(()=>{const u=["mousedown","keydown","click","touchstart"];return u.forEach(x=>{document.addEventListener(x,i)}),i(),()=>{u.forEach(x=>{document.removeEventListener(x,i)}),r.current&&clearTimeout(r.current)}},[i]);const l=h.useCallback(()=>{n(!0),console.log("ðŸ”’ Screen manually locked")},[]),c=h.useCallback(()=>{n(!1),i(),console.log("ðŸ”“ Screen unlocked")},[i]),d={isLocked:a,lock:l,unlock:c};return e.jsx(io.Provider,{value:d,children:t})};function sd(){const[t,s]=h.useState({stats:{totalSales:0,totalExpenses:0,profit:0,grossProfit:0,netProfit:0,totalCOGS:0,dailySales:0,weeklySales:0,productCount:0},recentSales:[]}),[a,n]=h.useState(!0),[r,o]=h.useState(null);h.useEffect(()=>{i()},[]);const i=async()=>{try{o(null);const[d,u]=await Promise.all([ao.get(),ma.getAll()]),x={totalSales:d?.totalSales||0,totalExpenses:d?.totalExpenses||0,profit:d?.profit||0,grossProfit:d?.grossProfit||0,netProfit:d?.netProfit||0,totalCOGS:d?.totalCOGS||0,dailySales:d?.dailySales||0,weeklySales:d?.weeklySales||0,productCount:d?.productCount||0},m=Array.isArray(u)?u:[];s({stats:x,recentSales:m.slice(-10).reverse()})}catch(d){console.error("Failed to load data:",d),o(d.message),s({stats:{totalSales:0,totalExpenses:0,profit:0,grossProfit:0,netProfit:0,totalCOGS:0,dailySales:0,weeklySales:0,productCount:0},recentSales:[]})}finally{n(!1)}};if(a)return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(r&&t.stats.totalSales===0&&t.recentSales.length===0)return e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx(ft,{className:"w-12 h-12 text-red-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Unable to Load Dashboard"}),e.jsx("p",{className:"text-red-600 mb-4",children:r}),e.jsx("button",{onClick:i,className:"btn-primary",children:"Retry"})]})});const l=[{label:"Total Sales",value:`KSH ${t.stats.totalSales?.toLocaleString()||0}`,icon:$e,color:"from-green-500 to-emerald-600",change:"+12.5%"},{label:"Gross Profit",value:`KSH ${t.stats.grossProfit?.toLocaleString()||0}`,icon:Ae,color:"from-blue-500 to-indigo-600",change:"+8.2%"},{label:"Total COGS",value:`KSH ${t.stats.totalCOGS?.toLocaleString()||0}`,icon:De,color:"from-orange-500 to-red-600",change:"+5.1%"},{label:"Net Profit",value:`KSH ${t.stats.netProfit?.toLocaleString()||0}`,icon:Ae,color:"from-purple-500 to-pink-600",change:"+15.3%"}],c=[{label:"Daily Sales",value:`KSH ${t.stats.dailySales?.toLocaleString()||0}`,icon:Ui,color:"bg-blue-50 text-blue-600"},{label:"Weekly Sales",value:`KSH ${t.stats.weeklySales?.toLocaleString()||0}`,icon:Ae,color:"bg-green-50 text-green-600"},{label:"Total Expenses",value:`KSH ${t.stats.totalExpenses?.toLocaleString()||0}`,icon:Xs,color:"bg-red-50 text-red-600"},{label:"Products",value:t.stats.productCount||0,icon:De,color:"bg-purple-50 text-purple-600"}];return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:(l||[]).map((d,u)=>{const x=d?.icon;return x?e.jsxs("div",{className:`card bg-gradient-to-br ${d.color} text-white border-0 shadow-lg hover:shadow-xl transition-all transform hover:scale-105`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx(x,{className:"w-6 h-6"})}),e.jsx("span",{className:"text-sm font-semibold bg-white/20 px-2 py-1 rounded-full",children:d.change})]}),e.jsx("p",{className:"text-sm text-white/80 mb-1",children:d.label}),e.jsx("p",{className:"text-2xl font-bold",children:d.value})]},u):null})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:(c||[]).map((d,u)=>{const x=d?.icon;return x?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl ${d.color} flex items-center justify-center`,children:e.jsx(x,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:d.label}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:d.value})]})]})},u):null})}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recent Sales"}),e.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All"})]}),!t.recentSales||t.recentSales.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ft,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No sales yet"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"COGS"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Profit"})]})}),e.jsx("tbody",{children:(t.recentSales||[]).map(d=>d?e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:d.createdAt?new Date(d.createdAt).toLocaleString():"N/A"}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[Array.isArray(d.items)?d.items.length:0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:d.paymentMethod||"N/A"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",d.total?.toLocaleString()||0]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-orange-600",children:["KSH ",d.cogs?.toLocaleString()||0]}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-blue-600",children:["KSH ",d.profit?.toLocaleString()||0]})]},d.id||Math.random()):null)})]})})]})]})}const Nn=h.createContext({});function gt(t){const s=h.useRef(null);return s.current===null&&(s.current=t()),s.current}const lo=typeof window<"u",ha=lo?h.useLayoutEffect:h.useEffect,xa=h.createContext(null);function wn(t,s){t.indexOf(s)===-1&&t.push(s)}function Sn(t,s){const a=t.indexOf(s);a>-1&&t.splice(a,1)}const et=(t,s,a)=>a>s?s:a<t?t:a;let fs=()=>{};const ut={},co=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function uo(t){return typeof t=="object"&&t!==null}const mo=t=>/^0[^.\s]+$/u.test(t);function kn(t){let s;return()=>(s===void 0&&(s=t()),s)}const Oe=t=>t,ad=(t,s)=>a=>s(t(a)),vs=(...t)=>t.reduce(ad),Ht=(t,s,a)=>{const n=s-t;return n===0?1:(a-t)/n};class Cn{constructor(){this.subscriptions=[]}add(s){return wn(this.subscriptions,s),()=>Sn(this.subscriptions,s)}notify(s,a,n){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](s,a,n);else for(let o=0;o<r;o++){const i=this.subscriptions[o];i&&i(s,a,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const dt=t=>t*1e3,qe=t=>t/1e3;function Pn(t,s){return s?t*(1e3/s):0}const ho=(t,s,a)=>(((1-3*a+3*s)*t+(3*a-6*s))*t+3*s)*t,nd=1e-7,rd=12;function id(t,s,a,n,r){let o,i,l=0;do i=s+(a-s)/2,o=ho(i,n,r)-t,o>0?a=i:s=i;while(Math.abs(o)>nd&&++l<rd);return i}function Ns(t,s,a,n){if(t===s&&a===n)return Oe;const r=o=>id(o,0,1,t,a);return o=>o===0||o===1?o:ho(r(o),s,n)}const xo=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,po=t=>s=>1-t(1-s),fo=Ns(.33,1.53,.69,.99),Tn=po(fo),go=xo(Tn),bo=t=>(t*=2)<1?.5*Tn(t):.5*(2-Math.pow(2,-10*(t-1))),An=t=>1-Math.sin(Math.acos(t)),yo=po(An),jo=xo(An),od=Ns(.42,0,1,1),ld=Ns(0,0,.58,1),vo=Ns(.42,0,.58,1),cd=t=>Array.isArray(t)&&typeof t[0]!="number",No=t=>Array.isArray(t)&&typeof t[0]=="number",dd={linear:Oe,easeIn:od,easeInOut:vo,easeOut:ld,circIn:An,circInOut:jo,circOut:yo,backIn:Tn,backInOut:go,backOut:fo,anticipate:bo},ud=t=>typeof t=="string",hr=t=>{if(No(t)){fs(t.length===4);const[s,a,n,r]=t;return Ns(s,a,n,r)}else if(ud(t))return dd[t];return t},Is=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function md(t,s){let a=new Set,n=new Set,r=!1,o=!1;const i=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(u){i.has(u)&&(d.schedule(u),t()),u(l)}const d={schedule:(u,x=!1,m=!1)=>{const f=m&&r?a:n;return x&&i.add(u),f.has(u)||f.add(u),u},cancel:u=>{n.delete(u),i.delete(u)},process:u=>{if(l=u,r){o=!0;return}r=!0,[a,n]=[n,a],a.forEach(c),a.clear(),r=!1,o&&(o=!1,d.process(u))}};return d}const hd=40;function wo(t,s){let a=!1,n=!0;const r={delta:0,timestamp:0,isProcessing:!1},o=()=>a=!0,i=Is.reduce((j,S)=>(j[S]=md(o),j),{}),{setup:l,read:c,resolveKeyframes:d,preUpdate:u,update:x,preRender:m,render:b,postRender:f}=i,y=()=>{const j=ut.useManualTiming?r.timestamp:performance.now();a=!1,ut.useManualTiming||(r.delta=n?1e3/60:Math.max(Math.min(j-r.timestamp,hd),1)),r.timestamp=j,r.isProcessing=!0,l.process(r),c.process(r),d.process(r),u.process(r),x.process(r),m.process(r),b.process(r),f.process(r),r.isProcessing=!1,a&&s&&(n=!1,t(y))},g=()=>{a=!0,n=!0,r.isProcessing||t(y)};return{schedule:Is.reduce((j,S)=>{const P=i[S];return j[S]=(T,M=!1,N=!1)=>(a||g(),P.schedule(T,M,N)),j},{}),cancel:j=>{for(let S=0;S<Is.length;S++)i[Is[S]].cancel(j)},state:r,steps:i}}const{schedule:le,cancel:We,state:ke,steps:wa}=wo(typeof requestAnimationFrame<"u"?requestAnimationFrame:Oe,!0);let qs;function xd(){qs=void 0}const Re={now:()=>(qs===void 0&&Re.set(ke.isProcessing||ut.useManualTiming?ke.timestamp:performance.now()),qs),set:t=>{qs=t,queueMicrotask(xd)}},So=t=>s=>typeof s=="string"&&s.startsWith(t),ko=So("--"),pd=So("var(--"),Dn=t=>pd(t)?fd.test(t.split("/*")[0].trim()):!1,fd=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function xr(t){return typeof t!="string"?!1:t.split("/*")[0].includes("var(--")}const Gt={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},gs={...Gt,transform:t=>et(0,1,t)},Rs={...Gt,default:1},ds=t=>Math.round(t*1e5)/1e5,En=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function gd(t){return t==null}const bd=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,In=(t,s)=>a=>!!(typeof a=="string"&&bd.test(a)&&a.startsWith(t)||s&&!gd(a)&&Object.prototype.hasOwnProperty.call(a,s)),Co=(t,s,a)=>n=>{if(typeof n!="string")return n;const[r,o,i,l]=n.match(En);return{[t]:parseFloat(r),[s]:parseFloat(o),[a]:parseFloat(i),alpha:l!==void 0?parseFloat(l):1}},yd=t=>et(0,255,t),Sa={...Gt,transform:t=>Math.round(yd(t))},Ct={test:In("rgb","red"),parse:Co("red","green","blue"),transform:({red:t,green:s,blue:a,alpha:n=1})=>"rgba("+Sa.transform(t)+", "+Sa.transform(s)+", "+Sa.transform(a)+", "+ds(gs.transform(n))+")"};function jd(t){let s="",a="",n="",r="";return t.length>5?(s=t.substring(1,3),a=t.substring(3,5),n=t.substring(5,7),r=t.substring(7,9)):(s=t.substring(1,2),a=t.substring(2,3),n=t.substring(3,4),r=t.substring(4,5),s+=s,a+=a,n+=n,r+=r),{red:parseInt(s,16),green:parseInt(a,16),blue:parseInt(n,16),alpha:r?parseInt(r,16)/255:1}}const Ga={test:In("#"),parse:jd,transform:Ct.transform},ws=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),ht=ws("deg"),rt=ws("%"),W=ws("px"),vd=ws("vh"),Nd=ws("vw"),pr={...rt,parse:t=>rt.parse(t)/100,transform:t=>rt.transform(t*100)},Ot={test:In("hsl","hue"),parse:Co("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:a,alpha:n=1})=>"hsla("+Math.round(t)+", "+rt.transform(ds(s))+", "+rt.transform(ds(a))+", "+ds(gs.transform(n))+")"},je={test:t=>Ct.test(t)||Ga.test(t)||Ot.test(t),parse:t=>Ct.test(t)?Ct.parse(t):Ot.test(t)?Ot.parse(t):Ga.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Ct.transform(t):Ot.transform(t),getAnimatableNone:t=>{const s=je.parse(t);return s.alpha=0,je.transform(s)}},wd=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Sd(t){return isNaN(t)&&typeof t=="string"&&(t.match(En)?.length||0)+(t.match(wd)?.length||0)>0}const Po="number",To="color",kd="var",Cd="var(",fr="${}",Pd=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function bs(t){const s=t.toString(),a=[],n={color:[],number:[],var:[]},r=[];let o=0;const l=s.replace(Pd,c=>(je.test(c)?(n.color.push(o),r.push(To),a.push(je.parse(c))):c.startsWith(Cd)?(n.var.push(o),r.push(kd),a.push(c)):(n.number.push(o),r.push(Po),a.push(parseFloat(c))),++o,fr)).split(fr);return{values:a,split:l,indexes:n,types:r}}function Ao(t){return bs(t).values}function Do(t){const{split:s,types:a}=bs(t),n=s.length;return r=>{let o="";for(let i=0;i<n;i++)if(o+=s[i],r[i]!==void 0){const l=a[i];l===Po?o+=ds(r[i]):l===To?o+=je.transform(r[i]):o+=r[i]}return o}}const Td=t=>typeof t=="number"?0:je.test(t)?je.getAnimatableNone(t):t;function Ad(t){const s=Ao(t);return Do(t)(s.map(Td))}const bt={test:Sd,parse:Ao,createTransformer:Do,getAnimatableNone:Ad};function ka(t,s,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?t+(s-t)*6*a:a<1/2?s:a<2/3?t+(s-t)*(2/3-a)*6:t}function Dd({hue:t,saturation:s,lightness:a,alpha:n}){t/=360,s/=100,a/=100;let r=0,o=0,i=0;if(!s)r=o=i=a;else{const l=a<.5?a*(1+s):a+s-a*s,c=2*a-l;r=ka(c,l,t+1/3),o=ka(c,l,t),i=ka(c,l,t-1/3)}return{red:Math.round(r*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:n}}function sa(t,s){return a=>a>0?s:t}const xe=(t,s,a)=>t+(s-t)*a,Ca=(t,s,a)=>{const n=t*t,r=a*(s*s-n)+n;return r<0?0:Math.sqrt(r)},Ed=[Ga,Ct,Ot],Id=t=>Ed.find(s=>s.test(t));function gr(t){const s=Id(t);if(!s)return!1;let a=s.parse(t);return s===Ot&&(a=Dd(a)),a}const br=(t,s)=>{const a=gr(t),n=gr(s);if(!a||!n)return sa(t,s);const r={...a};return o=>(r.red=Ca(a.red,n.red,o),r.green=Ca(a.green,n.green,o),r.blue=Ca(a.blue,n.blue,o),r.alpha=xe(a.alpha,n.alpha,o),Ct.transform(r))},Ja=new Set(["none","hidden"]);function Rd(t,s){return Ja.has(t)?a=>a<=0?t:s:a=>a>=1?s:t}function Ld(t,s){return a=>xe(t,s,a)}function Rn(t){return typeof t=="number"?Ld:typeof t=="string"?Dn(t)?sa:je.test(t)?br:Od:Array.isArray(t)?Eo:typeof t=="object"?je.test(t)?br:Md:sa}function Eo(t,s){const a=[...t],n=a.length,r=t.map((o,i)=>Rn(o)(o,s[i]));return o=>{for(let i=0;i<n;i++)a[i]=r[i](o);return a}}function Md(t,s){const a={...t,...s},n={};for(const r in a)t[r]!==void 0&&s[r]!==void 0&&(n[r]=Rn(t[r])(t[r],s[r]));return r=>{for(const o in n)a[o]=n[o](r);return a}}function Fd(t,s){const a=[],n={color:0,var:0,number:0};for(let r=0;r<s.values.length;r++){const o=s.types[r],i=t.indexes[o][n[o]],l=t.values[i]??0;a[r]=l,n[o]++}return a}const Od=(t,s)=>{const a=bt.createTransformer(s),n=bs(t),r=bs(s);return n.indexes.var.length===r.indexes.var.length&&n.indexes.color.length===r.indexes.color.length&&n.indexes.number.length>=r.indexes.number.length?Ja.has(t)&&!r.values.length||Ja.has(s)&&!n.values.length?Rd(t,s):vs(Eo(Fd(n,r),r.values),a):sa(t,s)};function Io(t,s,a){return typeof t=="number"&&typeof s=="number"&&typeof a=="number"?xe(t,s,a):Rn(t)(t,s)}const $d=t=>{const s=({timestamp:a})=>t(a);return{start:(a=!0)=>le.update(s,a),stop:()=>We(s),now:()=>ke.isProcessing?ke.timestamp:Re.now()}},Ro=(t,s,a=10)=>{let n="";const r=Math.max(Math.round(s/a),2);for(let o=0;o<r;o++)n+=Math.round(t(o/(r-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},aa=2e4;function Ln(t){let s=0;const a=50;let n=t.next(s);for(;!n.done&&s<aa;)s+=a,n=t.next(s);return s>=aa?1/0:s}function Vd(t,s=100,a){const n=a({...t,keyframes:[0,s]}),r=Math.min(Ln(n),aa);return{type:"keyframes",ease:o=>n.next(r*o).value/s,duration:qe(r)}}const Bd=5;function Lo(t,s,a){const n=Math.max(s-Bd,0);return Pn(a-t(n),s-n)}const fe={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Pa=.001;function _d({duration:t=fe.duration,bounce:s=fe.bounce,velocity:a=fe.velocity,mass:n=fe.mass}){let r,o,i=1-s;i=et(fe.minDamping,fe.maxDamping,i),t=et(fe.minDuration,fe.maxDuration,qe(t)),i<1?(r=d=>{const u=d*i,x=u*t,m=u-a,b=Ya(d,i),f=Math.exp(-x);return Pa-m/b*f},o=d=>{const x=d*i*t,m=x*a+a,b=Math.pow(i,2)*Math.pow(d,2)*t,f=Math.exp(-x),y=Ya(Math.pow(d,2),i);return(-r(d)+Pa>0?-1:1)*((m-b)*f)/y}):(r=d=>{const u=Math.exp(-d*t),x=(d-a)*t+1;return-Pa+u*x},o=d=>{const u=Math.exp(-d*t),x=(a-d)*(t*t);return u*x});const l=5/t,c=qd(r,o,l);if(t=dt(t),isNaN(c))return{stiffness:fe.stiffness,damping:fe.damping,duration:t};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:i*2*Math.sqrt(n*d),duration:t}}}const Ud=12;function qd(t,s,a){let n=a;for(let r=1;r<Ud;r++)n=n-t(n)/s(n);return n}function Ya(t,s){return t*Math.sqrt(1-s*s)}const zd=["duration","bounce"],Wd=["stiffness","damping","mass"];function yr(t,s){return s.some(a=>t[a]!==void 0)}function Hd(t){let s={velocity:fe.velocity,stiffness:fe.stiffness,damping:fe.damping,mass:fe.mass,isResolvedFromDuration:!1,...t};if(!yr(t,Wd)&&yr(t,zd))if(t.visualDuration){const a=t.visualDuration,n=2*Math.PI/(a*1.2),r=n*n,o=2*et(.05,1,1-(t.bounce||0))*Math.sqrt(r);s={...s,mass:fe.mass,stiffness:r,damping:o}}else{const a=_d(t);s={...s,...a,mass:fe.mass},s.isResolvedFromDuration=!0}return s}function na(t=fe.visualDuration,s=fe.bounce){const a=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:n,restDelta:r}=a;const o=a.keyframes[0],i=a.keyframes[a.keyframes.length-1],l={done:!1,value:o},{stiffness:c,damping:d,mass:u,duration:x,velocity:m,isResolvedFromDuration:b}=Hd({...a,velocity:-qe(a.velocity||0)}),f=m||0,y=d/(2*Math.sqrt(c*u)),g=i-o,p=qe(Math.sqrt(c/u)),v=Math.abs(g)<5;n||(n=v?fe.restSpeed.granular:fe.restSpeed.default),r||(r=v?fe.restDelta.granular:fe.restDelta.default);let j;if(y<1){const P=Ya(p,y);j=T=>{const M=Math.exp(-y*p*T);return i-M*((f+y*p*g)/P*Math.sin(P*T)+g*Math.cos(P*T))}}else if(y===1)j=P=>i-Math.exp(-p*P)*(g+(f+p*g)*P);else{const P=p*Math.sqrt(y*y-1);j=T=>{const M=Math.exp(-y*p*T),N=Math.min(P*T,300);return i-M*((f+y*p*g)*Math.sinh(N)+P*g*Math.cosh(N))/P}}const S={calculatedDuration:b&&x||null,next:P=>{const T=j(P);if(b)l.done=P>=x;else{let M=P===0?f:0;y<1&&(M=P===0?dt(f):Lo(j,P,T));const N=Math.abs(M)<=n,A=Math.abs(i-T)<=r;l.done=N&&A}return l.value=l.done?i:T,l},toString:()=>{const P=Math.min(Ln(S),aa),T=Ro(M=>S.next(P*M).value,P,30);return P+"ms "+T},toTransition:()=>{}};return S}na.applyToOptions=t=>{const s=Vd(t,100,na);return t.ease=s.ease,t.duration=dt(s.duration),t.type="keyframes",t};function Xa({keyframes:t,velocity:s=0,power:a=.8,timeConstant:n=325,bounceDamping:r=10,bounceStiffness:o=500,modifyTarget:i,min:l,max:c,restDelta:d=.5,restSpeed:u}){const x=t[0],m={done:!1,value:x},b=N=>l!==void 0&&N<l||c!==void 0&&N>c,f=N=>l===void 0?c:c===void 0||Math.abs(l-N)<Math.abs(c-N)?l:c;let y=a*s;const g=x+y,p=i===void 0?g:i(g);p!==g&&(y=p-x);const v=N=>-y*Math.exp(-N/n),j=N=>p+v(N),S=N=>{const A=v(N),L=j(N);m.done=Math.abs(A)<=d,m.value=m.done?p:L};let P,T;const M=N=>{b(m.value)&&(P=N,T=na({keyframes:[m.value,f(m.value)],velocity:Lo(j,N,m.value),damping:r,stiffness:o,restDelta:d,restSpeed:u}))};return M(0),{calculatedDuration:null,next:N=>{let A=!1;return!T&&P===void 0&&(A=!0,S(N),M(N)),P!==void 0&&N>=P?T.next(N-P):(!A&&S(N),m)}}}function Kd(t,s,a){const n=[],r=a||ut.mix||Io,o=t.length-1;for(let i=0;i<o;i++){let l=r(t[i],t[i+1]);if(s){const c=Array.isArray(s)?s[i]||Oe:s;l=vs(c,l)}n.push(l)}return n}function Mn(t,s,{clamp:a=!0,ease:n,mixer:r}={}){const o=t.length;if(fs(o===s.length),o===1)return()=>s[0];if(o===2&&s[0]===s[1])return()=>s[1];const i=t[0]===t[1];t[0]>t[o-1]&&(t=[...t].reverse(),s=[...s].reverse());const l=Kd(s,n,r),c=l.length,d=u=>{if(i&&u<t[0])return s[0];let x=0;if(c>1)for(;x<t.length-2&&!(u<t[x+1]);x++);const m=Ht(t[x],t[x+1],u);return l[x](m)};return a?u=>d(et(t[0],t[o-1],u)):d}function Gd(t,s){const a=t[t.length-1];for(let n=1;n<=s;n++){const r=Ht(0,s,n);t.push(xe(a,1,r))}}function Mo(t){const s=[0];return Gd(s,t.length-1),s}function Jd(t,s){return t.map(a=>a*s)}function Yd(t,s){return t.map(()=>s||vo).splice(0,t.length-1)}function us({duration:t=300,keyframes:s,times:a,ease:n="easeInOut"}){const r=cd(n)?n.map(hr):hr(n),o={done:!1,value:s[0]},i=Jd(a&&a.length===s.length?a:Mo(s),t),l=Mn(i,s,{ease:Array.isArray(r)?r:Yd(s,r)});return{calculatedDuration:t,next:c=>(o.value=l(c),o.done=c>=t,o)}}const Xd=t=>t!==null;function Fn(t,{repeat:s,repeatType:a="loop"},n,r=1){const o=t.filter(Xd),l=r<0||s&&a!=="loop"&&s%2===1?0:o.length-1;return!l||n===void 0?o[l]:n}const Zd={decay:Xa,inertia:Xa,tween:us,keyframes:us,spring:na};function Fo(t){typeof t.type=="string"&&(t.type=Zd[t.type])}class On{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,a){return this.finished.then(s,a)}}const Qd=t=>t/100;class $n extends On{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:a}=this.options;a&&a.updatedAt!==Re.now()&&this.tick(Re.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;Fo(s);const{type:a=us,repeat:n=0,repeatDelay:r=0,repeatType:o,velocity:i=0}=s;let{keyframes:l}=s;const c=a||us;c!==us&&typeof l[0]!="number"&&(this.mixKeyframes=vs(Qd,Io(l[0],l[1])),l=[0,100]);const d=c({...s,keyframes:l});o==="mirror"&&(this.mirroredGenerator=c({...s,keyframes:[...l].reverse(),velocity:-i})),d.calculatedDuration===null&&(d.calculatedDuration=Ln(d));const{calculatedDuration:u}=d;this.calculatedDuration=u,this.resolvedDuration=u+r,this.totalDuration=this.resolvedDuration*(n+1)-r,this.generator=d}updateTime(s){const a=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(s,a=!1){const{generator:n,totalDuration:r,mixKeyframes:o,mirroredGenerator:i,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:d=0,keyframes:u,repeat:x,repeatType:m,repeatDelay:b,type:f,onUpdate:y,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-r/this.speed,this.startTime)),a?this.currentTime=s:this.updateTime(s);const p=this.currentTime-d*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?p<0:p>r;this.currentTime=Math.max(p,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let j=this.currentTime,S=n;if(x){const N=Math.min(this.currentTime,r)/l;let A=Math.floor(N),L=N%1;!L&&N>=1&&(L=1),L===1&&A--,A=Math.min(A,x+1),!!(A%2)&&(m==="reverse"?(L=1-L,b&&(L-=b/l)):m==="mirror"&&(S=i)),j=et(0,1,L)*l}const P=v?{done:!1,value:u[0]}:S.next(j);o&&(P.value=o(P.value));let{done:T}=P;!v&&c!==null&&(T=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const M=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return M&&f!==Xa&&(P.value=Fn(u,this.options,g,this.speed)),y&&y(P.value),M&&this.finish(),P}then(s,a){return this.finished.then(s,a)}get duration(){return qe(this.calculatedDuration)}get iterationDuration(){const{delay:s=0}=this.options||{};return this.duration+qe(s)}get time(){return qe(this.currentTime)}set time(s){s=dt(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(Re.now());const a=this.playbackSpeed!==s;this.playbackSpeed=s,a&&(this.time=qe(this.currentTime))}play(){if(this.isStopped)return;const{driver:s=$d,startTime:a}=this.options;this.driver||(this.driver=s(r=>this.tick(r))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=a??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Re.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),s.observe(this)}}function eu(t){for(let s=1;s<t.length;s++)t[s]??(t[s]=t[s-1])}const Pt=t=>t*180/Math.PI,Za=t=>{const s=Pt(Math.atan2(t[1],t[0]));return Qa(s)},tu={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Za,rotateZ:Za,skewX:t=>Pt(Math.atan(t[1])),skewY:t=>Pt(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Qa=t=>(t=t%360,t<0&&(t+=360),t),jr=Za,vr=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Nr=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),su={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:vr,scaleY:Nr,scale:t=>(vr(t)+Nr(t))/2,rotateX:t=>Qa(Pt(Math.atan2(t[6],t[5]))),rotateY:t=>Qa(Pt(Math.atan2(-t[2],t[0]))),rotateZ:jr,rotate:jr,skewX:t=>Pt(Math.atan(t[4])),skewY:t=>Pt(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function en(t){return t.includes("scale")?1:0}function tn(t,s){if(!t||t==="none")return en(s);const a=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,r;if(a)n=su,r=a;else{const l=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=tu,r=l}if(!r)return en(s);const o=n[s],i=r[1].split(",").map(nu);return typeof o=="function"?o(i):i[o]}const au=(t,s)=>{const{transform:a="none"}=getComputedStyle(t);return tn(a,s)};function nu(t){return parseFloat(t.trim())}const Jt=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Yt=new Set(Jt),wr=t=>t===Gt||t===W,ru=new Set(["x","y","z"]),iu=Jt.filter(t=>!ru.has(t));function ou(t){const s=[];return iu.forEach(a=>{const n=t.getValue(a);n!==void 0&&(s.push([a,n.get()]),n.set(a.startsWith("scale")?1:0))}),s}const xt={width:({x:t},{paddingLeft:s="0",paddingRight:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),height:({y:t},{paddingTop:s="0",paddingBottom:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:(t,{transform:s})=>tn(s,"x"),y:(t,{transform:s})=>tn(s,"y")};xt.translateX=xt.x;xt.translateY=xt.y;const Dt=new Set;let sn=!1,an=!1,nn=!1;function Oo(){if(an){const t=Array.from(Dt).filter(n=>n.needsMeasurement),s=new Set(t.map(n=>n.element)),a=new Map;s.forEach(n=>{const r=ou(n);r.length&&(a.set(n,r),n.render())}),t.forEach(n=>n.measureInitialState()),s.forEach(n=>{n.render();const r=a.get(n);r&&r.forEach(([o,i])=>{n.getValue(o)?.set(i)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}an=!1,sn=!1,Dt.forEach(t=>t.complete(nn)),Dt.clear()}function $o(){Dt.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(an=!0)})}function lu(){nn=!0,$o(),Oo(),nn=!1}class Vn{constructor(s,a,n,r,o,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=a,this.name=n,this.motionValue=r,this.element=o,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Dt.add(this),sn||(sn=!0,le.read($o),le.resolveKeyframes(Oo))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:a,element:n,motionValue:r}=this;if(s[0]===null){const o=r?.get(),i=s[s.length-1];if(o!==void 0)s[0]=o;else if(n&&a){const l=n.readValue(a,i);l!=null&&(s[0]=l)}s[0]===void 0&&(s[0]=i),r&&o===void 0&&r.set(s[0])}eu(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),Dt.delete(this)}cancel(){this.state==="scheduled"&&(Dt.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const cu=t=>t.startsWith("--");function du(t,s,a){cu(s)?t.style.setProperty(s,a):t.style[s]=a}const Vo=kn(()=>window.ScrollTimeline!==void 0),uu={};function mu(t,s){const a=kn(t);return()=>uu[s]??a()}const Bo=mu(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),is=([t,s,a,n])=>`cubic-bezier(${t}, ${s}, ${a}, ${n})`,Sr={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:is([0,.65,.55,1]),circOut:is([.55,0,1,.45]),backIn:is([.31,.01,.66,-.59]),backOut:is([.33,1.53,.69,.99])};function _o(t,s){if(t)return typeof t=="function"?Bo()?Ro(t,s):"ease-out":No(t)?is(t):Array.isArray(t)?t.map(a=>_o(a,s)||Sr.easeOut):Sr[t]}function hu(t,s,a,{delay:n=0,duration:r=300,repeat:o=0,repeatType:i="loop",ease:l="easeOut",times:c}={},d=void 0){const u={[s]:a};c&&(u.offset=c);const x=_o(l,r);Array.isArray(x)&&(u.easing=x);const m={delay:n,duration:r,easing:Array.isArray(x)?"linear":x,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"};return d&&(m.pseudoElement=d),t.animate(u,m)}function Uo(t){return typeof t=="function"&&"applyToOptions"in t}function xu({type:t,...s}){return Uo(t)&&Bo()?t.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class pu extends On{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!s)return;const{element:a,name:n,keyframes:r,pseudoElement:o,allowFlatten:i=!1,finalKeyframe:l,onComplete:c}=s;this.isPseudoElement=!!o,this.allowFlatten=i,this.options=s,fs(typeof s.type!="string");const d=xu(s);this.animation=hu(a,n,r,d,o),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){const u=Fn(r,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(u):du(a,n,u),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const s=this.animation.effect?.getComputedTiming?.().duration||0;return qe(Number(s))}get iterationDuration(){const{delay:s=0}=this.options||{};return this.duration+qe(s)}get time(){return qe(Number(this.animation.currentTime)||0)}set time(s){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=dt(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(s){this.manualStartTime=this.animation.startTime=s}attachTimeline({timeline:s,observe:a}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,s&&Vo()?(this.animation.timeline=s,Oe):a(this)}}const qo={anticipate:bo,backInOut:go,circInOut:jo};function fu(t){return t in qo}function gu(t){typeof t.ease=="string"&&fu(t.ease)&&(t.ease=qo[t.ease])}const Ta=10;class bu extends pu{constructor(s){gu(s),Fo(s),super(s),s.startTime!==void 0&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:a,onUpdate:n,onComplete:r,element:o,...i}=this.options;if(!a)return;if(s!==void 0){a.set(s);return}const l=new $n({...i,autoplay:!1}),c=Math.max(Ta,Re.now()-this.startTime),d=et(0,Ta,c-Ta);a.setWithVelocity(l.sample(Math.max(0,c-d)).value,l.sample(c).value,d),l.stop()}}const kr=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(bt.test(t)||t==="0")&&!t.startsWith("url("));function yu(t){const s=t[0];if(t.length===1)return!0;for(let a=0;a<t.length;a++)if(t[a]!==s)return!0}function ju(t,s,a,n){const r=t[0];if(r===null)return!1;if(s==="display"||s==="visibility")return!0;const o=t[t.length-1],i=kr(r,s),l=kr(o,s);return!i||!l?!1:yu(t)||(a==="spring"||Uo(a))&&n}function rn(t){t.duration=0,t.type="keyframes"}const vu=new Set(["opacity","clipPath","filter","transform"]),Nu=kn(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function wu(t){const{motionValue:s,name:a,repeatDelay:n,repeatType:r,damping:o,type:i}=t;if(!(s?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=s.owner.getProps();return Nu()&&a&&vu.has(a)&&(a!=="transform"||!d)&&!c&&!n&&r!=="mirror"&&o!==0&&i!=="inertia"}const Su=40;class ku extends On{constructor({autoplay:s=!0,delay:a=0,type:n="keyframes",repeat:r=0,repeatDelay:o=0,repeatType:i="loop",keyframes:l,name:c,motionValue:d,element:u,...x}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Re.now();const m={autoplay:s,delay:a,type:n,repeat:r,repeatDelay:o,repeatType:i,name:c,motionValue:d,element:u,...x},b=u?.KeyframeResolver||Vn;this.keyframeResolver=new b(l,(f,y,g)=>this.onKeyframesResolved(f,y,m,!g),c,d,u),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(s,a,n,r){this.keyframeResolver=void 0;const{name:o,type:i,velocity:l,delay:c,isHandoff:d,onUpdate:u}=n;this.resolvedAt=Re.now(),ju(s,o,i,l)||((ut.instantAnimations||!c)&&u?.(Fn(s,n,a)),s[0]=s[s.length-1],rn(n),n.repeat=0);const m={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>Su?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...n,keyframes:s},b=!d&&wu(m),f=m.motionValue?.owner?.current,y=b?new bu({...m,element:f}):new $n(m);y.finished.then(()=>{this.notifyFinished()}).catch(Oe),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(s,a){return this.finished.finally(s).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),lu()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function zo(t,s,a,n=0,r=1){const o=Array.from(t).sort((d,u)=>d.sortNodePosition(u)).indexOf(s),i=t.size,l=(i-1)*n;return typeof a=="function"?a(o,i):r===1?o*n:l-o*n}const Cu=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Pu(t){const s=Cu.exec(t);if(!s)return[,];const[,a,n,r]=s;return[`--${a??n}`,r]}function Wo(t,s,a=1){const[n,r]=Pu(t);if(!n)return;const o=window.getComputedStyle(s).getPropertyValue(n);if(o){const i=o.trim();return co(i)?parseFloat(i):i}return Dn(r)?Wo(r,s,a+1):r}const Tu={type:"spring",stiffness:500,damping:25,restSpeed:10},Au=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Du={type:"keyframes",duration:.8},Eu={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Iu=(t,{keyframes:s})=>s.length>2?Du:Yt.has(t)?t.startsWith("scale")?Au(s[1]):Tu:Eu,Ru=t=>t!==null;function Lu(t,{repeat:s,repeatType:a="loop"},n){const r=t.filter(Ru),o=s&&a!=="loop"&&s%2===1?0:r.length-1;return r[o]}function Bn(t,s){return t?.[s]??t?.default??t}function Mu({when:t,delay:s,delayChildren:a,staggerChildren:n,staggerDirection:r,repeat:o,repeatType:i,repeatDelay:l,from:c,elapsed:d,...u}){return!!Object.keys(u).length}const _n=(t,s,a,n={},r,o)=>i=>{const l=Bn(n,t)||{},c=l.delay||n.delay||0;let{elapsed:d=0}=n;d=d-dt(c);const u={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:s.getVelocity(),...l,delay:-d,onUpdate:m=>{s.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{i(),l.onComplete&&l.onComplete()},name:t,motionValue:s,element:o?void 0:r};Mu(l)||Object.assign(u,Iu(t,u)),u.duration&&(u.duration=dt(u.duration)),u.repeatDelay&&(u.repeatDelay=dt(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let x=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(rn(u),u.delay===0&&(x=!0)),(ut.instantAnimations||ut.skipAnimations)&&(x=!0,rn(u),u.delay=0),u.allowFlatten=!l.type&&!l.ease,x&&!o&&s.get()!==void 0){const m=Lu(u.keyframes,l);if(m!==void 0){le.update(()=>{u.onUpdate(m),u.onComplete()});return}}return l.isSync?new $n(u):new ku(u)};function Cr(t){const s=[{},{}];return t?.values.forEach((a,n)=>{s[0][n]=a.get(),s[1][n]=a.getVelocity()}),s}function Un(t,s,a,n){if(typeof s=="function"){const[r,o]=Cr(n);s=s(a!==void 0?a:t.custom,r,o)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[r,o]=Cr(n);s=s(a!==void 0?a:t.custom,r,o)}return s}function Ut(t,s,a){const n=t.getProps();return Un(n,s,a!==void 0?a:n.custom,t)}const Ho=new Set(["width","height","top","left","right","bottom",...Jt]),Pr=30,Fu=t=>!isNaN(parseFloat(t)),ms={current:void 0};class Ou{constructor(s,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const r=Re.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=a.owner}setCurrent(s){this.current=s,this.updatedAt=Re.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=Fu(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,a){this.events[s]||(this.events[s]=new Cn);const n=this.events[s].add(a);return s==="change"?()=>{n(),le.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,a){this.passiveEffect=s,this.stopPassiveEffect=a}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,a,n){this.set(a),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-n}jump(s,a=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return ms.current&&ms.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const s=Re.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>Pr)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,Pr);return Pn(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(s){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=s(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ye(t,s){return new Ou(t,s)}const on=t=>Array.isArray(t);function $u(t,s,a){t.hasValue(s)?t.getValue(s).set(a):t.addValue(s,Ye(a))}function Vu(t){return on(t)?t[t.length-1]||0:t}function Bu(t,s){const a=Ut(t,s);let{transitionEnd:n={},transition:r={},...o}=a||{};o={...o,...n};for(const i in o){const l=Vu(o[i]);$u(t,i,l)}}const Te=t=>!!(t&&t.getVelocity);function _u(t){return!!(Te(t)&&t.add)}function ln(t,s){const a=t.getValue("willChange");if(_u(a))return a.add(s);if(!a&&ut.WillChange){const n=new ut.WillChange("auto");t.addValue("willChange",n),n.add(s)}}function qn(t){return t.replace(/([A-Z])/g,s=>`-${s.toLowerCase()}`)}const Uu="framerAppearId",Ko="data-"+qn(Uu);function Go(t){return t.props[Ko]}function qu({protectedKeys:t,needsAnimating:s},a){const n=t.hasOwnProperty(a)&&s[a]!==!0;return s[a]=!1,n}function Jo(t,s,{delay:a=0,transitionOverride:n,type:r}={}){let{transition:o=t.getDefaultTransition(),transitionEnd:i,...l}=s;n&&(o=n);const c=[],d=r&&t.animationState&&t.animationState.getState()[r];for(const u in l){const x=t.getValue(u,t.latestValues[u]??null),m=l[u];if(m===void 0||d&&qu(d,u))continue;const b={delay:a,...Bn(o||{},u)},f=x.get();if(f!==void 0&&!x.isAnimating&&!Array.isArray(m)&&m===f&&!b.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const p=Go(t);if(p){const v=window.MotionHandoffAnimation(p,u,le);v!==null&&(b.startTime=v,y=!0)}}ln(t,u),x.start(_n(u,x,m,t.shouldReduceMotion&&Ho.has(u)?{type:!1}:b,t,y));const g=x.animation;g&&c.push(g)}return i&&Promise.all(c).then(()=>{le.update(()=>{i&&Bu(t,i)})}),c}function cn(t,s,a={}){const n=Ut(t,s,a.type==="exit"?t.presenceContext?.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=n||{};a.transitionOverride&&(r=a.transitionOverride);const o=n?()=>Promise.all(Jo(t,n,a)):()=>Promise.resolve(),i=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:u,staggerDirection:x}=r;return zu(t,s,c,d,u,x,a)}:()=>Promise.resolve(),{when:l}=r;if(l){const[c,d]=l==="beforeChildren"?[o,i]:[i,o];return c().then(()=>d())}else return Promise.all([o(),i(a.delay)])}function zu(t,s,a=0,n=0,r=0,o=1,i){const l=[];for(const c of t.variantChildren)c.notify("AnimationStart",s),l.push(cn(c,s,{...i,delay:a+(typeof n=="function"?0:n)+zo(t.variantChildren,c,n,r,o)}).then(()=>c.notify("AnimationComplete",s)));return Promise.all(l)}function Wu(t,s,a={}){t.notify("AnimationStart",s);let n;if(Array.isArray(s)){const r=s.map(o=>cn(t,o,a));n=Promise.all(r)}else if(typeof s=="string")n=cn(t,s,a);else{const r=typeof s=="function"?Ut(t,s,a.custom):s;n=Promise.all(Jo(t,r,a))}return n.then(()=>{t.notify("AnimationComplete",s)})}const Hu={test:t=>t==="auto",parse:t=>t},Yo=t=>s=>s.test(t),Xo=[Gt,W,rt,ht,Nd,vd,Hu],Tr=t=>Xo.find(Yo(t));function Ku(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||mo(t):!0}const Gu=new Set(["brightness","contrast","saturate","opacity"]);function Ju(t){const[s,a]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[n]=a.match(En)||[];if(!n)return t;const r=a.replace(n,"");let o=Gu.has(s)?1:0;return n!==a&&(o*=100),s+"("+o+r+")"}const Yu=/\b([a-z-]*)\(.*?\)/gu,dn={...bt,getAnimatableNone:t=>{const s=t.match(Yu);return s?s.map(Ju).join(" "):t}},Ar={...Gt,transform:Math.round},Xu={rotate:ht,rotateX:ht,rotateY:ht,rotateZ:ht,scale:Rs,scaleX:Rs,scaleY:Rs,scaleZ:Rs,skew:ht,skewX:ht,skewY:ht,distance:W,translateX:W,translateY:W,translateZ:W,x:W,y:W,z:W,perspective:W,transformPerspective:W,opacity:gs,originX:pr,originY:pr,originZ:W},zn={borderWidth:W,borderTopWidth:W,borderRightWidth:W,borderBottomWidth:W,borderLeftWidth:W,borderRadius:W,borderTopLeftRadius:W,borderTopRightRadius:W,borderBottomRightRadius:W,borderBottomLeftRadius:W,width:W,maxWidth:W,height:W,maxHeight:W,top:W,right:W,bottom:W,left:W,inset:W,insetBlock:W,insetBlockStart:W,insetBlockEnd:W,insetInline:W,insetInlineStart:W,insetInlineEnd:W,padding:W,paddingTop:W,paddingRight:W,paddingBottom:W,paddingLeft:W,paddingBlock:W,paddingBlockStart:W,paddingBlockEnd:W,paddingInline:W,paddingInlineStart:W,paddingInlineEnd:W,margin:W,marginTop:W,marginRight:W,marginBottom:W,marginLeft:W,marginBlock:W,marginBlockStart:W,marginBlockEnd:W,marginInline:W,marginInlineStart:W,marginInlineEnd:W,fontSize:W,backgroundPositionX:W,backgroundPositionY:W,...Xu,zIndex:Ar,fillOpacity:gs,strokeOpacity:gs,numOctaves:Ar},Zu={...zn,color:je,backgroundColor:je,outlineColor:je,fill:je,stroke:je,borderColor:je,borderTopColor:je,borderRightColor:je,borderBottomColor:je,borderLeftColor:je,filter:dn,WebkitFilter:dn},Zo=t=>Zu[t];function Qo(t,s){let a=Zo(t);return a!==dn&&(a=bt),a.getAnimatableNone?a.getAnimatableNone(s):void 0}const Qu=new Set(["auto","none","0"]);function em(t,s,a){let n=0,r;for(;n<t.length&&!r;){const o=t[n];typeof o=="string"&&!Qu.has(o)&&bs(o).values.length&&(r=t[n]),n++}if(r&&a)for(const o of s)t[o]=Qo(a,r)}class tm extends Vn{constructor(s,a,n,r,o){super(s,a,n,r,o,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:a,name:n}=this;if(!a||!a.current)return;super.readKeyframes();for(let u=0;u<s.length;u++){let x=s[u];if(typeof x=="string"&&(x=x.trim(),Dn(x))){const m=Wo(x,a.current);m!==void 0&&(s[u]=m),u===s.length-1&&(this.finalKeyframe=x)}}if(this.resolveNoneKeyframes(),!Ho.has(n)||s.length!==2)return;const[r,o]=s,i=Tr(r),l=Tr(o),c=xr(r),d=xr(o);if(c!==d&&xt[n]){this.needsMeasurement=!0;return}if(i!==l)if(wr(i)&&wr(l))for(let u=0;u<s.length;u++){const x=s[u];typeof x=="string"&&(s[u]=parseFloat(x))}else xt[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:a}=this,n=[];for(let r=0;r<s.length;r++)(s[r]===null||Ku(s[r]))&&n.push(r);n.length&&em(s,n,a)}measureInitialState(){const{element:s,unresolvedKeyframes:a,name:n}=this;if(!s||!s.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=xt[n](s.measureViewportBox(),window.getComputedStyle(s.current)),a[0]=this.measuredOrigin;const r=a[a.length-1];r!==void 0&&s.getValue(n,r).jump(r,!1)}measureEndState(){const{element:s,name:a,unresolvedKeyframes:n}=this;if(!s||!s.current)return;const r=s.getValue(a);r&&r.jump(this.measuredOrigin,!1);const o=n.length-1,i=n[o];n[o]=xt[a](s.measureViewportBox(),window.getComputedStyle(s.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([l,c])=>{s.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function el(t,s,a){if(t==null)return[];if(t instanceof EventTarget)return[t];if(typeof t=="string"){const r=document.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t).filter(n=>n!=null)}const tl=(t,s)=>s&&typeof t=="number"?s.transform(t):t;function ra(t){return uo(t)&&"offsetHeight"in t}const{schedule:Wn}=wo(queueMicrotask,!1),Je={x:!1,y:!1};function sl(){return Je.x||Je.y}function sm(t){return t==="x"||t==="y"?Je[t]?null:(Je[t]=!0,()=>{Je[t]=!1}):Je.x||Je.y?null:(Je.x=Je.y=!0,()=>{Je.x=Je.y=!1})}function al(t,s){const a=el(t),n=new AbortController,r={passive:!0,...s,signal:n.signal};return[a,r,()=>n.abort()]}function Dr(t){return!(t.pointerType==="touch"||sl())}function am(t,s,a={}){const[n,r,o]=al(t,a),i=l=>{if(!Dr(l))return;const{target:c}=l,d=s(c,l);if(typeof d!="function"||!c)return;const u=x=>{Dr(x)&&(d(x),c.removeEventListener("pointerleave",u))};c.addEventListener("pointerleave",u,r)};return n.forEach(l=>{l.addEventListener("pointerenter",i,r)}),o}const nl=(t,s)=>s?t===s?!0:nl(t,s.parentElement):!1,Hn=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,nm=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function rl(t){return nm.has(t.tagName)||t.isContentEditable===!0}const zs=new WeakSet;function Er(t){return s=>{s.key==="Enter"&&t(s)}}function Aa(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const rm=(t,s)=>{const a=t.currentTarget;if(!a)return;const n=Er(()=>{if(zs.has(a))return;Aa(a,"down");const r=Er(()=>{Aa(a,"up")}),o=()=>Aa(a,"cancel");a.addEventListener("keyup",r,s),a.addEventListener("blur",o,s)});a.addEventListener("keydown",n,s),a.addEventListener("blur",()=>a.removeEventListener("keydown",n),s)};function Ir(t){return Hn(t)&&!sl()}function im(t,s,a={}){const[n,r,o]=al(t,a),i=l=>{const c=l.currentTarget;if(!Ir(l))return;zs.add(c);const d=s(c,l),u=(b,f)=>{window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",m),zs.has(c)&&zs.delete(c),Ir(b)&&typeof d=="function"&&d(b,{success:f})},x=b=>{u(b,c===window||c===document||a.useGlobalTarget||nl(c,b.target))},m=b=>{u(b,!1)};window.addEventListener("pointerup",x,r),window.addEventListener("pointercancel",m,r)};return n.forEach(l=>{(a.useGlobalTarget?window:l).addEventListener("pointerdown",i,r),ra(l)&&(l.addEventListener("focus",d=>rm(d,r)),!rl(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),o}function Kn(t){return uo(t)&&"ownerSVGElement"in t}const Ws=new WeakMap;let Hs;const il=(t,s,a)=>(n,r)=>r&&r[0]?r[0][t+"Size"]:Kn(n)&&"getBBox"in n?n.getBBox()[s]:n[a],om=il("inline","width","offsetWidth"),lm=il("block","height","offsetHeight");function cm({target:t,borderBoxSize:s}){Ws.get(t)?.forEach(a=>{a(t,{get width(){return om(t,s)},get height(){return lm(t,s)}})})}function dm(t){t.forEach(cm)}function um(){typeof ResizeObserver>"u"||(Hs=new ResizeObserver(dm))}function mm(t,s){Hs||um();const a=el(t);return a.forEach(n=>{let r=Ws.get(n);r||(r=new Set,Ws.set(n,r)),r.add(s),Hs?.observe(n)}),()=>{a.forEach(n=>{const r=Ws.get(n);r?.delete(s),r?.size||Hs?.unobserve(n)})}}const Ks=new Set;let $t;function hm(){$t=()=>{const t={get width(){return window.innerWidth},get height(){return window.innerHeight}};Ks.forEach(s=>s(t))},window.addEventListener("resize",$t)}function xm(t){return Ks.add(t),$t||hm(),()=>{Ks.delete(t),!Ks.size&&typeof $t=="function"&&(window.removeEventListener("resize",$t),$t=void 0)}}function pm(t,s){return typeof t=="function"?xm(t):mm(t,s)}function ol(t,s){let a;const n=()=>{const{currentTime:r}=s,i=(r===null?0:r.value)/100;a!==i&&t(i),a=i};return le.preUpdate(n,!0),()=>We(n)}function fm(t){return Kn(t)&&t.tagName==="svg"}function gm(...t){const s=!Array.isArray(t[0]),a=s?0:-1,n=t[0+a],r=t[1+a],o=t[2+a],i=t[3+a],l=Mn(r,o,i);return s?l(n):l}const bm=[...Xo,je,bt],ym=t=>bm.find(Yo(t)),Rr=()=>({translate:0,scale:1,origin:0,originPoint:0}),Vt=()=>({x:Rr(),y:Rr()}),Lr=()=>({min:0,max:0}),Ne=()=>({x:Lr(),y:Lr()}),un={current:null},ll={current:!1},jm=typeof window<"u";function vm(){if(ll.current=!0,!!jm)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>un.current=t.matches;t.addEventListener("change",s),s()}else un.current=!1}const Nm=new WeakMap;function pa(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function ys(t){return typeof t=="string"||Array.isArray(t)}const Gn=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Jn=["initial",...Gn];function fa(t){return pa(t.animate)||Jn.some(s=>ys(t[s]))}function cl(t){return!!(fa(t)||t.variants)}function wm(t,s,a){for(const n in s){const r=s[n],o=a[n];if(Te(r))t.addValue(n,r);else if(Te(o))t.addValue(n,Ye(r,{owner:t}));else if(o!==r)if(t.hasValue(n)){const i=t.getValue(n);i.liveStyle===!0?i.jump(r):i.hasAnimated||i.set(r)}else{const i=t.getStaticValue(n);t.addValue(n,Ye(i!==void 0?i:r,{owner:t}))}}for(const n in a)s[n]===void 0&&t.removeValue(n);return s}const Mr=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let ia={};function dl(t){ia=t}function Sm(){return ia}class km{scrapeMotionValuesFromProps(s,a,n){return{}}constructor({parent:s,props:a,presenceContext:n,reducedMotionConfig:r,blockInitialAnimation:o,visualState:i},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Vn,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=Re.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,le.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=a.initial?{...c}:{},this.renderState=d,this.parent=s,this.props=a,this.presenceContext=n,this.depth=s?s.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!o,this.isControllingVariants=fa(a),this.isVariantNode=cl(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:u,...x}=this.scrapeMotionValuesFromProps(a,{},this);for(const m in x){const b=x[m];c[m]!==void 0&&Te(b)&&b.set(c[m])}}mount(s){this.current=s,Nm.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,n)=>this.bindToMotionValue(n,a)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(ll.current||vm(),this.shouldReduceMotion=un.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),We(this.notifyUpdate),We(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const a=this.features[s];a&&(a.unmount(),a.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,a){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const n=Yt.has(s);n&&this.onBindTransform&&this.onBindTransform();const r=a.on("change",i=>{this.latestValues[s]=i,this.props.onUpdate&&le.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let o;typeof window<"u"&&window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,s,a)),this.valueSubscriptions.set(s,()=>{r(),o&&o(),a.owner&&a.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in ia){const a=ia[s];if(!a)continue;const{isEnabled:n,Feature:r}=a;if(!this.features[s]&&r&&n(this.props)&&(this.features[s]=new r(this)),this.features[s]){const o=this.features[s];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ne()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,a){this.latestValues[s]=a}update(s,a){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let n=0;n<Mr.length;n++){const r=Mr[n];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const o="on"+r,i=s[o];i&&(this.propEventSubscriptions[r]=this.on(r,i))}this.prevMotionValues=wm(this,this.scrapeMotionValuesFromProps(s,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(s),()=>a.variantChildren.delete(s)}addValue(s,a){const n=this.values.get(s);a!==n&&(n&&this.removeValue(s),this.bindToMotionValue(s,a),this.values.set(s,a),this.latestValues[s]=a.get())}removeValue(s){this.values.delete(s);const a=this.valueSubscriptions.get(s);a&&(a(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,a){if(this.props.values&&this.props.values[s])return this.props.values[s];let n=this.values.get(s);return n===void 0&&a!==void 0&&(n=Ye(a===null?void 0:a,{owner:this}),this.addValue(s,n)),n}readValue(s,a){let n=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return n!=null&&(typeof n=="string"&&(co(n)||mo(n))?n=parseFloat(n):!ym(n)&&bt.test(a)&&(n=Qo(s,a)),this.setBaseTarget(s,Te(n)?n.get():n)),Te(n)?n.get():n}setBaseTarget(s,a){this.baseTarget[s]=a}getBaseTarget(s){const{initial:a}=this.props;let n;if(typeof a=="string"||typeof a=="object"){const o=Un(this.props,a,this.presenceContext?.custom);o&&(n=o[s])}if(a&&n!==void 0)return n;const r=this.getBaseTargetFromProps(this.props,s);return r!==void 0&&!Te(r)?r:this.initialValues[s]!==void 0&&n===void 0?void 0:this.baseTarget[s]}on(s,a){return this.events[s]||(this.events[s]=new Cn),this.events[s].add(a)}notify(s,...a){this.events[s]&&this.events[s].notify(...a)}scheduleRenderMicrotask(){Wn.render(this.render)}}class ul extends km{constructor(){super(...arguments),this.KeyframeResolver=tm}sortInstanceNodePosition(s,a){return s.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(s,a){const n=s.style;return n?n[a]:void 0}removeValueFromRenderState(s,{vars:a,style:n}){delete a[s],delete n[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;Te(s)&&(this.childSubscription=s.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}class jt{constructor(s){this.isMounted=!1,this.node=s}update(){}}function ml({top:t,left:s,right:a,bottom:n}){return{x:{min:s,max:a},y:{min:t,max:n}}}function Cm({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function Pm(t,s){if(!s)return t;const a=s({x:t.left,y:t.top}),n=s({x:t.right,y:t.bottom});return{top:a.y,left:a.x,bottom:n.y,right:n.x}}function Da(t){return t===void 0||t===1}function mn({scale:t,scaleX:s,scaleY:a}){return!Da(t)||!Da(s)||!Da(a)}function St(t){return mn(t)||hl(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function hl(t){return Fr(t.x)||Fr(t.y)}function Fr(t){return t&&t!=="0%"}function oa(t,s,a){const n=t-a,r=s*n;return a+r}function Or(t,s,a,n,r){return r!==void 0&&(t=oa(t,r,n)),oa(t,a,n)+s}function hn(t,s=0,a=1,n,r){t.min=Or(t.min,s,a,n,r),t.max=Or(t.max,s,a,n,r)}function xl(t,{x:s,y:a}){hn(t.x,s.translate,s.scale,s.originPoint),hn(t.y,a.translate,a.scale,a.originPoint)}const $r=.999999999999,Vr=1.0000000000001;function Tm(t,s,a,n=!1){const r=a.length;if(!r)return;s.x=s.y=1;let o,i;for(let l=0;l<r;l++){o=a[l],i=o.projectionDelta;const{visualElement:c}=o.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&_t(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),i&&(s.x*=i.x.scale,s.y*=i.y.scale,xl(t,i)),n&&St(o.latestValues)&&_t(t,o.latestValues))}s.x<Vr&&s.x>$r&&(s.x=1),s.y<Vr&&s.y>$r&&(s.y=1)}function Bt(t,s){t.min=t.min+s,t.max=t.max+s}function Br(t,s,a,n,r=.5){const o=xe(t.min,t.max,r);hn(t,s,a,o,n)}function _t(t,s){Br(t.x,s.x,s.scaleX,s.scale,s.originX),Br(t.y,s.y,s.scaleY,s.scale,s.originY)}function pl(t,s){return ml(Pm(t.getBoundingClientRect(),s))}function Am(t,s,a){const n=pl(t,a),{scroll:r}=s;return r&&(Bt(n.x,r.offset.x),Bt(n.y,r.offset.y)),n}const Dm={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Em=Jt.length;function Im(t,s,a){let n="",r=!0;for(let o=0;o<Em;o++){const i=Jt[o],l=t[i];if(l===void 0)continue;let c=!0;if(typeof l=="number")c=l===(i.startsWith("scale")?1:0);else{const d=parseFloat(l);c=i.startsWith("scale")?d===1:d===0}if(!c||a){const d=tl(l,zn[i]);if(!c){r=!1;const u=Dm[i]||i;n+=`${u}(${d}) `}a&&(s[i]=d)}}return n=n.trim(),a?n=a(s,r?"":n):r&&(n="none"),n}function Yn(t,s,a){const{style:n,vars:r,transformOrigin:o}=t;let i=!1,l=!1;for(const c in s){const d=s[c];if(Yt.has(c)){i=!0;continue}else if(ko(c)){r[c]=d;continue}else{const u=tl(d,zn[c]);c.startsWith("origin")?(l=!0,o[c]=u):n[c]=u}}if(s.transform||(i||a?n.transform=Im(s,t.transform,a):n.transform&&(n.transform="none")),l){const{originX:c="50%",originY:d="50%",originZ:u=0}=o;n.transformOrigin=`${c} ${d} ${u}`}}function fl(t,{style:s,vars:a},n,r){const o=t.style;let i;for(i in s)o[i]=s[i];r?.applyProjectionStyles(o,n);for(i in a)o.setProperty(i,a[i])}function _r(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const ts={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(W.test(t))t=parseFloat(t);else return t;const a=_r(t,s.target.x),n=_r(t,s.target.y);return`${a}% ${n}%`}},Rm={correct:(t,{treeScale:s,projectionDelta:a})=>{const n=t,r=bt.parse(t);if(r.length>5)return n;const o=bt.createTransformer(t),i=typeof r[0]!="number"?1:0,l=a.x.scale*s.x,c=a.y.scale*s.y;r[0+i]/=l,r[1+i]/=c;const d=xe(l,c,.5);return typeof r[2+i]=="number"&&(r[2+i]/=d),typeof r[3+i]=="number"&&(r[3+i]/=d),o(r)}},xn={borderRadius:{...ts,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ts,borderTopRightRadius:ts,borderBottomLeftRadius:ts,borderBottomRightRadius:ts,boxShadow:Rm};function gl(t,{layout:s,layoutId:a}){return Yt.has(t)||t.startsWith("origin")||(s||a!==void 0)&&(!!xn[t]||t==="opacity")}function Xn(t,s,a){const n=t.style,r=s?.style,o={};if(!n)return o;for(const i in n)(Te(n[i])||r&&Te(r[i])||gl(i,t)||a?.getValue(i)?.liveStyle!==void 0)&&(o[i]=n[i]);return o}function Lm(t){return window.getComputedStyle(t)}class Mm extends ul{constructor(){super(...arguments),this.type="html",this.renderInstance=fl}readValueFromInstance(s,a){if(Yt.has(a))return this.projection?.isProjecting?en(a):au(s,a);{const n=Lm(s),r=(ko(a)?n.getPropertyValue(a):n[a])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(s,{transformPagePoint:a}){return pl(s,a)}build(s,a,n){Yn(s,a,n.transformTemplate)}scrapeMotionValuesFromProps(s,a,n){return Xn(s,a,n)}}const Fm={offset:"stroke-dashoffset",array:"stroke-dasharray"},Om={offset:"strokeDashoffset",array:"strokeDasharray"};function $m(t,s,a=1,n=0,r=!0){t.pathLength=1;const o=r?Fm:Om;t[o.offset]=`${-n}`,t[o.array]=`${s} ${a}`}const Vm=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function bl(t,{attrX:s,attrY:a,attrScale:n,pathLength:r,pathSpacing:o=1,pathOffset:i=0,...l},c,d,u){if(Yn(t,l,d),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:x,style:m}=t;x.transform&&(m.transform=x.transform,delete x.transform),(m.transform||x.transformOrigin)&&(m.transformOrigin=x.transformOrigin??"50% 50%",delete x.transformOrigin),m.transform&&(m.transformBox=u?.transformBox??"fill-box",delete x.transformBox);for(const b of Vm)x[b]!==void 0&&(m[b]=x[b],delete x[b]);s!==void 0&&(x.x=s),a!==void 0&&(x.y=a),n!==void 0&&(x.scale=n),r!==void 0&&$m(x,r,o,i,!1)}const yl=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),jl=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Bm(t,s,a,n){fl(t,s,void 0,n);for(const r in s.attrs)t.setAttribute(yl.has(r)?r:qn(r),s.attrs[r])}function vl(t,s,a){const n=Xn(t,s,a);for(const r in t)if(Te(t[r])||Te(s[r])){const o=Jt.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[o]=t[r]}return n}class _m extends ul{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ne}getBaseTargetFromProps(s,a){return s[a]}readValueFromInstance(s,a){if(Yt.has(a)){const n=Zo(a);return n&&n.default||0}return a=yl.has(a)?a:qn(a),s.getAttribute(a)}scrapeMotionValuesFromProps(s,a,n){return vl(s,a,n)}build(s,a,n){bl(s,a,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(s,a,n,r){Bm(s,a,n,r)}mount(s){this.isSVGTag=jl(s.tagName),super.mount(s)}}const Um=Jn.length;function Nl(t){if(!t)return;if(!t.isControllingVariants){const a=t.parent?Nl(t.parent)||{}:{};return t.props.initial!==void 0&&(a.initial=t.props.initial),a}const s={};for(let a=0;a<Um;a++){const n=Jn[a],r=t.props[n];(ys(r)||r===!1)&&(s[n]=r)}return s}function wl(t,s){if(!Array.isArray(s))return!1;const a=s.length;if(a!==t.length)return!1;for(let n=0;n<a;n++)if(s[n]!==t[n])return!1;return!0}const qm=[...Gn].reverse(),zm=Gn.length;function Wm(t){return s=>Promise.all(s.map(({animation:a,options:n})=>Wu(t,a,n)))}function Hm(t){let s=Wm(t),a=Ur(),n=!0;const r=c=>(d,u)=>{const x=Ut(t,u,c==="exit"?t.presenceContext?.custom:void 0);if(x){const{transition:m,transitionEnd:b,...f}=x;d={...d,...f,...b}}return d};function o(c){s=c(t)}function i(c){const{props:d}=t,u=Nl(t.parent)||{},x=[],m=new Set;let b={},f=1/0;for(let g=0;g<zm;g++){const p=qm[g],v=a[p],j=d[p]!==void 0?d[p]:u[p],S=ys(j),P=p===c?v.isActive:null;P===!1&&(f=g);let T=j===u[p]&&j!==d[p]&&S;if(T&&n&&t.manuallyAnimateOnMount&&(T=!1),v.protectedKeys={...b},!v.isActive&&P===null||!j&&!v.prevProp||pa(j)||typeof j=="boolean")continue;const M=Km(v.prevProp,j);let N=M||p===c&&v.isActive&&!T&&S||g>f&&S,A=!1;const L=Array.isArray(j)?j:[j];let E=L.reduce(r(p),{});P===!1&&(E={});const{prevResolvedValues:F={}}=v,te={...F,...E},ye=ue=>{N=!0,m.has(ue)&&(A=!0,m.delete(ue)),v.needsAnimating[ue]=!0;const de=t.getValue(ue);de&&(de.liveStyle=!1)};for(const ue in te){const de=E[ue],oe=F[ue];if(b.hasOwnProperty(ue))continue;let ve=!1;on(de)&&on(oe)?ve=!wl(de,oe):ve=de!==oe,ve?de!=null?ye(ue):m.add(ue):de!==void 0&&m.has(ue)?ye(ue):v.protectedKeys[ue]=!0}v.prevProp=j,v.prevResolvedValues=E,v.isActive&&(b={...b,...E}),n&&t.blockInitialAnimation&&(N=!1);const we=T&&M;N&&(!we||A)&&x.push(...L.map(ue=>{const de={type:p};if(typeof ue=="string"&&n&&!we&&t.manuallyAnimateOnMount&&t.parent){const{parent:oe}=t,ve=Ut(oe,ue);if(oe.enteringChildren&&ve){const{delayChildren:D}=ve.transition||{};de.delay=zo(oe.enteringChildren,t,D)}}return{animation:ue,options:de}}))}if(m.size){const g={};if(typeof d.initial!="boolean"){const p=Ut(t,Array.isArray(d.initial)?d.initial[0]:d.initial);p&&p.transition&&(g.transition=p.transition)}m.forEach(p=>{const v=t.getBaseTarget(p),j=t.getValue(p);j&&(j.liveStyle=!0),g[p]=v??null}),x.push({animation:g})}let y=!!x.length;return n&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(y=!1),n=!1,y?s(x):Promise.resolve()}function l(c,d){if(a[c].isActive===d)return Promise.resolve();t.variantChildren?.forEach(x=>x.animationState?.setActive(c,d)),a[c].isActive=d;const u=i(c);for(const x in a)a[x].protectedKeys={};return u}return{animateChanges:i,setActive:l,setAnimateFunction:o,getState:()=>a,reset:()=>{a=Ur()}}}function Km(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!wl(s,t):!1}function wt(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Ur(){return{animate:wt(!0),whileInView:wt(),whileHover:wt(),whileTap:wt(),whileDrag:wt(),whileFocus:wt(),exit:wt()}}function qr(t,s){t.min=s.min,t.max=s.max}function Ge(t,s){qr(t.x,s.x),qr(t.y,s.y)}function zr(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}const Sl=1e-4,Gm=1-Sl,Jm=1+Sl,kl=.01,Ym=0-kl,Xm=0+kl;function Le(t){return t.max-t.min}function Zm(t,s,a){return Math.abs(t-s)<=a}function Wr(t,s,a,n=.5){t.origin=n,t.originPoint=xe(s.min,s.max,t.origin),t.scale=Le(a)/Le(s),t.translate=xe(a.min,a.max,t.origin)-t.originPoint,(t.scale>=Gm&&t.scale<=Jm||isNaN(t.scale))&&(t.scale=1),(t.translate>=Ym&&t.translate<=Xm||isNaN(t.translate))&&(t.translate=0)}function hs(t,s,a,n){Wr(t.x,s.x,a.x,n?n.originX:void 0),Wr(t.y,s.y,a.y,n?n.originY:void 0)}function Hr(t,s,a){t.min=a.min+s.min,t.max=t.min+Le(s)}function Qm(t,s,a){Hr(t.x,s.x,a.x),Hr(t.y,s.y,a.y)}function Kr(t,s,a){t.min=s.min-a.min,t.max=t.min+Le(s)}function la(t,s,a){Kr(t.x,s.x,a.x),Kr(t.y,s.y,a.y)}function Gr(t,s,a,n,r){return t-=s,t=oa(t,1/a,n),r!==void 0&&(t=oa(t,1/r,n)),t}function eh(t,s=0,a=1,n=.5,r,o=t,i=t){if(rt.test(s)&&(s=parseFloat(s),s=xe(i.min,i.max,s/100)-i.min),typeof s!="number")return;let l=xe(o.min,o.max,n);t===o&&(l-=s),t.min=Gr(t.min,s,a,l,r),t.max=Gr(t.max,s,a,l,r)}function Jr(t,s,[a,n,r],o,i){eh(t,s[a],s[n],s[r],s.scale,o,i)}const th=["x","scaleX","originX"],sh=["y","scaleY","originY"];function Yr(t,s,a,n){Jr(t.x,s,th,a?a.x:void 0,n?n.x:void 0),Jr(t.y,s,sh,a?a.y:void 0,n?n.y:void 0)}function Xr(t){return t.translate===0&&t.scale===1}function Cl(t){return Xr(t.x)&&Xr(t.y)}function Zr(t,s){return t.min===s.min&&t.max===s.max}function ah(t,s){return Zr(t.x,s.x)&&Zr(t.y,s.y)}function Qr(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function Pl(t,s){return Qr(t.x,s.x)&&Qr(t.y,s.y)}function ei(t){return Le(t.x)/Le(t.y)}function ti(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}function _e(t){return[t("x"),t("y")]}function nh(t,s,a){let n="";const r=t.x.translate/s.x,o=t.y.translate/s.y,i=a?.z||0;if((r||o||i)&&(n=`translate3d(${r}px, ${o}px, ${i}px) `),(s.x!==1||s.y!==1)&&(n+=`scale(${1/s.x}, ${1/s.y}) `),a){const{transformPerspective:d,rotate:u,rotateX:x,rotateY:m,skewX:b,skewY:f}=a;d&&(n=`perspective(${d}px) ${n}`),u&&(n+=`rotate(${u}deg) `),x&&(n+=`rotateX(${x}deg) `),m&&(n+=`rotateY(${m}deg) `),b&&(n+=`skewX(${b}deg) `),f&&(n+=`skewY(${f}deg) `)}const l=t.x.scale*s.x,c=t.y.scale*s.y;return(l!==1||c!==1)&&(n+=`scale(${l}, ${c})`),n||"none"}const Tl=["TopLeft","TopRight","BottomLeft","BottomRight"],rh=Tl.length,si=t=>typeof t=="string"?parseFloat(t):t,ai=t=>typeof t=="number"||W.test(t);function ih(t,s,a,n,r,o){r?(t.opacity=xe(0,a.opacity??1,oh(n)),t.opacityExit=xe(s.opacity??1,0,lh(n))):o&&(t.opacity=xe(s.opacity??1,a.opacity??1,n));for(let i=0;i<rh;i++){const l=`border${Tl[i]}Radius`;let c=ni(s,l),d=ni(a,l);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||ai(c)===ai(d)?(t[l]=Math.max(xe(si(c),si(d),n),0),(rt.test(d)||rt.test(c))&&(t[l]+="%")):t[l]=d}(s.rotate||a.rotate)&&(t.rotate=xe(s.rotate||0,a.rotate||0,n))}function ni(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const oh=Al(0,.5,yo),lh=Al(.5,.95,Oe);function Al(t,s,a){return n=>n<t?0:n>s?1:a(Ht(t,s,n))}function ch(t,s,a){const n=Te(t)?t:Ye(t);return n.start(_n("",n,s,a)),n.animation}function js(t,s,a,n={passive:!0}){return t.addEventListener(s,a,n),()=>t.removeEventListener(s,a)}const dh=(t,s)=>t.depth-s.depth;class uh{constructor(){this.children=[],this.isDirty=!1}add(s){wn(this.children,s),this.isDirty=!0}remove(s){Sn(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(dh),this.isDirty=!1,this.children.forEach(s)}}function mh(t,s){const a=Re.now(),n=({timestamp:r})=>{const o=r-a;o>=s&&(We(n),t(o-s))};return le.setup(n,!0),()=>We(n)}function Gs(t){return Te(t)?t.get():t}class hh{constructor(){this.members=[]}add(s){wn(this.members,s),s.scheduleRender()}remove(s){if(Sn(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(s){const a=this.members.findIndex(r=>s===r);if(a===0)return!1;let n;for(let r=a;r>=0;r--){const o=this.members[r];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(s,a){const n=this.lead;if(s!==n&&(this.prevLead=n,this.lead=s,s.show(),n)){n.instance&&n.scheduleRender(),s.scheduleRender();const r=n.options.layoutDependency,o=s.options.layoutDependency;r!==void 0&&o!==void 0&&r===o||(s.resumeFrom=n,a&&(s.resumeFrom.preserveOpacity=!0),n.snapshot&&(s.snapshot=n.snapshot,s.snapshot.latestValues=n.animationValues||n.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0));const{crossfade:l}=s.options;l===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:a,resumingFrom:n}=s;a.onExitComplete&&a.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Js={hasAnimatedSinceResize:!0,hasEverUpdated:!1},Ea=["","X","Y","Z"],xh=1e3;let ph=0;function Ia(t,s,a,n){const{latestValues:r}=s;r[t]&&(a[t]=r[t],s.setStaticValue(t,0),n&&(n[t]=0))}function Dl(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const a=Go(s);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:r,layoutId:o}=t.options;window.MotionCancelOptimisedAnimation(a,"transform",le,!(r||o))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&Dl(n)}function El({attachResizeListener:t,defaultParent:s,measureScroll:a,checkIsScrollRoot:n,resetTransform:r}){return class{constructor(i={},l=s?.()){this.id=ph++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(bh),this.nodes.forEach(Nh),this.nodes.forEach(wh),this.nodes.forEach(yh)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new uh)}addEventListener(i,l){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new Cn),this.eventHandlers.get(i).add(l)}notifyListeners(i,...l){const c=this.eventHandlers.get(i);c&&c.notify(...l)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=Kn(i)&&!fm(i),this.instance=i;const{layoutId:l,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),t){let u,x=0;const m=()=>this.root.updateBlockedByResize=!1;le.read(()=>{x=window.innerWidth}),t(i,()=>{const b=window.innerWidth;b!==x&&(x=b,this.root.updateBlockedByResize=!0,u&&u(),u=mh(m,250),Js.hasAnimatedSinceResize&&(Js.hasAnimatedSinceResize=!1,this.nodes.forEach(oi)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&d&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:x,hasRelativeLayoutChanged:m,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const f=this.options.transition||d.getDefaultTransition()||Th,{onLayoutAnimationStart:y,onLayoutAnimationComplete:g}=d.getProps(),p=!this.targetLayout||!Pl(this.targetLayout,b),v=!x&&m;if(this.options.layoutRoot||this.resumeFrom||v||x&&(p||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const j={...Bn(f,"layout"),onPlay:y,onComplete:g};(d.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j),this.setAnimationOrigin(u,v)}else x||oi(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),We(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Sh),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Dl(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const x=this.path[u];x.shouldResetTransform=!0,x.updateScroll("snapshot"),x.options.layoutRoot&&x.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(ri);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(ii);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(vh),this.nodes.forEach(fh),this.nodes.forEach(gh)):this.nodes.forEach(ii),this.clearAllSnapshots();const l=Re.now();ke.delta=et(0,1e3/60,l-ke.timestamp),ke.timestamp=l,ke.isProcessing=!0,wa.update.process(ke),wa.preRender.process(ke),wa.render.process(ke),ke.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Wn.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(jh),this.sharedNodes.forEach(kh)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,le.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){le.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Le(this.snapshot.measuredBox.x)&&!Le(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Ne(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(l=!1),l&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!Cl(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;i&&this.instance&&(l||St(this.latestValues)||u)&&(r(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return i&&(c=this.removeTransform(c)),Ah(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return Ne();const l=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(Dh))){const{scroll:d}=this.root;d&&(Bt(l.x,d.offset.x),Bt(l.y,d.offset.y))}return l}removeElementScroll(i){const l=Ne();if(Ge(l,i),this.scroll?.wasRoot)return l;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:u,options:x}=d;d!==this.root&&u&&x.layoutScroll&&(u.wasRoot&&Ge(l,i),Bt(l.x,u.offset.x),Bt(l.y,u.offset.y))}return l}applyTransform(i,l=!1){const c=Ne();Ge(c,i);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&_t(c,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),St(u.latestValues)&&_t(c,u.latestValues)}return St(this.latestValues)&&_t(c,this.latestValues),c}removeTransform(i){const l=Ne();Ge(l,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!St(d.latestValues))continue;mn(d.latestValues)&&d.updateSnapshot();const u=Ne(),x=d.measurePageBox();Ge(u,x),Yr(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return St(this.latestValues)&&Yr(l,this.latestValues),l}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ke.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:x}=this.options;if(!this.layout||!(u||x))return;this.resolvedRelativeTargetAt=ke.timestamp;const m=this.getClosestProjectingParent();m&&this.linkedParentVersion!==m.layoutVersion&&!m.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(m&&m.layout?this.createRelativeTarget(m,this.layout.layoutBox,m.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ne(),this.targetWithTransforms=Ne()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Qm(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ge(this.target,this.layout.layoutBox),xl(this.target,this.targetDelta)):Ge(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?this.createRelativeTarget(m,this.target,m.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||mn(this.parent.latestValues)||hl(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(i,l,c){this.relativeParent=i,this.linkedParentVersion=i.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ne(),this.relativeTargetOrigin=Ne(),la(this.relativeTargetOrigin,l,c),Ge(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const i=this.getLead(),l=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ke.timestamp&&(c=!1),c)return;const{layout:d,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||u))return;Ge(this.layoutCorrected,this.layout.layoutBox);const x=this.treeScale.x,m=this.treeScale.y;Tm(this.layoutCorrected,this.treeScale,this.path,l),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Ne());const{target:b}=i;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(zr(this.prevProjectionDelta.x,this.projectionDelta.x),zr(this.prevProjectionDelta.y,this.projectionDelta.y)),hs(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==x||this.treeScale.y!==m||!ti(this.projectionDelta.x,this.prevProjectionDelta.x)||!ti(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Vt(),this.projectionDelta=Vt(),this.projectionDeltaWithTransform=Vt()}setAnimationOrigin(i,l=!1){const c=this.snapshot,d=c?c.latestValues:{},u={...this.latestValues},x=Vt();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=Ne(),b=c?c.source:void 0,f=this.layout?this.layout.source:void 0,y=b!==f,g=this.getStack(),p=!g||g.members.length<=1,v=!!(y&&!p&&this.options.crossfade===!0&&!this.path.some(Ph));this.animationProgress=0;let j;this.mixTargetDelta=S=>{const P=S/1e3;li(x.x,i.x,P),li(x.y,i.y,P),this.setTargetDelta(x),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(la(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Ch(this.relativeTarget,this.relativeTargetOrigin,m,P),j&&ah(this.relativeTarget,j)&&(this.isProjectionDirty=!1),j||(j=Ne()),Ge(j,this.relativeTarget)),y&&(this.animationValues=u,ih(u,d,this.latestValues,P,v,p)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(We(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=le.update(()=>{Js.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Ye(0)),this.currentAnimation=ch(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:l=>{this.mixTargetDelta(l),i.onUpdate&&i.onUpdate(l)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(xh),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:l,target:c,layout:d,latestValues:u}=i;if(!(!l||!c||!d)){if(this!==i&&this.layout&&d&&Il(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||Ne();const x=Le(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+x;const m=Le(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+m}Ge(l,c),_t(l,u),hs(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(i,l){this.sharedNodes.has(i)||this.sharedNodes.set(i,new hh),this.sharedNodes.get(i).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:l,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let l=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const d={};c.z&&Ia("z",i,d,this.animationValues);for(let u=0;u<Ea.length;u++)Ia(`rotate${Ea[u]}`,i,d,this.animationValues),Ia(`skew${Ea[u]}`,i,d,this.animationValues);i.render();for(const u in d)i.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);i.scheduleRender()}applyProjectionStyles(i,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Gs(l?.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Gs(l?.pointerEvents)||""),this.hasProjected&&!St(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const u=d.animationValues||d.latestValues;this.applyTransformsToTarget();let x=nh(this.projectionDeltaWithTransform,this.treeScale,u);c&&(x=c(u,x)),i.transform=x;const{x:m,y:b}=this.projectionDelta;i.transformOrigin=`${m.origin*100}% ${b.origin*100}% 0`,d.animationValues?i.opacity=d===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:i.opacity=d===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const f in xn){if(u[f]===void 0)continue;const{correct:y,applyTo:g,isCSSVariable:p}=xn[f],v=x==="none"?u[f]:y(u[f],d);if(g){const j=g.length;for(let S=0;S<j;S++)i[g[S]]=v}else p?this.options.visualElement.renderState.vars[f]=v:i[f]=v}this.options.layoutId&&(i.pointerEvents=d===this?Gs(l?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(ri),this.root.sharedNodes.clear()}}}function fh(t){t.updateLayout()}function gh(t){const s=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:n}=t.layout,{animationType:r}=t.options,o=s.source!==t.layout.source;r==="size"?_e(u=>{const x=o?s.measuredBox[u]:s.layoutBox[u],m=Le(x);x.min=a[u].min,x.max=x.min+m}):Il(r,s.layoutBox,a)&&_e(u=>{const x=o?s.measuredBox[u]:s.layoutBox[u],m=Le(a[u]);x.max=x.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[u].max=t.relativeTarget[u].min+m)});const i=Vt();hs(i,a,s.layoutBox);const l=Vt();o?hs(l,t.applyTransform(n,!0),s.measuredBox):hs(l,a,s.layoutBox);const c=!Cl(i);let d=!1;if(!t.resumeFrom){const u=t.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:x,layout:m}=u;if(x&&m){const b=Ne();la(b,s.layoutBox,x.layoutBox);const f=Ne();la(f,a,m.layoutBox),Pl(b,f)||(d=!0),u.options.layoutRoot&&(t.relativeTarget=f,t.relativeTargetOrigin=b,t.relativeParent=u)}}}t.notifyListeners("didUpdate",{layout:a,snapshot:s,delta:l,layoutDelta:i,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:a}=t.options;a&&a()}t.options.transition=void 0}function bh(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function yh(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function jh(t){t.clearSnapshot()}function ri(t){t.clearMeasurements()}function ii(t){t.isLayoutDirty=!1}function vh(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function oi(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function Nh(t){t.resolveTargetDelta()}function wh(t){t.calcProjection()}function Sh(t){t.resetSkewAndRotation()}function kh(t){t.removeLeadSnapshot()}function li(t,s,a){t.translate=xe(s.translate,0,a),t.scale=xe(s.scale,1,a),t.origin=s.origin,t.originPoint=s.originPoint}function ci(t,s,a,n){t.min=xe(s.min,a.min,n),t.max=xe(s.max,a.max,n)}function Ch(t,s,a,n){ci(t.x,s.x,a.x,n),ci(t.y,s.y,a.y,n)}function Ph(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Th={duration:.45,ease:[.4,0,.1,1]},di=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),ui=di("applewebkit/")&&!di("chrome/")?Math.round:Oe;function mi(t){t.min=ui(t.min),t.max=ui(t.max)}function Ah(t){mi(t.x),mi(t.y)}function Il(t,s,a){return t==="position"||t==="preserve-aspect"&&!Zm(ei(s),ei(a),.2)}function Dh(t){return t!==t.root&&t.scroll?.wasRoot}const Eh=El({attachResizeListener:(t,s)=>js(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),Ra={current:void 0},Rl=El({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Ra.current){const t=new Eh({});t.mount(window),t.setOptions({layoutScroll:!0}),Ra.current=t}return Ra.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),ga=h.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function hi(t,s){if(typeof t=="function")return t(s);t!=null&&(t.current=s)}function Ih(...t){return s=>{let a=!1;const n=t.map(r=>{const o=hi(r,s);return!a&&typeof o=="function"&&(a=!0),o});if(a)return()=>{for(let r=0;r<n.length;r++){const o=n[r];typeof o=="function"?o():hi(t[r],null)}}}}function Rh(...t){return h.useCallback(Ih(...t),t)}class Lh extends h.Component{getSnapshotBeforeUpdate(s){const a=this.props.childRef.current;if(a&&s.isPresent&&!this.props.isPresent){const n=a.offsetParent,r=ra(n)&&n.offsetWidth||0,o=ra(n)&&n.offsetHeight||0,i=this.props.sizeRef.current;i.height=a.offsetHeight||0,i.width=a.offsetWidth||0,i.top=a.offsetTop,i.left=a.offsetLeft,i.right=r-i.width-i.left,i.bottom=o-i.height-i.top}return null}componentDidUpdate(){}render(){return this.props.children}}function Mh({children:t,isPresent:s,anchorX:a,anchorY:n,root:r}){const o=h.useId(),i=h.useRef(null),l=h.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:c}=h.useContext(ga),d=t.props?.ref??t?.ref,u=Rh(i,d);return h.useInsertionEffect(()=>{const{width:x,height:m,top:b,left:f,right:y,bottom:g}=l.current;if(s||!i.current||!x||!m)return;const p=a==="left"?`left: ${f}`:`right: ${y}`,v=n==="bottom"?`bottom: ${g}`:`top: ${b}`;i.current.dataset.motionPopId=o;const j=document.createElement("style");c&&(j.nonce=c);const S=r??document.head;return S.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${x}px !important;
            height: ${m}px !important;
            ${p}px !important;
            ${v}px !important;
          }
        `),()=>{S.contains(j)&&S.removeChild(j)}},[s]),e.jsx(Lh,{isPresent:s,childRef:i,sizeRef:l,children:h.cloneElement(t,{ref:u})})}const Fh=({children:t,initial:s,isPresent:a,onExitComplete:n,custom:r,presenceAffectsLayout:o,mode:i,anchorX:l,anchorY:c,root:d})=>{const u=gt(Oh),x=h.useId();let m=!0,b=h.useMemo(()=>(m=!1,{id:x,initial:s,isPresent:a,custom:r,onExitComplete:f=>{u.set(f,!0);for(const y of u.values())if(!y)return;n&&n()},register:f=>(u.set(f,!1),()=>u.delete(f))}),[a,u,n]);return o&&m&&(b={...b}),h.useMemo(()=>{u.forEach((f,y)=>u.set(y,!1))},[a]),h.useEffect(()=>{!a&&!u.size&&n&&n()},[a]),i==="popLayout"&&(t=e.jsx(Mh,{isPresent:a,anchorX:l,anchorY:c,root:d,children:t})),e.jsx(xa.Provider,{value:b,children:t})};function Oh(){return new Map}function Ll(t=!0){const s=h.useContext(xa);if(s===null)return[!0,null];const{isPresent:a,onExitComplete:n,register:r}=s,o=h.useId();h.useEffect(()=>{if(t)return r(o)},[t]);const i=h.useCallback(()=>t&&n&&n(o),[o,n,t]);return!a&&n?[!1,i]:[!0]}const Ls=t=>t.key||"";function xi(t){const s=[];return h.Children.forEach(t,a=>{h.isValidElement(a)&&s.push(a)}),s}const Ml=({children:t,custom:s,initial:a=!0,onExitComplete:n,presenceAffectsLayout:r=!0,mode:o="sync",propagate:i=!1,anchorX:l="left",anchorY:c="top",root:d})=>{const[u,x]=Ll(i),m=h.useMemo(()=>xi(t),[t]),b=i&&!u?[]:m.map(Ls),f=h.useRef(!0),y=h.useRef(m),g=gt(()=>new Map),p=h.useRef(new Set),[v,j]=h.useState(m),[S,P]=h.useState(m);ha(()=>{f.current=!1,y.current=m;for(let N=0;N<S.length;N++){const A=Ls(S[N]);b.includes(A)?(g.delete(A),p.current.delete(A)):g.get(A)!==!0&&g.set(A,!1)}},[S,b.length,b.join("-")]);const T=[];if(m!==v){let N=[...m];for(let A=0;A<S.length;A++){const L=S[A],E=Ls(L);b.includes(E)||(N.splice(A,0,L),T.push(L))}return o==="wait"&&T.length&&(N=T),P(xi(N)),j(m),null}const{forceRender:M}=h.useContext(Nn);return e.jsx(e.Fragment,{children:S.map(N=>{const A=Ls(N),L=i&&!u?!1:m===S||b.includes(A),E=()=>{if(p.current.has(A))return;if(p.current.add(A),g.has(A))g.set(A,!0);else return;let F=!0;g.forEach(te=>{te||(F=!1)}),F&&(M?.(),P(y.current),i&&x?.(),n&&n())};return e.jsx(Fh,{isPresent:L,initial:!f.current||a?void 0:!1,custom:s,presenceAffectsLayout:r,mode:o,root:d,onExitComplete:L?void 0:E,anchorX:l,anchorY:c,children:N},A)})})},Fl=h.createContext({strict:!1}),pi={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let fi=!1;function $h(){if(fi)return;const t={};for(const s in pi)t[s]={isEnabled:a=>pi[s].some(n=>!!a[n])};dl(t),fi=!0}function Ol(){return $h(),Sm()}function Vh(t){const s=Ol();for(const a in t)s[a]={...s[a],...t[a]};dl(s)}const Bh=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function ca(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Bh.has(t)}let $l=t=>!ca(t);function _h(t){typeof t=="function"&&($l=s=>s.startsWith("on")?!ca(s):t(s))}try{_h(require("@emotion/is-prop-valid").default)}catch{}function Uh(t,s,a){const n={};for(const r in t)r==="values"&&typeof t.values=="object"||($l(r)||a===!0&&ca(r)||!s&&!ca(r)||t.draggable&&r.startsWith("onDrag"))&&(n[r]=t[r]);return n}const ba=h.createContext({});function qh(t,s){if(fa(t)){const{initial:a,animate:n}=t;return{initial:a===!1||ys(a)?a:void 0,animate:ys(n)?n:void 0}}return t.inherit!==!1?s:{}}function zh(t){const{initial:s,animate:a}=qh(t,h.useContext(ba));return h.useMemo(()=>({initial:s,animate:a}),[gi(s),gi(a)])}function gi(t){return Array.isArray(t)?t.join(" "):t}const Zn=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Vl(t,s,a){for(const n in s)!Te(s[n])&&!gl(n,a)&&(t[n]=s[n])}function Wh({transformTemplate:t},s){return h.useMemo(()=>{const a=Zn();return Yn(a,s,t),Object.assign({},a.vars,a.style)},[s])}function Hh(t,s){const a=t.style||{},n={};return Vl(n,a,t),Object.assign(n,Wh(t,s)),n}function Kh(t,s){const a={},n=Hh(t,s);return t.drag&&t.dragListener!==!1&&(a.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(a.tabIndex=0),a.style=n,a}const Bl=()=>({...Zn(),attrs:{}});function Gh(t,s,a,n){const r=h.useMemo(()=>{const o=Bl();return bl(o,s,jl(n),t.transformTemplate,t.style),{...o.attrs,style:{...o.style}}},[s]);if(t.style){const o={};Vl(o,t.style,t),r.style={...o,...r.style}}return r}const Jh=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Qn(t){return typeof t!="string"||t.includes("-")?!1:!!(Jh.indexOf(t)>-1||/[A-Z]/u.test(t))}function Yh(t,s,a,{latestValues:n},r,o=!1,i){const c=(i??Qn(t)?Gh:Kh)(s,n,r,t),d=Uh(s,typeof t=="string",o),u=t!==h.Fragment?{...d,...c,ref:a}:{},{children:x}=s,m=h.useMemo(()=>Te(x)?x.get():x,[x]);return h.createElement(t,{...u,children:m})}function Xh({scrapeMotionValuesFromProps:t,createRenderState:s},a,n,r){return{latestValues:Zh(a,n,r,t),renderState:s()}}function Zh(t,s,a,n){const r={},o=n(t,{});for(const m in o)r[m]=Gs(o[m]);let{initial:i,animate:l}=t;const c=fa(t),d=cl(t);s&&d&&!c&&t.inherit!==!1&&(i===void 0&&(i=s.initial),l===void 0&&(l=s.animate));let u=a?a.initial===!1:!1;u=u||i===!1;const x=u?l:i;if(x&&typeof x!="boolean"&&!pa(x)){const m=Array.isArray(x)?x:[x];for(let b=0;b<m.length;b++){const f=Un(t,m[b]);if(f){const{transitionEnd:y,transition:g,...p}=f;for(const v in p){let j=p[v];if(Array.isArray(j)){const S=u?j.length-1:0;j=j[S]}j!==null&&(r[v]=j)}for(const v in y)r[v]=y[v]}}}return r}const _l=t=>(s,a)=>{const n=h.useContext(ba),r=h.useContext(xa),o=()=>Xh(t,s,n,r);return a?o():gt(o)},Qh=_l({scrapeMotionValuesFromProps:Xn,createRenderState:Zn}),ex=_l({scrapeMotionValuesFromProps:vl,createRenderState:Bl}),tx=Symbol.for("motionComponentSymbol");function sx(t,s,a){const n=h.useRef(a);h.useInsertionEffect(()=>{n.current=a});const r=h.useRef(null);return h.useCallback(o=>{o&&t.onMount?.(o),s&&(o?s.mount(o):s.unmount());const i=n.current;if(typeof i=="function")if(o){const l=i(o);typeof l=="function"&&(r.current=l)}else r.current?(r.current(),r.current=null):i(o);else i&&(i.current=o)},[s])}const Ul=h.createContext({});function os(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function ax(t,s,a,n,r,o){const{visualElement:i}=h.useContext(ba),l=h.useContext(Fl),c=h.useContext(xa),d=h.useContext(ga).reducedMotion,u=h.useRef(null),x=h.useRef(!1);n=n||l.renderer,!u.current&&n&&(u.current=n(t,{visualState:s,parent:i,props:a,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:d,isSVG:o}),x.current&&u.current&&(u.current.manuallyAnimateOnMount=!0));const m=u.current,b=h.useContext(Ul);m&&!m.projection&&r&&(m.type==="html"||m.type==="svg")&&nx(u.current,a,r,b);const f=h.useRef(!1);h.useInsertionEffect(()=>{m&&f.current&&m.update(a,c)});const y=a[Ko],g=h.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return ha(()=>{x.current=!0,m&&(f.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),m.scheduleRenderMicrotask(),g.current&&m.animationState&&m.animationState.animateChanges())}),h.useEffect(()=>{m&&(!g.current&&m.animationState&&m.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),g.current=!1),m.enteringChildren=void 0)}),m}function nx(t,s,a,n){const{layoutId:r,layout:o,drag:i,dragConstraints:l,layoutScroll:c,layoutRoot:d,layoutCrossfade:u}=s;t.projection=new a(t.latestValues,s["data-framer-portal-id"]?void 0:ql(t.parent)),t.projection.setOptions({layoutId:r,layout:o,alwaysMeasureLayout:!!i||l&&os(l),visualElement:t,animationType:typeof o=="string"?o:"both",initialPromotionConfig:n,crossfade:u,layoutScroll:c,layoutRoot:d})}function ql(t){if(t)return t.options.allowProjection!==!1?t.projection:ql(t.parent)}function La(t,{forwardMotionProps:s=!1,type:a}={},n,r){n&&Vh(n);const o=a?a==="svg":Qn(t),i=o?ex:Qh;function l(d,u){let x;const m={...h.useContext(ga),...d,layoutId:rx(d)},{isStatic:b}=m,f=zh(d),y=i(d,b);if(!b&&lo){ix();const g=ox(m);x=g.MeasureLayout,f.visualElement=ax(t,y,m,r,g.ProjectionNode,o)}return e.jsxs(ba.Provider,{value:f,children:[x&&f.visualElement?e.jsx(x,{visualElement:f.visualElement,...m}):null,Yh(t,d,sx(y,f.visualElement,u),y,b,s,o)]})}l.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const c=h.forwardRef(l);return c[tx]=t,c}function rx({layoutId:t}){const s=h.useContext(Nn).id;return s&&t!==void 0?s+"-"+t:t}function ix(t,s){h.useContext(Fl).strict}function ox(t){const s=Ol(),{drag:a,layout:n}=s;if(!a&&!n)return{};const r={...a,...n};return{MeasureLayout:a?.isEnabled(t)||n?.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function lx(t,s){if(typeof Proxy>"u")return La;const a=new Map,n=(o,i)=>La(o,i,t,s),r=(o,i)=>n(o,i);return new Proxy(r,{get:(o,i)=>i==="create"?n:(a.has(i)||a.set(i,La(i,void 0,t,s)),a.get(i))})}const cx=(t,s)=>s.isSVG??Qn(t)?new _m(s):new Mm(s,{allowProjection:t!==h.Fragment});class dx extends jt{constructor(s){super(s),s.animationState||(s.animationState=Hm(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();pa(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:a}=this.node.prevProps||{};s!==a&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let ux=0;class mx extends jt{constructor(){super(...arguments),this.id=ux++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:a}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===n)return;const r=this.node.animationState.setActive("exit",!s);a&&!s&&r.then(()=>{a(this.id)})}mount(){const{register:s,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const hx={animation:{Feature:dx},exit:{Feature:mx}};function Ss(t){return{point:{x:t.pageX,y:t.pageY}}}const xx=t=>s=>Hn(s)&&t(s,Ss(s));function xs(t,s,a,n){return js(t,s,xx(a),n)}const zl=({current:t})=>t?t.ownerDocument.defaultView:null,bi=(t,s)=>Math.abs(t-s);function px(t,s){const a=bi(t.x,s.x),n=bi(t.y,s.y);return Math.sqrt(a**2+n**2)}const yi=new Set(["auto","scroll"]);class Wl{constructor(s,a,{transformPagePoint:n,contextWindow:r=window,dragSnapToOrigin:o=!1,distanceThreshold:i=3,element:l}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=b=>{this.handleScroll(b.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=Fa(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,y=px(b.offset,{x:0,y:0})>=this.distanceThreshold;if(!f&&!y)return;const{point:g}=b,{timestamp:p}=ke;this.history.push({...g,timestamp:p});const{onStart:v,onMove:j}=this.handlers;f||(v&&v(this.lastMoveEvent,b),this.startEvent=this.lastMoveEvent),j&&j(this.lastMoveEvent,b)},this.handlePointerMove=(b,f)=>{this.lastMoveEvent=b,this.lastMoveEventInfo=Ma(f,this.transformPagePoint),le.update(this.updatePoint,!0)},this.handlePointerUp=(b,f)=>{this.end();const{onEnd:y,onSessionEnd:g,resumeAnimation:p}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&p&&p(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=Fa(b.type==="pointercancel"?this.lastMoveEventInfo:Ma(f,this.transformPagePoint),this.history);this.startEvent&&y&&y(b,v),g&&g(b,v)},!Hn(s))return;this.dragSnapToOrigin=o,this.handlers=a,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=r||window;const c=Ss(s),d=Ma(c,this.transformPagePoint),{point:u}=d,{timestamp:x}=ke;this.history=[{...u,timestamp:x}];const{onSessionStart:m}=a;m&&m(s,Fa(d,this.history)),this.removeListeners=vs(xs(this.contextWindow,"pointermove",this.handlePointerMove),xs(this.contextWindow,"pointerup",this.handlePointerUp),xs(this.contextWindow,"pointercancel",this.handlePointerUp)),l&&this.startScrollTracking(l)}startScrollTracking(s){let a=s.parentElement;for(;a;){const n=getComputedStyle(a);(yi.has(n.overflowX)||yi.has(n.overflowY))&&this.scrollPositions.set(a,{x:a.scrollLeft,y:a.scrollTop}),a=a.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(s){const a=this.scrollPositions.get(s);if(!a)return;const n=s===window,r=n?{x:window.scrollX,y:window.scrollY}:{x:s.scrollLeft,y:s.scrollTop},o={x:r.x-a.x,y:r.y-a.y};o.x===0&&o.y===0||(n?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=o.x,this.lastMoveEventInfo.point.y+=o.y):this.history.length>0&&(this.history[0].x-=o.x,this.history[0].y-=o.y),this.scrollPositions.set(s,r),le.update(this.updatePoint,!0))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),We(this.updatePoint)}}function Ma(t,s){return s?{point:s(t.point)}:t}function ji(t,s){return{x:t.x-s.x,y:t.y-s.y}}function Fa({point:t},s){return{point:t,delta:ji(t,Hl(s)),offset:ji(t,fx(s)),velocity:gx(s,.1)}}function fx(t){return t[0]}function Hl(t){return t[t.length-1]}function gx(t,s){if(t.length<2)return{x:0,y:0};let a=t.length-1,n=null;const r=Hl(t);for(;a>=0&&(n=t[a],!(r.timestamp-n.timestamp>dt(s)));)a--;if(!n)return{x:0,y:0};const o=qe(r.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const i={x:(r.x-n.x)/o,y:(r.y-n.y)/o};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function bx(t,{min:s,max:a},n){return s!==void 0&&t<s?t=n?xe(s,t,n.min):Math.max(t,s):a!==void 0&&t>a&&(t=n?xe(a,t,n.max):Math.min(t,a)),t}function vi(t,s,a){return{min:s!==void 0?t.min+s:void 0,max:a!==void 0?t.max+a-(t.max-t.min):void 0}}function yx(t,{top:s,left:a,bottom:n,right:r}){return{x:vi(t.x,a,r),y:vi(t.y,s,n)}}function Ni(t,s){let a=s.min-t.min,n=s.max-t.max;return s.max-s.min<t.max-t.min&&([a,n]=[n,a]),{min:a,max:n}}function jx(t,s){return{x:Ni(t.x,s.x),y:Ni(t.y,s.y)}}function vx(t,s){let a=.5;const n=Le(t),r=Le(s);return r>n?a=Ht(s.min,s.max-n,t.min):n>r&&(a=Ht(t.min,t.max-r,s.min)),et(0,1,a)}function Nx(t,s){const a={};return s.min!==void 0&&(a.min=s.min-t.min),s.max!==void 0&&(a.max=s.max-t.min),a}const pn=.35;function wx(t=pn){return t===!1?t=0:t===!0&&(t=pn),{x:wi(t,"left","right"),y:wi(t,"top","bottom")}}function wi(t,s,a){return{min:Si(t,s),max:Si(t,a)}}function Si(t,s){return typeof t=="number"?t:t[s]||0}const Sx=new WeakMap;class kx{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ne(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:a=!1,distanceThreshold:n}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const o=x=>{a?(this.stopAnimation(),this.snapToCursor(Ss(x).point)):this.pauseAnimation()},i=(x,m)=>{this.stopAnimation();const{drag:b,dragPropagation:f,onDragStart:y}=this.getProps();if(b&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=sm(b),!this.openDragLock))return;this.latestPointerEvent=x,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),_e(p=>{let v=this.getAxisMotionValue(p).get()||0;if(rt.test(v)){const{projection:j}=this.visualElement;if(j&&j.layout){const S=j.layout.layoutBox[p];S&&(v=Le(S)*(parseFloat(v)/100))}}this.originPoint[p]=v}),y&&le.postRender(()=>y(x,m)),ln(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},l=(x,m)=>{this.latestPointerEvent=x,this.latestPanInfo=m;const{dragPropagation:b,dragDirectionLock:f,onDirectionLock:y,onDrag:g}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:p}=m;if(f&&this.currentDirection===null){this.currentDirection=Cx(p),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",m.point,p),this.updateAxis("y",m.point,p),this.visualElement.render(),g&&g(x,m)},c=(x,m)=>{this.latestPointerEvent=x,this.latestPanInfo=m,this.stop(x,m),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>_e(x=>this.getAnimationState(x)==="paused"&&this.getAxisMotionValue(x).animation?.play()),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Wl(s,{onSessionStart:o,onStart:i,onMove:l,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:n,contextWindow:zl(this.visualElement),element:this.visualElement.current})}stop(s,a){const n=s||this.latestPointerEvent,r=a||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!r||!n)return;const{velocity:i}=r;this.startAnimation(i);const{onDragEnd:l}=this.getProps();l&&le.postRender(()=>l(n,r))}cancel(){this.isDragging=!1;const{projection:s,animationState:a}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(s,a,n){const{drag:r}=this.getProps();if(!n||!Ms(s,r,this.currentDirection))return;const o=this.getAxisMotionValue(s);let i=this.originPoint[s]+n[s];this.constraints&&this.constraints[s]&&(i=bx(i,this.constraints[s],this.elastic[s])),o.set(i)}resolveConstraints(){const{dragConstraints:s,dragElastic:a}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,r=this.constraints;s&&os(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&n?this.constraints=yx(n.layoutBox,s):this.constraints=!1,this.elastic=wx(a),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&_e(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Nx(n.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:a}=this.getProps();if(!s||!os(s))return!1;const n=s.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const o=Am(n,r.root,this.visualElement.getTransformPagePoint());let i=jx(r.layout.layoutBox,o);if(a){const l=a(Cm(i));this.hasMutatedConstraints=!!l,l&&(i=ml(l))}return i}startAnimation(s){const{drag:a,dragMomentum:n,dragElastic:r,dragTransition:o,dragSnapToOrigin:i,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},d=_e(u=>{if(!Ms(u,a,this.currentDirection))return;let x=c&&c[u]||{};i&&(x={min:0,max:0});const m=r?200:1e6,b=r?40:1e7,f={type:"inertia",velocity:n?s[u]:0,bounceStiffness:m,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...o,...x};return this.startAxisValueAnimation(u,f)});return Promise.all(d).then(l)}startAxisValueAnimation(s,a){const n=this.getAxisMotionValue(s);return ln(this.visualElement,s),n.start(_n(s,n,0,a,this.visualElement,!1))}stopAnimation(){_e(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){_e(s=>this.getAxisMotionValue(s).animation?.pause())}getAnimationState(s){return this.getAxisMotionValue(s).animation?.state}getAxisMotionValue(s){const a=`_drag${s.toUpperCase()}`,n=this.visualElement.getProps(),r=n[a];return r||this.visualElement.getValue(s,(n.initial?n.initial[s]:void 0)||0)}snapToCursor(s){_e(a=>{const{drag:n}=this.getProps();if(!Ms(a,n,this.currentDirection))return;const{projection:r}=this.visualElement,o=this.getAxisMotionValue(a);if(r&&r.layout){const{min:i,max:l}=r.layout.layoutBox[a],c=o.get()||0;o.set(s[a]-xe(i,l,.5)+c)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:a}=this.getProps(),{projection:n}=this.visualElement;if(!os(a)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};_e(i=>{const l=this.getAxisMotionValue(i);if(l&&this.constraints!==!1){const c=l.get();r[i]=vx({min:c,max:c},this.constraints[i])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),_e(i=>{if(!Ms(i,s,null))return;const l=this.getAxisMotionValue(i),{min:c,max:d}=this.constraints[i];l.set(xe(c,d,r[i]))})}addListeners(){if(!this.visualElement.current)return;Sx.set(this.visualElement,this);const s=this.visualElement.current,a=xs(s,"pointerdown",c=>{const{drag:d,dragListener:u=!0}=this.getProps(),x=c.target,m=x!==s&&rl(x);d&&u&&!m&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();os(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,o=r.addEventListener("measure",n);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),le.read(n);const i=js(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(_e(u=>{const x=this.getAxisMotionValue(u);x&&(this.originPoint[u]+=c[u].translate,x.set(x.get()+c[u].translate))}),this.visualElement.render())}));return()=>{i(),a(),o(),l&&l()}}getProps(){const s=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:o=!1,dragElastic:i=pn,dragMomentum:l=!0}=s;return{...s,drag:a,dragDirectionLock:n,dragPropagation:r,dragConstraints:o,dragElastic:i,dragMomentum:l}}}function Ms(t,s,a){return(s===!0||s===t)&&(a===null||a===t)}function Cx(t,s=10){let a=null;return Math.abs(t.y)>s?a="y":Math.abs(t.x)>s&&(a="x"),a}class Px extends jt{constructor(s){super(s),this.removeGroupControls=Oe,this.removeListeners=Oe,this.controls=new kx(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Oe}update(){const{dragControls:s}=this.node.getProps(),{dragControls:a}=this.node.prevProps||{};s!==a&&(this.removeGroupControls(),s&&(this.removeGroupControls=s.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const ki=t=>(s,a)=>{t&&le.postRender(()=>t(s,a))};class Tx extends jt{constructor(){super(...arguments),this.removePointerDownListener=Oe}onPointerDown(s){this.session=new Wl(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:zl(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:a,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:ki(s),onStart:ki(a),onMove:n,onEnd:(o,i)=>{delete this.session,r&&le.postRender(()=>r(o,i))}}}mount(){this.removePointerDownListener=xs(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let Oa=!1;class Ax extends h.Component{componentDidMount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:n,layoutId:r}=this.props,{projection:o}=s;o&&(a.group&&a.group.add(o),n&&n.register&&r&&n.register(o),Oa&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),Js.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:a,visualElement:n,drag:r,isPresent:o}=this.props,{projection:i}=n;return i&&(i.isPresent=o,s.layoutDependency!==a&&i.setOptions({...i.options,layoutDependency:a}),Oa=!0,r||s.layoutDependency!==a||a===void 0||s.isPresent!==o?i.willUpdate():this.safeToRemove(),s.isPresent!==o&&(o?i.promote():i.relegate()||le.postRender(()=>{const l=i.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),Wn.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:n}=this.props,{projection:r}=s;Oa=!0,r&&(r.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function Kl(t){const[s,a]=Ll(),n=h.useContext(Nn);return e.jsx(Ax,{...t,layoutGroup:n,switchLayoutGroup:h.useContext(Ul),isPresent:s,safeToRemove:a})}const Dx={pan:{Feature:Tx},drag:{Feature:Px,ProjectionNode:Rl,MeasureLayout:Kl}};function Ci(t,s,a){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",a==="Start");const r="onHover"+a,o=n[r];o&&le.postRender(()=>o(s,Ss(s)))}class Ex extends jt{mount(){const{current:s}=this.node;s&&(this.unmount=am(s,(a,n)=>(Ci(this.node,n,"Start"),r=>Ci(this.node,r,"End"))))}unmount(){}}class Ix extends jt{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=vs(js(this.node.current,"focus",()=>this.onFocus()),js(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Pi(t,s,a){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",a==="Start");const r="onTap"+(a==="End"?"":a),o=n[r];o&&le.postRender(()=>o(s,Ss(s)))}class Rx extends jt{mount(){const{current:s}=this.node;s&&(this.unmount=im(s,(a,n)=>(Pi(this.node,n,"Start"),(r,{success:o})=>Pi(this.node,r,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const fn=new WeakMap,$a=new WeakMap,Lx=t=>{const s=fn.get(t.target);s&&s(t)},Mx=t=>{t.forEach(Lx)};function Fx({root:t,...s}){const a=t||document;$a.has(a)||$a.set(a,{});const n=$a.get(a),r=JSON.stringify(s);return n[r]||(n[r]=new IntersectionObserver(Mx,{root:t,...s})),n[r]}function Ox(t,s,a){const n=Fx(s);return fn.set(t,a),n.observe(t),()=>{fn.delete(t),n.unobserve(t)}}const $x={some:0,all:1};class Vx extends jt{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:a,margin:n,amount:r="some",once:o}=s,i={root:a?a.current:void 0,rootMargin:n,threshold:typeof r=="number"?r:$x[r]},l=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,o&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:x}=this.node.getProps(),m=d?u:x;m&&m(c)};return Ox(this.node.current,i,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:a}=this.node;["amount","margin","root"].some(Bx(s,a))&&this.startObserver()}unmount(){}}function Bx({viewport:t={}},{viewport:s={}}={}){return a=>t[a]!==s[a]}const _x={inView:{Feature:Vx},tap:{Feature:Rx},focus:{Feature:Ix},hover:{Feature:Ex}},Ux={layout:{ProjectionNode:Rl,MeasureLayout:Kl}},qx={...hx,..._x,...Dx,...Ux},V=lx(qx,cx),zx=50,Ti=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),Wx=()=>({time:0,x:Ti(),y:Ti()}),Hx={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function Ai(t,s,a,n){const r=a[s],{length:o,position:i}=Hx[s],l=r.current,c=a.time;r.current=t[`scroll${i}`],r.scrollLength=t[`scroll${o}`]-t[`client${o}`],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=Ht(0,r.scrollLength,r.current);const d=n-c;r.velocity=d>zx?0:Pn(r.current-l,d)}function Kx(t,s,a){Ai(t,"x",s,a),Ai(t,"y",s,a),s.time=a}function Gx(t,s){const a={x:0,y:0};let n=t;for(;n&&n!==s;)if(ra(n))a.x+=n.offsetLeft,a.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const r=n.getBoundingClientRect();n=n.parentElement;const o=n.getBoundingClientRect();a.x+=r.left-o.left,a.y+=r.top-o.top}else if(n instanceof SVGGraphicsElement){const{x:r,y:o}=n.getBBox();a.x+=r,a.y+=o;let i=null,l=n.parentNode;for(;!i;)l.tagName==="svg"&&(i=l),l=n.parentNode;n=i}else break;return a}const gn={start:0,center:.5,end:1};function Di(t,s,a=0){let n=0;if(t in gn&&(t=gn[t]),typeof t=="string"){const r=parseFloat(t);t.endsWith("px")?n=r:t.endsWith("%")?t=r/100:t.endsWith("vw")?n=r/100*document.documentElement.clientWidth:t.endsWith("vh")?n=r/100*document.documentElement.clientHeight:t=r}return typeof t=="number"&&(n=s*t),a+n}const Jx=[0,0];function Yx(t,s,a,n){let r=Array.isArray(t)?t:Jx,o=0,i=0;return typeof t=="number"?r=[t,t]:typeof t=="string"&&(t=t.trim(),t.includes(" ")?r=t.split(" "):r=[t,gn[t]?t:"0"]),o=Di(r[0],a,n),i=Di(r[1],s),o-i}const Xx={All:[[0,0],[1,1]]},Zx={x:0,y:0};function Qx(t){return"getBBox"in t&&t.tagName!=="svg"?t.getBBox():{width:t.clientWidth,height:t.clientHeight}}function ep(t,s,a){const{offset:n=Xx.All}=a,{target:r=t,axis:o="y"}=a,i=o==="y"?"height":"width",l=r!==t?Gx(r,t):Zx,c=r===t?{width:t.scrollWidth,height:t.scrollHeight}:Qx(r),d={width:t.clientWidth,height:t.clientHeight};s[o].offset.length=0;let u=!s[o].interpolate;const x=n.length;for(let m=0;m<x;m++){const b=Yx(n[m],d[i],c[i],l[o]);!u&&b!==s[o].interpolatorOffsets[m]&&(u=!0),s[o].offset[m]=b}u&&(s[o].interpolate=Mn(s[o].offset,Mo(n),{clamp:!1}),s[o].interpolatorOffsets=[...s[o].offset]),s[o].progress=et(0,1,s[o].interpolate(s[o].current))}function tp(t,s=t,a){if(a.x.targetOffset=0,a.y.targetOffset=0,s!==t){let n=s;for(;n&&n!==t;)a.x.targetOffset+=n.offsetLeft,a.y.targetOffset+=n.offsetTop,n=n.offsetParent}a.x.targetLength=s===t?s.scrollWidth:s.clientWidth,a.y.targetLength=s===t?s.scrollHeight:s.clientHeight,a.x.containerLength=t.clientWidth,a.y.containerLength=t.clientHeight}function sp(t,s,a,n={}){return{measure:r=>{tp(t,n.target,a),Kx(t,a,r),(n.offset||n.target)&&ep(t,a,n)},notify:()=>s(a)}}const Mt=new WeakMap,Ei=new WeakMap,Va=new WeakMap,Ii=new WeakMap,Fs=new WeakMap,Ri=t=>t===document.scrollingElement?window:t;function Gl(t,{container:s=document.scrollingElement,trackContentSize:a=!1,...n}={}){if(!s)return Oe;let r=Va.get(s);r||(r=new Set,Va.set(s,r));const o=Wx(),i=sp(s,t,o,n);if(r.add(i),!Mt.has(s)){const c=()=>{for(const m of r)m.measure(ke.timestamp);le.preUpdate(d)},d=()=>{for(const m of r)m.notify()},u=()=>le.read(c);Mt.set(s,u);const x=Ri(s);window.addEventListener("resize",u,{passive:!0}),s!==document.documentElement&&Ei.set(s,pm(s,u)),x.addEventListener("scroll",u,{passive:!0}),u()}if(a&&!Fs.has(s)){const c=Mt.get(s),d={width:s.scrollWidth,height:s.scrollHeight};Ii.set(s,d);const u=()=>{const m=s.scrollWidth,b=s.scrollHeight;(d.width!==m||d.height!==b)&&(c(),d.width=m,d.height=b)},x=le.read(u,!0);Fs.set(s,x)}const l=Mt.get(s);return le.read(l,!1,!0),()=>{We(l);const c=Va.get(s);if(!c||(c.delete(i),c.size))return;const d=Mt.get(s);Mt.delete(s),d&&(Ri(s).removeEventListener("scroll",d),Ei.get(s)?.(),window.removeEventListener("resize",d));const u=Fs.get(s);u&&(We(u),Fs.delete(s)),Ii.delete(s)}}const Li=new Map;function ap(t){const s={value:0},a=Gl(n=>{s.value=n[t.axis].progress*100},t);return{currentTime:s,cancel:a}}function Jl({source:t,container:s,...a}){const{axis:n}=a;t&&(s=t);const r=Li.get(s)??new Map;Li.set(s,r);const o=a.target??"self",i=r.get(o)??{},l=n+(a.offset??[]).join(",");return i[l]||(i[l]=!a.target&&Vo()?new ScrollTimeline({source:s,axis:n}):ap({container:s,...a})),i[l]}function np(t,s){const a=Jl(s);return t.attachTimeline({timeline:s.target?void 0:a,observe:n=>(n.pause(),ol(r=>{n.time=n.iterationDuration*r},a))})}function rp(t){return t.length===2}function ip(t,s){return rp(t)?Gl(a=>{t(a[s.axis].progress,a)},s):ol(t,Jl(s))}function op(t,{axis:s="y",container:a=document.scrollingElement,...n}={}){if(!a)return Oe;const r={axis:s,container:a,...n};return typeof t=="function"?ip(t,r):np(t,r)}const lp=()=>({scrollX:Ye(0),scrollY:Ye(0),scrollXProgress:Ye(0),scrollYProgress:Ye(0)}),Os=t=>t?!t.current:!1;function cp({container:t,target:s,...a}={}){const n=gt(lp),r=h.useRef(null),o=h.useRef(!1),i=h.useCallback(()=>(r.current=op((l,{x:c,y:d})=>{n.scrollX.set(c.current),n.scrollXProgress.set(c.progress),n.scrollY.set(d.current),n.scrollYProgress.set(d.progress)},{...a,container:t?.current||void 0,target:s?.current||void 0}),()=>{r.current?.()}),[t,s,JSON.stringify(a.offset)]);return ha(()=>{if(o.current=!1,Os(t)||Os(s)){o.current=!0;return}else return i()},[i]),h.useEffect(()=>{if(o.current)return fs(!Os(t)),fs(!Os(s)),i()},[i]),n}function dp(t){const s=gt(()=>Ye(t)),{isStatic:a}=h.useContext(ga);if(a){const[,n]=h.useState(t);h.useEffect(()=>s.on("change",n),[])}return s}function Yl(t,s){const a=dp(s()),n=()=>a.set(s());return n(),ha(()=>{const r=()=>le.preRender(n,!1,!0),o=t.map(i=>i.on("change",r));return()=>{o.forEach(i=>i()),We(n)}}),a}function up(t){ms.current=[],t();const s=Yl(ms.current,t);return ms.current=void 0,s}function Ys(t,s,a,n){if(typeof t=="function")return up(t);if(a!==void 0&&!Array.isArray(a)&&typeof s!="function")return mp(t,s,a,n);const i=typeof s=="function"?s:gm(s,a,n);return Array.isArray(t)?Mi(t,i):Mi([t],([l])=>i(l))}function Mi(t,s){const a=gt(()=>[]);return Yl(t,()=>{a.length=0;const n=t.length;for(let r=0;r<n;r++)a[r]=t[r].get();return s(a)})}function mp(t,s,a,n){const r=gt(()=>Object.keys(a)),o=gt(()=>({}));for(const i of r)o[i]=Ys(t,s,a[i],n);return o}function hp(){const[t,s]=h.useState([]),[a,n]=h.useState([]),[r,o]=h.useState(!0),[i,l]=h.useState("7days"),[c,d]=h.useState("bar");h.useEffect(()=>{u()},[]);const u=async()=>{try{const S={Authorization:`Bearer ${localStorage.getItem("token")}`},[P,T]=await Promise.all([fetch(`${ee}/sales`,{headers:S}),fetch(`${ee}/products`,{headers:S})]),M=await P.json(),N=await T.json();s(M),n(N)}catch(j){console.error("Failed to load analytics data:",j)}finally{o(!1)}},x=()=>{const j=new Date,P={"7days":7,"30days":30,"90days":90,all:9999}[i]||7,T=new Date(j.getTime()-P*24*60*60*1e3);return t.filter(M=>new Date(M.created_at||M.date)>=T)},m=()=>{const j=x(),S={};return j.forEach(P=>{P.items&&P.items.forEach(T=>{if(!S[T.product_id]){const A=a.find(L=>L.id===T.product_id);S[T.product_id]={name:T.name||A?.name||"Unknown",quantity:0,revenue:0,profit:0,count:0}}S[T.product_id].quantity+=T.quantity||0,S[T.product_id].revenue+=(T.price||0)*(T.quantity||0);const N=a.find(A=>A.id===T.product_id)?.cost||0;S[T.product_id].profit+=((T.price||0)-N)*(T.quantity||0),S[T.product_id].count+=1})}),Object.values(S).sort((P,T)=>T.revenue-P.revenue)},b=()=>{const j=x(),S={};return j.forEach(P=>{const T=new Date(P.created_at||P.date).toLocaleDateString();S[T]||(S[T]={date:T,revenue:0,count:0}),S[T].revenue+=P.total||0,S[T].count+=1}),Object.values(S).sort((P,T)=>new Date(P.date)-new Date(T.date))},y=(()=>{const j=x(),S=j.reduce((A,L)=>A+(L.total||0),0),P=j.length,T=P>0?S/P:0,M=j.reduce((A,L)=>L.items?A+L.items.reduce((E,F)=>{const ye=a.find(we=>we.id===F.product_id)?.cost||0;return E+((F.price||0)-ye)*(F.quantity||0)},0):A,0),N=S>0?M/S*100:0;return{totalRevenue:S,totalTransactions:P,avgTransaction:T,totalProfit:M,profitMargin:N}})(),g=m(),p=b(),v=Math.max(...p.map(j=>j.revenue),1);return r?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track your business performance and trends"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:i,onChange:j=>l(j.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"7days",children:"Last 7 Days"}),e.jsx("option",{value:"30days",children:"Last 30 Days"}),e.jsx("option",{value:"90days",children:"Last 90 Days"}),e.jsx("option",{value:"all",children:"All Time"})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(qi,{className:"w-4 h-4"}),"Export"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["KES ",y.totalRevenue.toLocaleString()]})]}),e.jsx("div",{className:"bg-green-100 rounded-full p-3",children:e.jsx($e,{className:"w-6 h-6 text-green-600"})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-4 text-sm text-green-600",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Revenue generated"})]})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Profit"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["KES ",y.totalProfit.toLocaleString()]})]}),e.jsx("div",{className:"bg-blue-100 rounded-full p-3",children:e.jsx(Ae,{className:"w-6 h-6 text-blue-600"})})]}),e.jsx("div",{className:"flex items-center gap-2 mt-4 text-sm text-blue-600",children:e.jsxs("span",{children:[y.profitMargin.toFixed(1),"% Margin"]})})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:y.totalTransactions})]}),e.jsx("div",{className:"bg-purple-100 rounded-full p-3",children:e.jsx(ct,{className:"w-6 h-6 text-purple-600"})})]}),e.jsx("div",{className:"flex items-center gap-2 mt-4 text-sm text-purple-600",children:e.jsx("span",{children:"Total sales count"})})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Avg Transaction"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["KES ",y.avgTransaction.toLocaleString()]})]}),e.jsx("div",{className:"bg-orange-100 rounded-full p-3",children:e.jsx(De,{className:"w-6 h-6 text-orange-600"})})]}),e.jsx("div",{className:"flex items-center gap-2 mt-4 text-sm text-orange-600",children:e.jsx("span",{children:"Per sale average"})})]})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Sales Trend"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d("bar"),className:`p-2 rounded-lg ${c==="bar"?"bg-blue-100 text-blue-600":"text-gray-400 hover:bg-gray-100"}`,children:e.jsx(bn,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>d("line"),className:`p-2 rounded-lg ${c==="line"?"bg-blue-100 text-blue-600":"text-gray-400 hover:bg-gray-100"}`,children:e.jsx(Ae,{className:"w-5 h-5"})})]})]}),p.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(it,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No sales data available for selected period"})]}):e.jsxs("div",{className:"space-y-4",children:[c==="bar"&&e.jsx("div",{className:"space-y-3",children:p.map((j,S)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-24 text-sm text-gray-600",children:j.date}),e.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-10 relative overflow-hidden",children:e.jsx(V.div,{initial:{width:0},animate:{width:`${j.revenue/v*100}%`},transition:{duration:.8,delay:S*.05},className:"bg-gradient-to-r from-blue-500 to-purple-500 h-full rounded-full flex items-center justify-end pr-3",children:e.jsxs("span",{className:"text-white text-sm font-medium",children:["KES ",j.revenue.toLocaleString()]})})}),e.jsxs("div",{className:"w-16 text-sm text-gray-600 text-right",children:[j.count," sales"]})]},S))}),c==="line"&&e.jsx("div",{className:"relative h-64",children:e.jsxs("svg",{className:"w-full h-full",children:[[0,25,50,75,100].map(j=>e.jsx("line",{x1:"0",y1:`${100-j}%`,x2:"100%",y2:`${100-j}%`,stroke:"#e5e7eb",strokeWidth:"1"},j)),e.jsx(V.polyline,{initial:{pathLength:0},animate:{pathLength:1},transition:{duration:1.5},fill:"none",stroke:"url(#gradient)",strokeWidth:"3",points:p.map((j,S)=>{const P=S/(p.length-1)*100,T=100-j.revenue/v*90;return`${P}%,${T}%`}).join(" ")}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),e.jsx("stop",{offset:"100%",stopColor:"#8b5cf6"})]})}),p.map((j,S)=>{const P=S/(p.length-1)*100,T=100-j.revenue/v*90;return e.jsx("circle",{cx:`${P}%`,cy:`${T}%`,r:"4",fill:"#3b82f6"},S)})]})})]})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Top Selling Products"}),g.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(De,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No product sales data available"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Rank"}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Product"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-700",children:"Quantity Sold"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-700",children:"Revenue"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-700",children:"Profit"}),e.jsx("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-700",children:"Sales Count"})]})}),e.jsx("tbody",{children:g.slice(0,10).map((j,S)=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${S===0?"bg-yellow-100 text-yellow-700":S===1?"bg-gray-100 text-gray-700":S===2?"bg-orange-100 text-orange-700":"bg-gray-50 text-gray-600"}`,children:S+1})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("p",{className:"font-medium text-gray-900",children:j.name})}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsx("span",{className:"text-gray-900",children:j.quantity})}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsxs("span",{className:"font-medium text-gray-900",children:["KES ",j.revenue.toLocaleString()]})}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsxs("span",{className:`font-medium ${j.profit>=0?"text-green-600":"text-red-600"}`,children:["KES ",j.profit.toLocaleString()]})}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsx("span",{className:"text-gray-600",children:j.count})})]},S))})]})})]})]})}const xp=()=>"https://universal-backend-w0x1.onrender.com/api".replace("https://","wss://").replace("http://","ws://").replace("/api","");class pp{constructor(){this.ws=null,this.listeners={stock_updated:[],sale_completed:[],admin_sale_completed:[],product_created:[],product_updated:[],product_deleted:[],heartbeat:[],initial:[],error:[]},this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=3e3,this.isManualClose=!1}connect(s,a){return new Promise((n,r)=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){n();return}if(!s){r(new Error("No token provided for WebSocket connection"));return}const o=`${xp()}/ws`;try{this.ws=new WebSocket(o),this.ws.onopen=()=>{console.log("âœ… WebSocket connected for real-time updates"),this.reconnectAttempts=0,this.ws.send(JSON.stringify({token:s})),console.log("ðŸ” Authentication sent"),n()},this.ws.onmessage=i=>{try{const l=JSON.parse(i.data),c=l.type?l.type.toLowerCase():"unknown";if(c==="connected"){console.log("âœ… WebSocket authenticated:",l.account_id);return}c==="stock_updated"?(console.log("ðŸ“¦ Stock update received:",l.data),a&&a(l.data),this.emit("stock_updated",l.data)):c==="sale_completed"?(console.log("ðŸ’° Sale completed - stock deducted:",l.data),this.emit("sale_completed",l.data),a&&l.data.updatedProducts&&a({allProducts:l.data.updatedProducts})):c==="admin_sale_completed"?(console.log("ðŸ‘¨â€ðŸ’¼ Admin sale completed:",l.data),this.emit("admin_sale_completed",l.data),this.emit("sale_completed",l.data),a&&l.data.updatedProducts&&a({allProducts:l.data.updatedProducts})):c==="product_created"?(console.log("âœ¨ Product created:",l.data),this.emit("product_created",l.data)):c==="product_updated"?(console.log("ðŸ“ Product updated:",l.data),this.emit("product_updated",l.data),a&&l.data.allProducts&&a({allProducts:l.data.allProducts})):c==="product_deleted"?(console.log("ðŸ—‘ï¸ Product deleted:",l.data),this.emit("product_deleted",l.data),a&&l.data.allProducts&&a({allProducts:l.data.allProducts})):c==="initial"?(console.log("ðŸ“¦ Initial products loaded via WebSocket"),this.emit("initial",l.products)):c==="heartbeat"?this.emit("heartbeat",l):(console.log(`ðŸ“¨ Message received (${c}):`,l.data),c!=="unknown"&&this.emit(c,l.data))}catch(l){console.error("Error parsing WebSocket message:",l)}},this.ws.onerror=i=>{console.error("âŒ WebSocket error:",i),this.emit("error",i),r(i)},this.ws.onclose=()=>{console.log("ðŸ”Œ WebSocket disconnected"),this.isManualClose||this.attemptReconnect(s,a)}}catch(i){console.error("Failed to create WebSocket:",i),r(i)}})}attemptReconnect(s,a){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.log("Max reconnection attempts reached");return}this.reconnectAttempts++;const n=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);console.log(`ðŸ”„ Reconnecting in ${n}ms (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.connect(s,a).catch(r=>{console.error("Reconnection failed:",r)})},n)}on(s,a){this.listeners[s]||(this.listeners[s]=[]),this.listeners[s].push(a)}emit(s,a){this.listeners[s]&&this.listeners[s].forEach(n=>{try{n(a)}catch(r){console.error(`Error in ${s} listener:`,r)}})}disconnect(){this.isManualClose=!0,this.ws&&(this.ws.close(),this.ws=null)}isConnected(){return this.ws&&this.ws.readyState===WebSocket.OPEN}}const nt=new pp;function fp(){const{user:t,isUltraPackage:s,isRealTimeProductSyncEnabled:a}=re(),{products:n,refreshProducts:r}=vn(),[o,i]=h.useState([]),[l,c]=h.useState([]),[d,u]=h.useState(!1),[x,m]=h.useState("all"),[b,f]=h.useState(""),[y,g]=h.useState(!1),[p,v]=h.useState(!1),[j,S]=h.useState(!1),[P,T]=h.useState(!1),[M,N]=h.useState(null),[A,L]=h.useState({}),[E,F]=h.useState({weight:"",price:""}),[te,ye]=h.useState(null),[we,Be]=h.useState(null),[ue,de]=h.useState(!1),[oe,ve]=h.useState(null),[D,K]=h.useState(""),[q,J]=h.useState({name:"",price:"",cost:"",category:"finished",unit:"pcs",expenseOnly:!1,image:"",visibleToCashier:!0}),[C,_]=h.useState({quantity:"",expiryDate:"",batchNumber:"",cost:""}),[O,Q]=h.useState({name:"",price:"",cost:"",quantity:"",unit:"pcs",category:"raw",expenseOnly:!1,image:"",visibleToCashier:!0}),G=async()=>{try{console.log("ðŸ“¦ Loading inventory data..."),await r();const k=await ta.getAll();c(k),console.log("âœ… Inventory data loaded")}catch(k){console.error("âŒ Failed to load data:",k),se("Failed to load inventory data","error")}};h.useEffect(()=>{d||(G(),u(!0));const k=localStorage.getItem("token");if(k){let I=null;nt.connect(k,$=>{$&&$.allProducts&&$.allProducts.length>0&&(console.log("ðŸ“¦ WebSocket stock update received:",$.allProducts.length,"products"),I&&clearTimeout(I),I=setTimeout(()=>{i(ie=>{if(ie.length===0)return $.allProducts;const U=new Map(ie.map(Z=>[Z.id,Z]));return $.allProducts.forEach(Z=>{const ce=U.get(Z.id);ce?ce.quantity!==Z.quantity&&U.set(Z.id,{...ce,quantity:Z.quantity}):U.set(Z.id,Z)}),Array.from(U.values())})},200))}).catch($=>{console.warn("WebSocket connection failed:",$)}),nt.on("sale_completed",$=>{if(console.log("ðŸ”„ Sale completed - updating inventory display:",$),$.updatedProducts&&$.updatedProducts.length>0&&(console.log(`âœ… Updating ${$.updatedProducts.length} products from sale`),i($.updatedProducts),se(`âœ… Stock updated! Sale #${$.saleId} deducted inventory`,"success")),$.lowStockWarnings&&$.lowStockWarnings.length>0){const ie=$.lowStockWarnings.map(U=>`${U.name}: ${U.current} left`).join(", ");se(`âš ï¸ Low stock alert: ${ie}`,"warning")}}),nt.on("stock_updated",$=>{console.log("ðŸ“¦ Stock updated via WebSocket:",$),$.product_id&&$.quantity!==void 0&&(i(ie=>ie.map(U=>U.id===$.product_id?{...U,quantity:$.quantity}:U)),se("âœ… Stock updated!","success"))})}return()=>{nt.disconnect()}},[d]),h.useEffect(()=>{n&&n.length>0&&(console.log("ðŸ“¦ Syncing from global context:",n.length,"products"),i(k=>[...k.filter($=>typeof $.id=="string"&&$.id.startsWith("temp-")),...n]))},[n]);const he=(k,I=!0)=>{const $=k.target.files[0];if($){if($.size>2*1024*1024){se("Image must be smaller than 2MB","error");return}const ie=new FileReader;ie.onload=U=>{const Z=U.target.result;K(Z),I?J({...q,image:Z}):(Q({...O,image:Z}),O.id&&setTimeout(async()=>{try{await Ie.update(O.id,{image:Z}),se("âœ… Image saved","success")}catch(ce){console.error("Failed to save image:",ce)}},500))},ie.readAsDataURL($)}},pe=k=>l.filter(I=>I.productId===k&&I.quantity>0),se=(k,I="success")=>{Be({message:k,type:I}),setTimeout(()=>Be(null),5e3)},mt=async k=>{k.preventDefault();try{const I={...q,price:parseFloat(q.price),cost:parseFloat(q.cost||0),quantity:0,visibleToCashier:!q.expenseOnly&&q.visibleToCashier!==!1},$=`temp-${Date.now()}`,ie={...I,id:$,created_at:new Date().toISOString()};i(U=>[...U,ie]),J({name:"",price:"",cost:"",category:"finished",unit:"pcs",expenseOnly:!1,image:"",visibleToCashier:!0}),K(""),g(!1),se("âš¡ Adding product...","info");try{const U=await Ie.create(I);i(Z=>Z.map(ce=>ce.id===$?U:ce)),se(`âœ… Product "${U.name}" added successfully! ${U.visibleToCashier?"Cashiers can now see this product.":"This product is hidden from cashiers."}`,"success"),window.dispatchEvent(new CustomEvent("productCreated",{detail:{product:U,timestamp:new Date().toISOString()}})),window.dispatchEvent(new CustomEvent("stock_updated",{detail:{productId:U.id,quantity:U.quantity||0,product:U,timestamp:Date.now()}})),G().catch(Z=>console.warn("Background refresh failed:",Z))}catch(U){throw i(Z=>Z.filter(ce=>ce.id!==$)),U}}catch(I){console.error("Failed to create product:",I),se(`âŒ Failed to add product: ${I.message||"Unknown error"}`,"error")}},vt=async k=>{k.preventDefault(),console.log("ðŸ“¦ handleAddStock called - Form submitted"),console.log("ðŸ“¦ newStock:",C),console.log("ðŸ“¦ selectedProduct:",M);try{const I=parseInt(C.quantity);if(!I||I<=0){se("âš ï¸ Please enter a valid quantity","warning"),console.log("âš ï¸ Invalid quantity:",I);return}console.log("âœ… Adding",I,"units to",M.name);const $=o.find(U=>U.id===M.id);if($){const U=($.quantity||0)+I;i(Z=>Z.map(ce=>ce.id===M.id?{...ce,quantity:U}:ce))}const ie={id:`batch-${Date.now()}`,productId:M.id,quantity:I,expiryDate:C.expiryDate,batchNumber:C.batchNumber||`BATCH-${Date.now()}`,cost:parseFloat(C.cost||M.cost||0)};c(U=>[...U,ie]),se("âš¡ Adding stock...","info");try{const U=await ta.create({productId:M.id,quantity:I,expiryDate:C.expiryDate,batchNumber:C.batchNumber||`BATCH-${Date.now()}`,cost:parseFloat(C.cost||M.cost||0)});console.log("âœ… Stock added successfully:",U),await r(),window.dispatchEvent(new CustomEvent("stock_updated",{detail:{productId:M.id,quantity:I,timestamp:Date.now()}})),_({quantity:"",expiryDate:"",batchNumber:"",cost:""}),S(!1),se(`âœ… Stock added! ${M.name} quantity increased by ${I}`,"success")}catch(U){throw $&&i(Z=>Z.map(ce=>ce.id===M.id?$:ce)),c(Z=>Z.filter(ce=>ce.id!==ie.id)),U}finally{N(null)}}catch(I){console.error("Failed to add stock:",I),se(`âŒ Failed to add stock: ${I.message||"Unknown error"}`,"error")}},ya=async k=>{k.preventDefault();try{const I=o.find(U=>U.id===O.id);if(parseFloat(O.price)<I.price){alert("You cannot lower prices, only increase.");return}const $={...O,price:parseFloat(O.price),cost:parseFloat(O.cost),quantity:I.quantity},ie={...I,...$};i(U=>U.map(Z=>Z.id===O.id?ie:Z)),de(!0),se("âš¡ Updating product...","info");try{const U=await Ie.update(O.id,$);U&&U.id&&(i(Z=>Z.map(ce=>ce.id===O.id?U:ce)),console.log("âœ… Product updated with backend response:",U)),v(!1),window.dispatchEvent(new CustomEvent("productUpdated",{detail:{product:U,originalProduct:I,timestamp:new Date().toISOString(),type:"update"}})),window.dispatchEvent(new CustomEvent("stock_updated",{detail:{productId:U.id,quantity:U.quantity,product:U,timestamp:Date.now()}})),a()?se("âœ… Product updated and synced!","success"):se("âœ… Product updated successfully!","success"),ve(new Date)}catch(U){throw i(Z=>Z.map(ce=>ce.id===O.id?I:ce)),U}finally{de(!1)}}catch(I){console.error("Failed to update product:",I),se(`âŒ Update failed: ${I.message||"Unknown error"}`,"error")}},It=async k=>{try{if(!confirm("Are you sure you want to delete this product? This action cannot be undone."))return;const I=o.find(ie=>ie.id===k),$=await Ie.delete(k);if(i(ie=>ie.filter(U=>U.id!==k)),a()&&I)de(!0),window.dispatchEvent(new CustomEvent("productDeleted",{detail:{product:I,timestamp:new Date().toISOString(),type:"delete"}})),se(`ðŸ“¡ Product "${I.name}" deleted and synced to all dashboards!`,"success"),ve(new Date),setTimeout(()=>{de(!1)},3e3);else{const ie=$?.message||"Product deleted successfully!";alert(ie)}await r()}catch(I){console.error("Failed to delete product:",I);let $="Failed to delete product";I.message.includes("Failed to execute")||I.message.includes("JSON")?$="Network error. Please check your connection and try again.":I.message.includes("401")||I.message.includes("unauthorized")?$="You are not authorized to delete this product.":I.message.includes("404")||I.message.includes("not found")?$="Product not found. It may have been deleted already.":I.message&&($=`Failed to delete product: ${I.message}`),alert($)}},ks=(o||[]).filter(k=>{if(!k)return!1;const I=k.name?.toLowerCase().includes(b.toLowerCase()),$=x==="all"||x==="raw"&&!k.recipe||x==="composite"&&k.recipe||x==="expense"&&k.expenseOnly||x==="low-stock"&&k.quantity<10;return I&&$}),Nt=(o||[]).filter(k=>k&&!k.recipe&&!k.expenseOnly),Rt=(o||[]).filter(k=>k&&k.recipe),Lt=(o||[]).filter(k=>k&&k.expenseOnly),Xt=k=>{if(!k||!k.recipe)return 0;let I=1/0;return(k.recipe||[]).forEach($=>{if(!$)return;const ie=(o||[]).find(U=>U&&U.id===$.productId);if(ie&&ie.quantity>0&&$.quantity>0){const U=Math.floor(ie.quantity/$.quantity);I=Math.min(I,U)}}),I===1/0?0:I},Cs=k=>{if(!k)return 0;if(!k.recipe)return k.cost||0;let I=0;return(k.recipe||[]).forEach($=>{if(!$)return;const ie=(o||[]).find(U=>U&&U.id===$.productId);if(ie&&ie.quantity>0){const U=(ie.cost||0)/ie.quantity;I+=U*($.quantity||0)}}),I},er=async k=>{N(k);try{const I=await Ie.getWeightPricing(k.id);L(I.weightPricing||{})}catch(I){console.error("Failed to load weight pricing:",I),L({})}T(!0)},Ps=async k=>{if(k.preventDefault(),!E.weight||!E.price){se("âŒ Please enter both weight and price","error");return}try{const I=parseFloat(E.weight),$=parseFloat(E.price);if(I*10%1!==0){se("âŒ Weight must be in 0.1kg increments (0.1, 0.2, 0.3, etc)","error");return}await Ie.addWeightPrice(M.id,I,$),L({...A,[String(I)]:$}),F({weight:"",price:""}),se(`âœ… Weight price added for ${I}kg`,"success")}catch(I){se(`âŒ Failed to add weight price: ${I.message}`,"error")}},tr=async k=>{if(confirm(`Delete pricing for ${k}kg?`))try{await Ie.deleteWeightPrice(M.id,k);const I={...A};delete I[String(k)],L(I),se(`âœ… Weight price for ${k}kg deleted`,"success")}catch(I){se(`âŒ Failed to delete weight price: ${I.message}`,"error")}};return e.jsxs("div",{className:"p-6 space-y-6",children:[we&&e.jsx("div",{className:`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-md ${we.type==="success"?"bg-green-50 border border-green-200 text-green-800":we.type==="error"?"bg-red-50 border border-red-200 text-red-800":"bg-blue-50 border border-blue-200 text-blue-800"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:we.message}),e.jsx("button",{onClick:()=>Be(null),className:"ml-2 text-gray-400 hover:text-gray-600",children:"Ã—"})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"input pl-10 w-80",value:b,onChange:k=>f(k.target.value)})]}),e.jsxs("select",{value:x,onChange:k=>m(k.target.value),className:"input w-40",children:[e.jsx("option",{value:"all",children:"All Products"}),e.jsx("option",{value:"raw",children:"Raw Materials"}),e.jsx("option",{value:"composite",children:"Composite"}),e.jsx("option",{value:"expense",children:"Expense Only"}),e.jsx("option",{value:"low-stock",children:"Low Stock"})]})]}),e.jsxs("button",{onClick:()=>g(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Product"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-700 mb-2",children:"Raw Materials"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:Nt.length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsx("h4",{className:"text-sm font-medium text-purple-700 mb-2",children:"Composite Products"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:Rt.length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-700 mb-2",children:"Expense Items"}),e.jsx("p",{className:"text-3xl font-bold text-orange-900",children:Lt.length})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Image"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Product Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Cost/COGS"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Batches"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Max Units"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Margin"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:(ks||[]).map(k=>{if(!k)return null;const I=Cs(k),$=k.price?((k.price-I)/k.price*100).toFixed(1):0,ie=Xt(k),U=te===k.id;return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-4 py-3",children:[k.image?e.jsx("img",{src:k.image,alt:k.name,className:"w-12 h-12 object-cover rounded-lg",onError:Z=>{Z.target.style.display="none",Z.target.nextSibling.style.display="flex"}}):null,e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center",style:{display:k.image?"none":"flex"},children:e.jsx("span",{className:"text-xs text-gray-400",children:"No Image"})})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[k.recipe&&e.jsx("button",{onClick:()=>ye(U?null:k.id),className:"p-1 hover:bg-gray-200 rounded",children:U?e.jsx(xc,{className:"w-4 h-4"}):e.jsx(pc,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-medium",children:k.name}),k.quantity<10&&!k.recipe&&e.jsx(qt,{className:"w-4 h-4 text-orange-500"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`badge ${k.expenseOnly?"badge-warning":k.recipe?"badge-success":"bg-blue-100 text-blue-800"}`,children:k.expenseOnly?"Expense":k.recipe?"Composite":"Raw"})}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-green-600",children:["KSH ",k.price?.toLocaleString()]}),e.jsxs("td",{className:"px-4 py-3 text-orange-600",children:["KSH ",I.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`font-medium ${(k.quantity||0)===0?"text-red-600":(k.quantity||0)<10?"text-yellow-600":"text-gray-900"}`,children:[k.quantity||0," ",k.unit]}),(k.quantity||0)<10&&(k.quantity||0)>0&&e.jsx(qt,{className:"w-4 h-4 text-yellow-500"}),(k.quantity||0)===0&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full font-medium",children:"Out of Stock"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-600",children:[pe(k.id).length," active"]}),e.jsx("button",{onClick:()=>{console.log("ðŸ”µ Add Stock clicked for product:",k.name,k.id),N(k),S(!0),console.log("ðŸ”µ Modal state set - showAddStock: true, selectedProduct:",k.name)},className:"p-1 hover:bg-blue-50 rounded text-blue-600 transition-colors",title:"Add Stock",children:e.jsx(ge,{className:"w-3 h-3"})})]})}),e.jsx("td",{className:"px-4 py-3",children:k.recipe?e.jsxs("span",{className:"font-semibold text-blue-600",children:[ie," units"]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:`font-semibold ${$>30?"text-green-600":$>15?"text-yellow-600":"text-red-600"}`,children:[$,"%"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>er(k),className:"p-2 hover:bg-purple-50 rounded-lg text-purple-600 transition-colors",title:"Edit weight-based pricing",children:e.jsx(De,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{Q(k),v(!0)},className:"p-2 hover:bg-blue-50 rounded-lg text-blue-600 transition-colors",children:e.jsx(Et,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>It(k.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-600 transition-colors",children:e.jsx(ze,{className:"w-4 h-4"})})]})})]},k.id),U&&k.recipe&&e.jsx("tr",{className:"bg-blue-50",children:e.jsx("td",{colSpan:"9",className:"px-4 py-4",children:e.jsxs("div",{className:"ml-8",children:[e.jsx("h4",{className:"font-semibold text-sm text-gray-700 mb-3",children:"Recipe Breakdown:"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Ingredient"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Quantity Needed"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Available"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Unit Cost"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-600",children:"Total Cost"})]})}),e.jsx("tbody",{children:(k.recipe||[]).map((Z,ce)=>{if(!Z)return null;const lt=(o||[]).find(As=>As&&As.id===Z.productId);if(!lt)return null;const Ts=(lt.cost||0)/(lt.quantity||1),st=Ts*(Z.quantity||0);return e.jsxs("tr",{className:"border-t border-blue-100",children:[e.jsx("td",{className:"px-3 py-2",children:lt.name||"Unknown"}),e.jsxs("td",{className:"px-3 py-2",children:[Z.quantity||0," ",lt.unit||"pcs"]}),e.jsxs("td",{className:"px-3 py-2",children:[lt.quantity||0," ",lt.unit||"pcs"]}),e.jsxs("td",{className:"px-3 py-2",children:["KSH ",Ts.toFixed(2)]}),e.jsxs("td",{className:"px-3 py-2 font-semibold",children:["KSH ",st.toFixed(2)]})]},ce)})}),e.jsx("tfoot",{className:"bg-white font-semibold",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",className:"px-3 py-2 text-right",children:"Total COGS per unit:"}),e.jsxs("td",{className:"px-3 py-2 text-orange-600",children:["KSH ",I.toFixed(2)]})]})})]})]})})})]})})})]})})}),j&&M&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:k=>{k.target===k.currentTarget&&(S(!1),N(null))},children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4 text-gray-900",children:["Add Stock for ",M.name]}),e.jsxs("form",{onSubmit:vt,className:"space-y-4",children:[e.jsx("input",{type:"number",placeholder:"Quantity",className:"input",value:C.quantity,onChange:k=>_({...C,quantity:k.target.value}),required:!0}),e.jsx("input",{type:"date",placeholder:"Expiry Date (Optional)",className:"input",value:C.expiryDate,onChange:k=>_({...C,expiryDate:k.target.value})}),e.jsx("input",{type:"text",placeholder:"Batch Number (Optional)",className:"input",value:C.batchNumber,onChange:k=>_({...C,batchNumber:k.target.value})}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Cost per Unit",className:"input",value:C.cost,onChange:k=>_({...C,cost:k.target.value})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Stock"}),e.jsx("button",{type:"button",onClick:()=>{S(!1),N(null),_({quantity:"",expiryDate:"",batchNumber:"",cost:""})},className:"btn-secondary",children:"Cancel"})]})]})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add New Product"}),e.jsxs("form",{onSubmit:mt,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name",className:"input",value:q.name,onChange:k=>J({...q,name:k.target.value}),required:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Product Image"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:k=>he(k,!0),className:"input"}),e.jsx(zi,{className:"w-5 h-5 text-gray-400"})]}),(D||q.image)&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:D||q.image,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"Price",className:"input",value:q.price,onChange:k=>J({...q,price:k.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Cost",className:"input",value:q.cost,onChange:k=>J({...q,cost:k.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("select",{className:"input",value:q.category,onChange:k=>J({...q,category:k.target.value}),children:[e.jsx("option",{value:"finished",children:"Finished Product"}),e.jsx("option",{value:"raw",children:"Raw Material"}),e.jsx("option",{value:"service",children:"Service"})]}),e.jsxs("select",{className:"input",value:q.unit,onChange:k=>J({...q,unit:k.target.value}),children:[e.jsx("option",{value:"pcs",children:"Pieces"}),e.jsx("option",{value:"kg",children:"Kilograms"}),e.jsx("option",{value:"L",children:"Liters"}),e.jsx("option",{value:"g",children:"Grams"}),e.jsx("option",{value:"ml",children:"Milliliters"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:q.expenseOnly,onChange:k=>J({...q,expenseOnly:k.target.checked,visibleToCashier:!k.target.checked})}),e.jsx("span",{className:"text-sm",children:"Expense Only (Hidden from cashier)"})]}),!q.expenseOnly&&e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:q.visibleToCashier,onChange:k=>J({...q,visibleToCashier:k.target.checked})}),e.jsx("span",{className:"text-sm",children:"Visible to Cashier"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Product"}),e.jsx("button",{type:"button",onClick:()=>{g(!1),K(""),J({name:"",price:"",cost:"",category:"finished",unit:"pcs",expenseOnly:!1,image:"",visibleToCashier:!0})},className:"btn-secondary",children:"Cancel"})]})]})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Edit Product"}),e.jsxs("form",{onSubmit:ya,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name",className:"input",value:O.name,onChange:k=>Q({...O,name:k.target.value}),required:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Product Image"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",placeholder:"Image URL",className:"input flex-1",value:O.image||"",onChange:k=>Q({...O,image:k.target.value})}),e.jsx("span",{className:"text-sm text-gray-500 self-center",children:"or"}),e.jsx("input",{type:"file",accept:"image/*",className:"input flex-1",onChange:k=>{const I=k.target.files[0];if(I){const $=new FileReader;$.onloadend=()=>{Q({...O,image:$.result})},$.readAsDataURL(I)}}})]}),O.image&&e.jsx("img",{src:O.image,alt:"Preview",className:"w-20 h-20 object-cover rounded"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"Price",className:"input",value:O.price||"",onChange:k=>Q({...O,price:k.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Cost",className:"input",value:O.cost||"",onChange:k=>Q({...O,cost:k.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"Quantity",className:"input bg-gray-100 cursor-not-allowed",value:O.quantity||"",readOnly:!0,disabled:!0,title:"Use 'Add Stock' button to update quantity"}),e.jsx("span",{className:"absolute right-3 top-3 text-xs text-gray-500",children:"Read-only"})]}),e.jsxs("select",{className:"input",value:O.unit||"pcs",onChange:k=>Q({...O,unit:k.target.value}),children:[e.jsx("option",{value:"pcs",children:"Pieces"}),e.jsx("option",{value:"kg",children:"Kilograms"}),e.jsx("option",{value:"L",children:"Liters"}),e.jsx("option",{value:"g",children:"Grams"}),e.jsx("option",{value:"ml",children:"Milliliters"})]})]}),e.jsxs("select",{className:"input",value:O.category||"raw",onChange:k=>Q({...O,category:k.target.value}),children:[e.jsx("option",{value:"raw",children:"Raw Material"}),e.jsx("option",{value:"finished",children:"Finished Product"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:O.expenseOnly||!1,onChange:k=>Q({...O,expenseOnly:k.target.checked,visibleToCashier:!k.target.checked})}),e.jsx("span",{className:"text-sm",children:"Expense Only (Hidden from cashier)"})]}),!O.expenseOnly&&e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:O.visibleToCashier!==!1,onChange:k=>Q({...O,visibleToCashier:k.target.checked})}),e.jsx("span",{className:"text-sm",children:"Visible to Cashier"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Update Product"}),e.jsx("button",{type:"button",onClick:()=>v(!1),className:"btn-secondary",children:"Cancel"})]})]})]})}),P&&M&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-96 overflow-y-auto",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Weight-Based Pricing - ",M.name]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Set different prices for different weights (in 0.1kg increments)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[e.jsx("h4",{className:"font-semibold text-sm text-gray-700",children:"Add New Weight Price"}),e.jsxs("form",{onSubmit:Ps,className:"flex gap-3",children:[e.jsx("input",{type:"number",step:"0.1",min:"0.1",placeholder:"Weight (kg) - e.g., 0.1, 0.5, 1.0",className:"input flex-1",value:E.weight,onChange:k=>F({...E,weight:k.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",min:"0",placeholder:"Price (KSH)",className:"input flex-1",value:E.price,onChange:k=>F({...E,price:k.target.value}),required:!0}),e.jsx("button",{type:"submit",className:"btn-primary whitespace-nowrap",children:"Add Price"})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-sm text-gray-700 mb-3",children:"Current Prices"}),Object.keys(A).length>0?e.jsx("div",{className:"space-y-2",children:Object.entries(A).sort(([k],[I])=>parseFloat(k)-parseFloat(I)).map(([k,I])=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("span",{className:"font-medium",children:[k," kg"]}),e.jsxs("span",{className:"text-gray-600 ml-4",children:["KSH ",parseFloat(I).toLocaleString()]})]}),e.jsx("button",{onClick:()=>tr(k),className:"text-red-600 hover:bg-red-50 px-3 py-1 rounded text-sm font-medium transition-colors",children:"Delete"})]},k))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No weight-based pricing set. Add one above."})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Base price:"})," KSH ",M.price?.toLocaleString()]})})]}),e.jsx("div",{className:"flex gap-2 mt-6",children:e.jsx("button",{onClick:()=>{T(!1),N(null),L({}),F({weight:"",price:""})},className:"btn-secondary flex-1",children:"Done"})})]})})]})}function gp(){const[t,s]=h.useState([]),[a,n]=h.useState([]),[r,o]=h.useState(!1),[i,l]=h.useState({name:"",price:"",ingredients:[],image:"",visibleToCashier:!0});h.useEffect(()=>{c()},[]);const c=async()=>{const y=await Ie.getAll();s(y),n(y.filter(g=>!g.recipe))},d=()=>{l({...i,ingredients:[...i.ingredients,{name:"",quantity:"",unit:"pcs"}]})},u=(y,g,p)=>{const v=[...i.ingredients];v[y][g]=p,l({...i,ingredients:v})},x=y=>{l({...i,ingredients:i.ingredients.filter((g,p)=>p!==y)})},m=()=>i.ingredients.reduce((y,g)=>{const p=a.find(v=>v.name.toLowerCase()===g.name.toLowerCase());if(p&&g.quantity){const v=p.cost/p.quantity;return y+v*parseFloat(g.quantity)}return y},0),b=async y=>{y.preventDefault();const g=[];for(const v of i.ingredients){if(!v.name||!v.quantity)continue;const j=a.find(S=>S.name.toLowerCase()===v.name.toLowerCase());j?g.push({productId:j.id,quantity:parseFloat(v.quantity),unit:v.unit||"pcs"}):g.push({name:v.name,quantity:parseFloat(v.quantity),unit:v.unit||"pcs"})}if(g.length===0){alert("Please add at least one ingredient");return}const p=m();try{await Ie.create({name:i.name,price:parseFloat(i.price),cost:p,quantity:0,unit:"pcs",category:"composite",recipe:g,image:i.image||"",visibleToCashier:i.visibleToCashier,expenseOnly:!1}),l({name:"",price:"",ingredients:[],image:"",visibleToCashier:!0}),o(!1),c(),alert("Recipe created successfully!")}catch(v){console.error("Error creating recipe:",v),alert("Failed to create recipe. Please try again.")}},f=t.filter(y=>y.recipe);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Recipe & BOM Builder"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create composite products with ingredient recipes"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Create Recipe"]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-blue-50 to-purple-50 border-blue-200",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"ðŸ’¡ How it works"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Create composite products by defining recipes with raw ingredients. When a composite product is sold, the system automatically deducts the required quantities from raw materials and calculates COGS."}),e.jsxs("div",{className:"mt-3 p-3 bg-white rounded-lg text-sm",children:[e.jsx("strong",{children:"Example: Fish Fingers"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-gray-700",children:[e.jsx("li",{children:"â€¢ 0.02 kg Nile Perch"}),e.jsx("li",{children:"â€¢ 0.01 L Cooking Oil"}),e.jsx("li",{children:"â€¢ 0.004 kg Breadcrumbs"}),e.jsx("li",{children:"â€¢ 0.002 kg Salt"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:["Existing Recipes (",f.length,")"]}),f.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No recipes created yet"})}):e.jsx("div",{className:"space-y-4",children:f.map(y=>{const g=y.recipe.reduce((v,j)=>{if(j.productId){const S=t.find(P=>P.id===j.productId);if(S){const P=S.cost/S.quantity;return v+P*j.quantity}}else if(j.name){const S=t.find(P=>P.name.toLowerCase()===j.name.toLowerCase());if(S){const P=S.cost/S.quantity;return v+P*j.quantity}}return v},0),p=((y.price-g)/y.price*100).toFixed(1);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-lg",children:y.name}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm",children:[e.jsxs("span",{className:"text-green-600 font-semibold",children:["Price: KSH ",y.price]}),e.jsxs("span",{className:"text-orange-600",children:["COGS: KSH ",g.toFixed(2)]}),e.jsxs("span",{className:`font-semibold ${p>30?"text-green-600":"text-yellow-600"}`,children:["Margin: ",p,"%"]})]})]}),e.jsx("button",{className:"text-red-600 hover:bg-red-50 p-2 rounded-lg",children:e.jsx(ze,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-2",children:"INGREDIENTS:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:y.recipe.map((v,j)=>{let S="",P=v.unit||"pcs";if(v.productId){const T=t.find(M=>M.id===v.productId);T&&(S=T.name,P=T.unit)}else v.name&&(S=v.name,P=v.unit||"pcs");return S?e.jsxs("div",{className:"text-sm flex items-center justify-between bg-white px-3 py-2 rounded",children:[e.jsx("span",{children:S}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[v.quantity," ",P]})]},j):null})})]})]},y.id)})})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Create New Recipe"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name (e.g., Fish Fingers)",className:"input",value:i.name,onChange:y=>l({...i,name:y.target.value}),required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("input",{type:"number",step:"0.01",placeholder:"Selling Price",className:"input",value:i.price,onChange:y=>l({...i,price:y.target.value}),required:!0}),e.jsx("input",{type:"url",placeholder:"Image URL (optional)",className:"input",value:i.image,onChange:y=>l({...i,image:y.target.value})})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.visibleToCashier,onChange:y=>l({...i,visibleToCashier:y.target.checked})}),e.jsx("span",{className:"text-sm",children:"Visible to Cashier"})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-semibold",children:"Ingredients"}),e.jsx("button",{type:"button",onClick:d,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"+ Add Ingredient"})]}),e.jsx("div",{className:"space-y-3",children:i.ingredients.map((y,g)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",placeholder:"Ingredient name (e.g., Nile Perch)",className:"input flex-1",value:y.name,onChange:p=>u(g,"name",p.target.value),required:!0,list:`ingredients-list-${g}`}),e.jsx("datalist",{id:`ingredients-list-${g}`,children:a.map(p=>e.jsxs("option",{value:p.name,children:[p.name," (",p.quantity," ",p.unit," available)"]},p.id))}),e.jsx("input",{type:"number",step:"0.001",placeholder:"Qty",className:"input w-32",value:y.quantity,onChange:p=>u(g,"quantity",p.target.value),required:!0}),e.jsxs("select",{className:"input w-24",value:y.unit,onChange:p=>u(g,"unit",p.target.value),children:[e.jsx("option",{value:"pcs",children:"pcs"}),e.jsx("option",{value:"kg",children:"kg"}),e.jsx("option",{value:"g",children:"g"}),e.jsx("option",{value:"L",children:"L"}),e.jsx("option",{value:"ml",children:"ml"})]}),e.jsx("button",{type:"button",onClick:()=>x(g),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:e.jsx(ze,{className:"w-4 h-4"})})]},g))}),i.ingredients.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:'No ingredients added yet. Click "Add Ingredient" to start.'})]}),i.ingredients.length>0&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Estimated COGS:"}),e.jsxs("span",{className:"text-lg font-bold text-orange-600",children:["KSH ",m().toFixed(2)]})]}),i.price&&e.jsxs("div",{className:"flex items-center justify-between text-sm mt-2",children:[e.jsx("span",{className:"font-medium",children:"Profit Margin:"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:[((parseFloat(i.price)-m())/parseFloat(i.price)*100).toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsxs("button",{type:"submit",className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[e.jsx(fc,{className:"w-4 h-4"}),"Create Recipe"]}),e.jsx("button",{type:"button",onClick:()=>{o(!1),l({name:"",price:"",ingredients:[]})},className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function bp(){const[t,s]=h.useState([]),[a,n]=h.useState("all"),[r,o]=h.useState([]),[i,l]=h.useState(!1);h.useEffect(()=>{c()},[]);const c=async()=>{const g=await ma.getAll();s(g.reverse())},d=async g=>{if(window.confirm("Delete this sale? This action cannot be undone."))try{l(!0);const p=localStorage.getItem("token");if(!(await fetch(`${ee}/sales/${g}`,{method:"DELETE",headers:{Authorization:`Bearer ${p}`}})).ok)throw new Error("Failed to delete sale");s(t.filter(j=>j.id!==g)),alert("Sale deleted successfully")}catch(p){alert("Failed to delete sale: "+p.message)}finally{l(!1)}},u=async()=>{if(r.length===0){alert("No sales selected");return}if(window.confirm(`Delete ${r.length} sales? This action cannot be undone.`))try{l(!0);const g=localStorage.getItem("token");if(!(await fetch(`${ee}/sales/bulk-delete`,{method:"POST",headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"},body:JSON.stringify({saleIds:r})})).ok)throw new Error("Failed to delete sales");s(t.filter(v=>!r.includes(v.id))),o([]),alert("Sales deleted successfully")}catch(g){alert("Failed to delete sales: "+g.message)}finally{l(!1)}},x=async()=>{if(window.confirm("Clear ALL sales data? This will delete everything and cannot be undone."))try{l(!0);const g=localStorage.getItem("token");if(!(await fetch(`${ee}/clear-data`,{method:"POST",headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"},body:JSON.stringify({type:"sales"})})).ok)throw new Error("Failed to clear sales");s([]),o([]),alert("All sales data cleared")}catch(g){alert("Failed to clear sales: "+g.message)}finally{l(!1)}},m=t.filter(g=>{if(a==="today")return new Date(g.createdAt).toDateString()===new Date().toDateString();if(a==="week"){const p=new Date;return p.setDate(p.getDate()-7),new Date(g.createdAt)>=p}return!0}),b=m.reduce((g,p)=>g+p.total,0),f=m.reduce((g,p)=>g+(p.cogs||0),0),y=b-f;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("select",{value:a,onChange:g=>n(g.target.value),className:"input w-40",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"})]}),r.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[r.length," selected"]}),e.jsxs("button",{onClick:u,disabled:i,className:"px-3 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white rounded text-sm font-medium flex items-center gap-1",children:[e.jsx(ze,{className:"w-4 h-4"}),"Delete Selected"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:x,disabled:i||t.length===0,className:"px-4 py-2 bg-red-700 hover:bg-red-800 disabled:bg-gray-400 text-white rounded font-medium flex items-center gap-2",children:[e.jsx(Wi,{className:"w-4 h-4"}),"Clear All Sales"]}),e.jsxs("button",{className:"btn-secondary flex items-center gap-2",children:[e.jsx(qi,{className:"w-4 h-4"}),"Export"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-emerald-600 text-white",children:[e.jsx("p",{className:"text-sm text-green-100 mb-1",children:"Total Sales"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",b.toLocaleString()]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-orange-500 to-red-600 text-white",children:[e.jsx("p",{className:"text-sm text-orange-100 mb-1",children:"Total COGS"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",f.toLocaleString()]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-indigo-600 text-white",children:[e.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Total Profit"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",y.toLocaleString()]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sales History"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:r.length===m.length&&m.length>0,onChange:g=>{g.target.checked?o(m.map(p=>p.id)):o([])},className:"rounded"})}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"COGS"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Profit"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Action"})]})}),e.jsx("tbody",{children:m.map(g=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"checkbox",checked:r.includes(g.id),onChange:p=>{p.target.checked?o([...r,g.id]):o(r.filter(v=>v!==g.id))},className:"rounded"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-medium",children:["#",g.id]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(g.createdAt).toLocaleString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[g.items?.length||0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:g.paymentMethod})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",g.total?.toLocaleString()]}),e.jsxs("td",{className:"px-4 py-3 text-sm text-orange-600",children:["KSH ",g.cogs?.toLocaleString()||0]}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-blue-600",children:["KSH ",g.profit?.toLocaleString()||0]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("button",{onClick:()=>d(g.id),disabled:i,className:"px-3 py-1 bg-red-500 hover:bg-red-600 disabled:bg-gray-400 text-white rounded text-sm font-medium flex items-center gap-1",children:[e.jsx(ze,{className:"w-4 h-4"}),"Delete"]})})]},g.id))})]})})]})]})}function yp(){const[t,s]=h.useState([]),[a,n]=h.useState(!1),[r,o]=h.useState({description:"",amount:"",category:"general"}),[i,l]=h.useState(null);h.useEffect(()=>{d();const f=localStorage.getItem("token");return f&&(nt.connect(f).catch(y=>{console.warn("WebSocket connection failed:",y)}),nt.on("sale_completed",y=>{console.log("ðŸ’° Sale completed - updating expenses:",y),d(),y.saleId&&c(`âœ… Expenses updated from Sale #${y.saleId}`,"success")})),()=>{nt.disconnect()}},[]);const c=(f,y)=>{l({message:f,type:y}),setTimeout(()=>l(null),3e3)},d=async()=>{const f=await ea.getAll();s(f.reverse())},u=async f=>{f.preventDefault();const y={...r,amount:parseFloat(r.amount)};await ea.create(y),o({description:"",amount:"",category:"general"}),n(!1),window.dispatchEvent(new CustomEvent("expense_added",{detail:{expense:y}})),d()},x=t.reduce((f,y)=>f+y.amount,0),m=t.filter(f=>!f.automatic),b=t.filter(f=>f.automatic);return e.jsxs("div",{className:"p-6 space-y-6",children:[i&&e.jsx("div",{className:`fixed top-4 right-4 p-4 rounded-lg text-white font-medium z-50 ${i.type==="success"?"bg-green-600":"bg-blue-600"}`,children:i.message}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Expense Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track manual and automatic ingredient-based expenses"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Expense"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-red-500 to-pink-600 text-white",children:[e.jsx("p",{className:"text-sm text-red-100 mb-1",children:"Total Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",x.toLocaleString()]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-indigo-600 text-white",children:[e.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Manual Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",m.reduce((f,y)=>f+y.amount,0).toLocaleString()]})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-purple-500 to-violet-600 text-white",children:[e.jsx("p",{className:"text-sm text-purple-100 mb-1",children:"Auto Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",b.reduce((f,y)=>f+y.amount,0).toLocaleString()]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Expense History"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Amount"})]})}),e.jsx("tbody",{children:t.map(f=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(f.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:f.description}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-warning",children:f.category})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`badge ${f.automatic?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:f.automatic?"Automatic":"Manual"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-red-600",children:["KSH ",f.amount?.toLocaleString()]})]},f.id))})]})})]}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add Manual Expense"}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Description",className:"input",value:r.description,onChange:f=>o({...r,description:f.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Amount",className:"input",value:r.amount,onChange:f=>o({...r,amount:f.target.value}),required:!0}),e.jsxs("select",{className:"input",value:r.category,onChange:f=>o({...r,category:f.target.value}),children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"utilities",children:"Utilities"}),e.jsx("option",{value:"rent",children:"Rent"}),e.jsx("option",{value:"salaries",children:"Salaries"}),e.jsx("option",{value:"supplies",children:"Supplies"}),e.jsx("option",{value:"other",children:"Other"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Expense"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function jp(){const{isCashierUserManagementEnabled:t,isCashier:s,user:a}=re(),[n,r]=h.useState([]),[o,i]=h.useState(!0),[l,c]=h.useState(!1),[d,u]=h.useState(null),[x,m]=h.useState(null),[b,f]=h.useState(null),[y,g]=h.useState(0),[p,v]=h.useState({name:"",email:"",password:"",businessType:"",businessRole:"cashier",permissions:{viewSales:!0,viewInventory:!0,viewExpenses:!1,manageProducts:!1}}),[j,S]=h.useState(!1),[P,T]=h.useState(null),[M,N]=h.useState(""),A=[{id:"clinic",name:"Clinic",icon:ua,roles:["doctor","reception","pharmacy","nurse"]},{id:"hotel",name:"Hotel",icon:pt,roles:["reception","housekeeping","manager"]},{id:"bar",name:"Bar/Restaurant",icon:qa,roles:["bartender","waiter","manager"]},{id:"supermarket",name:"Supermarket",icon:Ua,roles:["cashier","manager","stock_clerk"]}],L=a?.plan==="pro";h.useEffect(()=>{E()},[]),h.useEffect(()=>()=>{b?.intervalId&&clearInterval(b.intervalId)},[b]);const E=async()=>{try{i(!0);const C=await kt.getAll();r(Array.isArray(C)?C:[])}catch(C){console.error("Error loading users:",C),r([])}finally{i(!1)}},F=()=>Math.floor(1e3+Math.random()*9e3).toString(),te=async C=>{if(C.preventDefault(),console.log("Form submitted with data:",p),!p.name?.trim()||!p.email?.trim()||!p.password?.trim()){alert("Please fill in all required fields");return}if(p.password.length<6){alert("Password must be at least 6 characters long");return}try{const _=F(),O={name:p.name.trim(),email:p.email.trim().toLowerCase(),password:p.password.trim(),pin:_,...L&&p.businessType&&{businessType:p.businessType,businessRole:p.businessRole||"cashier"}};console.log("Sending user data:",O);const Q=`temp-${Date.now()}`,G={id:Q,...O,role:"cashier",is_active:!0,created_at:new Date().toISOString()};r(he=>[...he,G]),v({name:"",email:"",password:"",businessType:"",businessRole:"cashier",permissions:{viewSales:!0,viewInventory:!0,viewExpenses:!1,manageProducts:!1}}),c(!1);try{const he=await kt.create(O);console.log("User creation result:",he),r(se=>se.map(mt=>mt.id===Q?he:mt));const pe=`âœ… Cashier added successfully!

ðŸ“§ Email: ${O.email}
ðŸ”‘ Password: ${O.password}
ðŸ”¢ PIN: ${_}

ðŸ’¡ LOGIN OPTIONS:
1. Email + Password: Use email and password above
2. PIN Login: Use email + ${_}

Please share these credentials securely with the new cashier.`;alert(pe),E().catch(se=>console.warn("Background refresh failed:",se))}catch(he){throw r(pe=>pe.filter(se=>se.id!==Q)),he}}catch(_){console.error("Error creating cashier:",_);let O="Failed to add cashier";_.message.includes("Current user not found")?O="Authentication error. Please refresh the page and try again.":_.message.includes("email")?O="Email already exists. Please use a different email.":_.message.includes("network")||_.message.includes("fetch")?O="Network error. Please check your connection and try again.":_.message&&(O=`Failed to add cashier: ${_.message}`),alert(O)}},ye=async(C,_)=>{try{i(!0),await kt.update(C,{permissions:_}),await E(),u(null)}catch(O){console.error("Error updating permissions:",O),alert("Failed to update permissions: "+O.message)}finally{i(!1)}},we=async(C,_)=>{try{i(!0);const O=!_,Q=await fetch(`${ee}/users/${C}/activate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({active:O})});if(!Q.ok){const G=await Q.json().catch(()=>({error:"Network error"}));throw new Error(G.error||`HTTP ${Q.status}: ${Q.statusText}`)}await E()}catch(O){console.error("Error updating user status:",O),alert("Failed to update user status: "+O.message)}finally{i(!1)}},Be=async(C,_)=>{try{i(!0);const O=!_,Q=await fetch(`${ee}/users/${C}/lock`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({locked:O})});if(!Q.ok){const G=await Q.json().catch(()=>({error:"Network error"}));throw new Error(G.error||`HTTP ${Q.status}: ${Q.statusText}`)}await E()}catch(O){console.error("Error updating user lock status:",O),alert("Failed to update user lock status: "+O.message)}finally{i(!1)}},ue=async C=>{if(confirm("Are you sure you want to delete this user? This action cannot be undone."))try{i(!0),await kt.delete(C),await E()}catch(_){console.error("Error deleting user:",_),alert("Failed to delete user: "+_.message)}finally{i(!1)}},de=async()=>{if(window.confirm("Clear ALL users data? This will delete all users and cannot be undone."))try{i(!0);const C=localStorage.getItem("token");if(!(await fetch(`${ee}/clear-data`,{method:"POST",headers:{Authorization:`Bearer ${C}`,"Content-Type":"application/json"},body:JSON.stringify({type:"users"})})).ok)throw new Error("Failed to clear users");r([]),alert("All users data cleared")}catch(C){alert("Failed to clear users: "+C.message)}finally{i(!1)}},oe=C=>{T(C),N(F()),S(!0)},ve=async()=>{try{i(!0),await kt.update(P.id,{cashierPIN:M}),await E(),S(!1),T(null),N(""),alert(`âœ… PIN reset successfully!

ðŸ”¢ New PIN for ${P.name}: ${M}

Please share this PIN securely with the cashier.`)}catch(C){console.error("Error resetting PIN:",C),alert("Failed to reset PIN: "+C.message)}finally{i(!1)}},D=C=>{m(C),f({isActive:!1,currentCart:[],totalSalesToday:0,salesCount:0,lastActivity:"Loading..."});const _=setInterval(()=>{q(C)},3e3);f(O=>({...O,intervalId:_})),q(C)},K=()=>{b?.intervalId&&clearInterval(b.intervalId),m(null),f(null)},q=async C=>{try{const _=await ma.getAll(),Q=(Array.isArray(_)?_:[]).filter(he=>he.cashierId===C.id).sort((he,pe)=>new Date(pe.createdAt)-new Date(he.createdAt)).slice(0,10),G={isActive:Math.random()>.3,currentCart:Q.length>0?[{name:"Product A",price:150,quantity:2},{name:"Product B",price:300,quantity:1}]:[],totalSalesToday:Q.reduce((he,pe)=>he+pe.total,0),salesCount:Q.length,lastActivity:Q.length>0?new Date(Q[0].createdAt).toLocaleTimeString():"No recent activity"};f(G)}catch(_){console.error("Error loading live view data:",_)}},J=(n||[]).filter(C=>C.role==="cashier");return o&&n.length===0?e.jsx("div",{className:"p-6 space-y-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading users..."})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage cashiers and their permissions"})]}),e.jsx("div",{className:"flex items-center gap-2",children:t()&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:de,disabled:o||n.length===0,className:"px-4 py-2 bg-red-700 hover:bg-red-800 disabled:bg-gray-400 text-white rounded font-medium flex items-center gap-2",children:[e.jsx(Wi,{className:"w-4 h-4"}),"Clear All Users"]}),e.jsxs("button",{onClick:()=>c(!0),className:"btn-primary flex items-center gap-2",disabled:o,children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Cashier"]})]})})]}),s()&&!t()&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-yellow-100 flex items-center justify-center",children:e.jsx(Ve,{className:"w-4 h-4 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-yellow-800",children:"User Management Restricted"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"The admin has disabled cashier user management. You cannot add, edit, or remove users at this time."})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsx("p",{className:"text-sm text-blue-700 mb-1",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:n.length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[e.jsx("p",{className:"text-sm text-green-700 mb-1",children:"Cashiers"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:J.length})]}),e.jsxs("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[e.jsx("p",{className:"text-sm text-purple-700 mb-1",children:"Active Users"}),e.jsx("p",{className:"text-3xl font-bold text-purple-900",children:n.filter(C=>C.active).length})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Users"}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Email"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Role"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Plan"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"PIN"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:(n||[]).map(C=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:C.name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:C.email}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`badge ${C.role==="admin"?"bg-purple-100 text-purple-800":"badge-success"}`,children:C.role})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-warning",children:C.plan||"N/A"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:C.role==="cashier"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono text-lg font-bold text-blue-600 bg-blue-50 px-2 py-1 rounded",children:C.pin||C.cashierPIN||"----"}),e.jsx("button",{onClick:()=>oe(C),className:"p-1 hover:bg-yellow-50 rounded text-yellow-600",title:"Reset PIN",disabled:o,children:e.jsx(Et,{className:"w-3 h-3"})})]}):e.jsx("span",{className:"text-gray-400 text-sm",children:"N/A"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold ${C.active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:C.active?e.jsxs(e.Fragment,{children:[e.jsx(nr,{className:"w-3 h-3"}),"Active"]}):e.jsxs(e.Fragment,{children:[e.jsx(rr,{className:"w-3 h-3"}),"Inactive"]})}),C.locked&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:[e.jsx(Tt,{className:"w-3 h-3"}),"Locked"]})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[t()&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>we(C.id,C.active),className:`p-2 rounded-lg transition ${C.active?"hover:bg-red-50 text-red-600":"hover:bg-green-50 text-green-600"}`,title:C.active?"Deactivate User":"Activate User",disabled:o,children:C.active?e.jsx(rr,{className:"w-4 h-4"}):e.jsx(nr,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Be(C.id,C.locked||!1),className:`p-2 rounded-lg transition ${C.locked?"hover:bg-green-50 text-green-600":"hover:bg-red-50 text-red-600"}`,title:C.locked?"Unlock User":"Lock User",disabled:o,children:e.jsx(Tt,{className:"w-4 h-4"})})]}),C.role==="cashier"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{localStorage.setItem("adminViewingCashier",C.id),window.location.href="/cashier/pos"},className:"p-2 hover:bg-blue-50 rounded-lg text-blue-600",title:"Access Cashier POS",children:e.jsx(Hi,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>D(C),className:"p-2 hover:bg-green-50 rounded-lg text-green-600",title:"Live View",children:e.jsx(ir,{className:"w-4 h-4"})})]}),t()&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(C),className:"p-2 hover:bg-purple-50 rounded-lg text-purple-600",title:"Edit Permissions",children:e.jsx(Et,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ue(C.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-600",title:"Delete User",disabled:o,children:e.jsx(ze,{className:"w-4 h-4"})})]})]})})]},C.id))})]}),n.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No users found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Add your first cashier to get started"})]})]})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Add New Cashier"}),e.jsxs("form",{onSubmit:te,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Full Name",className:"input",value:p.name||"",onChange:C=>{console.log("Name input changed:",C.target.value),v({...p,name:C.target.value})},required:!0,disabled:o}),e.jsx("input",{type:"email",placeholder:"Email",className:"input",value:p.email||"",onChange:C=>{console.log("Email input changed:",C.target.value),v({...p,email:C.target.value})},required:!0,disabled:o}),e.jsx("input",{type:"password",placeholder:"Password (min 6 characters)",className:"input",value:p.password||"",onChange:C=>{console.log("Password input changed:",C.target.value),v({...p,password:C.target.value})},required:!0,minLength:6,disabled:o}),e.jsx("p",{className:"text-xs text-gray-500",children:"ðŸ’¡ The cashier will use this email and password to log in to the system"}),L&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("h4",{className:"font-semibold mb-3 text-sm flex items-center gap-2",children:[e.jsx(Ua,{className:"w-4 h-4"}),"Business Settings (Pro Plan)"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Type"}),e.jsxs("select",{className:"input",value:p.businessType||"",onChange:C=>{v({...p,businessType:C.target.value,businessRole:"cashier"})},disabled:o,children:[e.jsx("option",{value:"",children:"Default (Standard Cashier)"}),A.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select business type for specialized dashboard"})]}),p.businessType&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role in Business"}),e.jsx("select",{className:"input",value:p.businessRole||"cashier",onChange:C=>{v({...p,businessRole:C.target.value})},disabled:o,children:A.find(C=>C.id===p.businessType)?.roles.map(C=>e.jsx("option",{value:C,children:C.charAt(0).toUpperCase()+C.slice(1).replace("_"," ")},C))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This determines which dashboard they'll see"})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold mb-3 text-sm",children:"Permissions"}),e.jsx("div",{className:"space-y-2",children:Object.entries(p.permissions).map(([C,_])=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:O=>v({...p,permissions:{...p.permissions,[C]:O.target.checked}}),disabled:o}),e.jsx("span",{className:"text-sm capitalize",children:C.replace(/([A-Z])/g," $1").trim()})]},C))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",disabled:o,children:o?"Adding...":"Add Cashier"}),e.jsx("button",{type:"button",onClick:()=>c(!1),className:"btn-secondary",disabled:o,children:"Cancel"})]})]})]})}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Edit Permissions: ",d.name]}),e.jsx("div",{className:"space-y-3",children:Object.entries(d.permissions||{}).map(([C,_])=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:O=>u({...d,permissions:{...d.permissions,[C]:O.target.checked}}),disabled:o}),e.jsx("span",{className:"text-sm capitalize",children:C.replace(/([A-Z])/g," $1").trim()})]},C))}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx("button",{onClick:()=>ye(d.id,d.permissions),className:"btn-primary flex-1",disabled:o,children:o?"Saving...":"Save Changes"}),e.jsx("button",{onClick:()=>u(null),className:"btn-secondary",disabled:o,children:"Cancel"})]})]})}),x&&b&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(ir,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold",children:["Live View: ",x.name]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Real-time cashier activity monitoring"})]})]}),e.jsx("button",{onClick:K,className:"p-2 hover:bg-red-50 rounded-lg text-red-600",children:e.jsx(Qe,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-6 p-4 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${b.isActive?"bg-green-500 animate-pulse":"bg-gray-400"}`}),e.jsx("span",{className:"font-semibold",children:b.isActive?"Currently Active":"Currently Inactive"}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(tt,{className:"w-4 h-4"}),"Last Activity: ",b.lastActivity]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ct,{className:"w-5 h-5 text-blue-600"}),e.jsx("h4",{className:"font-semibold",children:"Current Cart"})]}),(b.currentCart?.length||0)>0?e.jsxs("div",{className:"space-y-2",children:[(b.currentCart||[]).map((C,_)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsxs("span",{className:"text-sm",children:[C.name," x",C.quantity]}),e.jsxs("span",{className:"text-sm font-semibold text-green-600",children:["KSH ",C.price.toLocaleString()]})]},_)),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"text-green-600",children:["KSH ",(b.currentCart||[]).reduce((C,_)=>C+_.price*_.quantity,0).toLocaleString()]})]})})]}):e.jsx("p",{className:"text-gray-500 text-sm italic",children:"No items in cart"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Today's Summary"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Sales Count:"}),e.jsx("span",{className:"font-semibold",children:b.salesCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Sales:"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["KSH ",b.totalSalesToday.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Average Sale:"}),e.jsxs("span",{className:"font-semibold",children:["KSH ",b.salesCount>0?Math.round(b.totalSalesToday/b.salesCount).toLocaleString():"0"]})]})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["ðŸ”„ Auto-refreshing every 3 seconds â€¢ Last updated: ",new Date().toLocaleTimeString()]})})]})}),j&&P&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:["Reset PIN for ",P.name]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Generate a new 4-digit PIN for this cashier. The old PIN will be invalid."}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"New PIN:"}),e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"font-mono text-3xl font-bold text-blue-600 bg-white px-4 py-2 rounded border",children:M})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(F()),className:"btn-secondary flex-1",disabled:o,children:"Generate New PIN"}),e.jsx("button",{onClick:ve,className:"btn-primary flex-1",disabled:o,children:o?"Updating...":"Confirm & Update"})]}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{onClick:()=>{S(!1),T(null),N("")},className:"btn-secondary w-full",disabled:o,children:"Cancel"})})]})})]})}function vp(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState("all"),[o,i]=h.useState(!0);h.useEffect(()=>{l();const m=setInterval(l,3e4);return()=>clearInterval(m)},[]);const l=async()=>{try{i(!0);const m=await _s.getAll();Array.isArray(m)&&(a(m.reverse()),console.log(`âœ… Loaded ${m.length} clock records from backend`))}catch(m){console.error("Failed to load clock records:",m),a([])}finally{i(!1)}},c=new Date().toDateString(),d=n==="all"?s:s.filter(m=>{try{return new Date(m.date||m.clockInTime).toDateString()===c}catch{return!1}}),u=s.filter(m=>{try{return new Date(m.date||m.clockInTime).toDateString()===c&&m.duration}catch{return!1}}).reduce((m,b)=>m+(b.duration||0),0)/60,x=m=>{let b=typeof m=="number"?m<120?m:Math.floor(m/60):0;const f=Math.floor(b/60),y=b%60;return`${f}h ${y}m`};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Time Tracking"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Monitor cashier clock in/out records"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6",children:[e.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center",children:e.jsx(tt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-700",children:"Total Hours Today"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[u.toFixed(1),"h"]})]})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-green-600 rounded-xl flex items-center justify-center",children:e.jsx(yn,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-700",children:"Active Cashiers Today"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:new Set(s.filter(m=>{try{return new Date(m.date||m.clockInTime).toDateString()===new Date().toDateString()}catch{return!1}}).map(m=>m.cashierId||m.userId)).size})]})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-600 rounded-xl flex items-center justify-center",children:e.jsx(it,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-700",children:"Total Records"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:s.length})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Clock Records"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${n==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"All Time"}),e.jsx("button",{onClick:()=>r("today"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${n==="today"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Today"}),e.jsx("button",{onClick:l,disabled:o,className:"px-4 py-2 rounded-lg text-sm font-medium bg-green-100 text-green-600 hover:bg-green-200 disabled:opacity-50",children:o?"Loading...":"Refresh"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Cashier"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Clock In"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Clock Out"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Duration"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"})]})}),e.jsx("tbody",{children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-4 py-8 text-center text-gray-500",children:o?"Loading records...":"No records found"})}):d.map((m,b)=>{const f=new Date(m.clockInTime),y=m.clockOutTime?new Date(m.clockOutTime):null;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:m.cashierName||m.userName}),e.jsx("td",{className:"px-4 py-3 text-sm",children:f.toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:f.toLocaleTimeString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:y?y.toLocaleTimeString():"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:m.duration?x(m.duration):"-"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${m.status==="clocked_in"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:m.status==="clocked_in"?"ðŸŸ¢ Clocked In":"âœ“ Clocked Out"})})]},b)})})]})})]})]})}function Np(){const{user:t,updateUser:s}=re();Ee();const[a,n]=h.useState(!1),[r,o]=h.useState(t?.plan||"ultra"),[i,l]=h.useState({}),[c,d]=h.useState(null),[u,x]=h.useState(t?.profilePicture||null),[m,b]=h.useState(!0),[f,y]=h.useState(!0);h.useEffect(()=>{g()},[]);const g=async()=>{try{const N=await cs.get();l(N),N.logo&&d(N.logo),b(N.cashierUserManagement!==!1),y(N.realTimeProductSync!==!1)}catch(N){console.error("Failed to load settings:",N)}},p=async N=>{try{const A={...i,...N};return await cs.update(A),l(A),!0}catch(A){return console.error("Failed to save settings:",A),!1}},v=async()=>{const N=!m;b(N),await p({cashierUserManagement:N})?(window.dispatchEvent(new CustomEvent("settingsChanged",{detail:{cashierUserManagement:N}})),alert(`âœ… Cashier User Management ${N?"ENABLED":"DISABLED"}`)):(b(!N),alert("âŒ Failed to save setting. Please try again."))},j=async()=>{const N=!f;y(N),await p({realTimeProductSync:N})?(window.dispatchEvent(new CustomEvent("settingsChanged",{detail:{realTimeProductSync:N}})),alert(`âœ… Real-time Product Sync ${N?"ENABLED":"DISABLED"}`)):(y(!N),alert("âŒ Failed to save setting. Please try again."))},S=async N=>{const A=N.target.files[0];if(A){const L=new FileReader;L.onloadend=async()=>{const E=L.result;d(E);try{await cs.update({...i,logo:E}),l({...i,logo:E})}catch(F){console.error("Failed to save logo:",F)}},L.readAsDataURL(A)}},P=async N=>{const A=N.target.files[0];if(A){const L=new FileReader;L.onloadend=async()=>{const E=L.result;x(E);try{await s({...t,profilePicture:E})}catch(F){console.error("Failed to save profile picture:",F)}},L.readAsDataURL(A)}},T=[{id:"basic",name:"Basic Package",price:900,features:["Cashier Dashboard","Sales Tracking","Product Management","Basic Reports"]},{id:"ultra",name:"Ultra Package",price:1600,features:["Admin Dashboard","Recipe Builder","User Management","Advanced Analytics","Expense Tracking"]}],M=async()=>{const N=T.find(L=>L.id===r),A=r==="ultra"?"admin":"cashier";await s({...t,role:A,plan:r,price:N.price}),n(!1),setTimeout(()=>window.location.href=A==="admin"?"/admin":"/cashier",500)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Settings"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your account and preferences"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(yn,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Account Information"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[u?e.jsx("img",{src:u,alt:"Profile",className:"w-20 h-20 rounded-full object-cover"}):e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white text-2xl font-bold",children:t?.name?.charAt(0).toUpperCase()}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-blue-600 text-white p-1.5 rounded-full cursor-pointer hover:bg-blue-700 transition",children:[e.jsx(or,{className:"w-3 h-3"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:P})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Name"}),e.jsx("p",{className:"font-medium",children:t?.name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:t?.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Role"}),e.jsx("p",{className:"font-medium capitalize",children:t?.role})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(At,{className:"w-5 h-5 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Subscription"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Current Plan"}),e.jsxs("p",{className:"font-medium capitalize",children:[t?.plan||"Ultra"," Package"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Price"}),e.jsxs("p",{className:"font-medium",children:["KSH ",t?.price||1600,"/month"]})]}),e.jsx("button",{onClick:()=>n(!0),className:"btn-secondary text-sm",children:"Change Plan"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center",children:e.jsx(jn,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Notifications"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Email Notifications"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"toggle"})]}),e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Low Stock Alerts"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"toggle"})]}),e.jsxs("label",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Daily Sales Summary"}),e.jsx("input",{type:"checkbox",className:"toggle"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center",children:e.jsx(be,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Cashier User Management"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Enable Cashier User Management"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Allow cashiers to add and remove users"})]}),e.jsx("button",{onClick:v,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${m?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:`p-3 rounded-lg border ${m?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsx("p",{className:"text-xs",children:m?"âœ… Cashiers can add and remove users when enabled":"âŒ Cashiers cannot add or remove users when disabled"})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(gc,{className:"w-5 h-5 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Real-time Product Sync"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Enable Real-time Sync"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Automatically sync products between admin and cashier dashboards"})]}),e.jsx("button",{onClick:j,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${f?"bg-purple-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${f?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:`p-3 rounded-lg border ${f?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"}`,children:e.jsx("p",{className:"text-xs",children:f?"âœ… Products will sync in real-time across all dashboards":"âŒ Products will not sync automatically across dashboards"})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-red-100 flex items-center justify-center",children:e.jsx(Tt,{className:"w-5 h-5 text-red-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Security"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{className:"btn-secondary text-sm w-full",children:"Change Password"}),e.jsx("button",{className:"btn-secondary text-sm w-full",children:"Enable 2FA"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center",children:e.jsx(bc,{className:"w-5 h-5 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold",children:"Screen Lock Logo"})]}),e.jsxs("div",{className:"space-y-3",children:[c&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:c,alt:"Logo Preview",className:"w-32 h-32 object-contain rounded-lg border-2 border-gray-200"})}),e.jsxs("label",{className:"btn-secondary text-sm w-full cursor-pointer flex items-center justify-center gap-2",children:[e.jsx(or,{className:"w-4 h-4"}),"Upload Logo",e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:S})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"This logo will appear on the screen lock"})]})]})]}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6",children:"Change Your Plan"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:T.map(N=>e.jsxs("div",{onClick:()=>o(N.id),className:`card cursor-pointer transition-all ${r===N.id?"ring-4 ring-blue-600 bg-blue-50":"hover:shadow-lg"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-xl font-bold",children:N.name}),r===N.id&&e.jsx(Xe,{className:"w-6 h-6 text-blue-600"})]}),e.jsxs("p",{className:"text-3xl font-bold mb-4",children:["KSH ",N.price,e.jsx("span",{className:"text-sm text-gray-600",children:"/month"})]}),e.jsx("ul",{className:"space-y-2",children:N.features.map((A,L)=>e.jsxs("li",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Xe,{className:"w-4 h-4 text-green-600"}),A]},L))})]},N.id))}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:M,className:"btn-primary flex-1",children:"Confirm Change"}),e.jsx("button",{onClick:()=>n(!1),className:"btn-secondary",children:"Cancel"})]})]})})]})}function wp(){const[t,s]=h.useState([]),[a,n]=h.useState(!1),[r,o]=h.useState(null),[i,l]=h.useState({name:"",amount:"",description:"",active:!0});h.useEffect(()=>{c()},[]);const c=()=>{const m=JSON.parse(localStorage.getItem("serviceFees")||"[]");s(m)},d=m=>{localStorage.setItem("serviceFees",JSON.stringify(m)),s(m)},u=m=>{if(m.preventDefault(),r){const b=t.map(f=>f.id===r.id?{...i,id:f.id}:f);d(b)}else{const b={...i,id:Date.now(),createdAt:new Date().toISOString()};d([...t,b])}n(!1),o(null),l({name:"",amount:"",description:"",active:!0})},x=m=>{confirm("Delete this service fee?")&&d(t.filter(b=>b.id!==m))};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Service Fees"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage delivery, packaging, and other fees"})]}),e.jsxs("button",{onClick:()=>{n(!0),o(null)},className:"btn-primary flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Fee"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.map(m=>e.jsxs("div",{className:`card ${m.active?"border-green-200 bg-green-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx($e,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:m.name}),e.jsx("p",{className:"text-xs text-gray-500",children:m.description})]})]}),e.jsx("span",{className:`badge ${m.active?"badge-success":"bg-gray-200 text-gray-600"}`,children:m.active?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["KSH ",m.amount]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{o(m),l(m),n(!0)},className:"p-2 hover:bg-blue-50 rounded-lg",children:e.jsx(Et,{className:"w-4 h-4 text-blue-600"})}),e.jsx("button",{onClick:()=>x(m.id),className:"p-2 hover:bg-red-50 rounded-lg",children:e.jsx(ze,{className:"w-4 h-4 text-red-600"})})]})]})]},m.id))}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:[r?"Edit":"Add"," Service Fee"]}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsx("input",{type:"text",placeholder:"Fee Name (e.g., Delivery)",className:"input",value:i.name,onChange:m=>l({...i,name:m.target.value}),required:!0}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Amount",className:"input",value:i.amount,onChange:m=>l({...i,amount:m.target.value}),required:!0}),e.jsx("textarea",{placeholder:"Description",className:"input",rows:"2",value:i.description,onChange:m=>l({...i,description:m.target.value})}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.active,onChange:m=>l({...i,active:m.target.checked})}),e.jsx("span",{className:"text-sm",children:"Active"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function Sp(){const[t,s]=h.useState([]),[a,n]=h.useState([]),[r,o]=h.useState(!1),[i,l]=h.useState({customerName:"",productId:"",frequency:"weekly",days:[],nextDate:""});h.useEffect(()=>{c(),d()},[]);const c=async()=>{try{const f=localStorage.getItem("token"),y=await fetch(`${ee}/reminders`,{headers:{Authorization:`Bearer ${f}`}});if(!y.ok){console.error("API Error:",y.status,y.statusText),s([]);return}const g=await y.json();Array.isArray(g)?s(g):(console.error("Expected array but got:",typeof g,g),s([]))}catch(f){console.error("Failed to fetch reminders:",f),s([])}},d=async()=>{try{const f=localStorage.getItem("token"),y=await fetch(`${ee}/products`,{headers:{Authorization:`Bearer ${f}`}});if(!y.ok){console.error("API Error:",y.status,y.statusText),n([]);return}const g=await y.json();Array.isArray(g)?n(g):(console.error("Expected array but got:",typeof g,g),n([]))}catch(f){console.error("Failed to fetch products:",f),n([])}},u=async f=>{f.preventDefault();try{const y=localStorage.getItem("token"),g=await fetch(`${ee}/reminders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify(i)});if(!g.ok){const v=await g.json();console.error("Failed to create reminder:",v),alert(`Failed to create reminder: ${v.error||"Unknown error"}`);return}const p=await g.json();l({customerName:"",productId:"",frequency:"weekly",days:[],nextDate:""}),o(!1),c(),alert("Reminder created successfully!")}catch(y){console.error("Failed to create reminder:",y),alert("Failed to create reminder. Please try again.")}},x=async f=>{try{if(JSON.parse(localStorage.getItem("user")||"{}").role!=="admin"){alert("Only administrators can delete reminders.");return}if(!confirm("Are you sure you want to delete this reminder? This action cannot be undone."))return;const g=localStorage.getItem("token"),p=await fetch(`${ee}/reminders/${f}`,{method:"DELETE",headers:{Authorization:`Bearer ${g}`}});if(!p.ok){const v=await p.json();console.error("Failed to delete reminder:",v),alert(`Failed to delete reminder: ${v.error||"Unknown error"}`);return}c(),alert("Reminder deleted successfully!")}catch(y){console.error("Failed to delete reminder:",y),alert("Failed to delete reminder. Please try again.")}},m=f=>{i.days.includes(f)?l({...i,days:i.days.filter(y=>y!==f)}):l({...i,days:[...i.days,f]})},b=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(jn,{className:"text-blue-600"}),"Reminder System"]}),e.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-bold hover:bg-blue-700 transition flex items-center gap-2",children:[e.jsx(ge,{size:20}),"New Reminder"]})]}),e.jsx("div",{className:"grid gap-4",children:t.map(f=>{const y=a.find(g=>g.id===f.productId);return e.jsx("div",{className:`p-6 rounded-xl shadow-lg ${f.status==="pending"?"bg-red-50 border-l-4 border-red-500":"bg-green-50 border-l-4 border-green-500"}`,children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:f.customerName}),e.jsxs("p",{className:"text-gray-700 mb-1",children:["Product: ",y?.name||"Unknown"]}),e.jsxs("p",{className:"text-gray-600 text-sm mb-1",children:["Frequency: ",f.frequency]}),f.days?.length>0&&e.jsxs("p",{className:"text-gray-600 text-sm mb-1",children:["Days: ",f.days.join(", ")]}),e.jsxs("p",{className:"text-gray-600 text-sm flex items-center gap-2",children:[e.jsx(it,{size:16}),"Next: ",new Date(f.nextDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-4 py-2 rounded-lg font-bold ${f.status==="pending"?"bg-red-500 text-white":"bg-green-500 text-white"}`,children:f.status}),e.jsx("button",{onClick:()=>x(f.id),className:"bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition",children:e.jsx(ze,{size:20})})]})]})},f.id)})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white rounded-t-2xl",children:e.jsx("h2",{className:"text-2xl font-bold",children:"Create Reminder"})}),e.jsxs("form",{onSubmit:u,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Customer Name"}),e.jsx("input",{type:"text",value:i.customerName,onChange:f=>l({...i,customerName:f.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Product"}),e.jsxs("select",{value:i.productId,onChange:f=>l({...i,productId:parseInt(f.target.value)}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select Product"}),a.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Frequency"}),e.jsxs("select",{value:i.frequency,onChange:f=>l({...i,frequency:f.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"specific",children:"Specific Days"})]})]}),i.frequency==="specific"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Days"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(f=>e.jsx("button",{type:"button",onClick:()=>m(f),className:`px-4 py-2 rounded-lg font-medium transition ${i.days.includes(f)?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:f},f))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Next Reminder Date"}),e.jsx("input",{type:"date",value:i.nextDate,onChange:f=>l({...i,nextDate:f.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-bold hover:bg-blue-700 transition",children:"Create Reminder"}),e.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition",children:"Cancel"})]})]})]})})]})}function kp(){const[t,s]=h.useState([]),[a,n]=h.useState(!1),[r,o]=h.useState(null),[i,l]=h.useState({name:"",percentage:"",validFrom:"",validTo:"",active:!0});h.useEffect(()=>{c()},[]);const c=async()=>{try{const m=await rs.getAll();s(m)}catch(m){console.error("Failed to load discounts:",m)}},d=async m=>{m.preventDefault();try{r?await rs.update(r.id,i):await rs.create(i),n(!1),o(null),l({name:"",percentage:"",validFrom:"",validTo:"",active:!0}),c()}catch(b){console.error("Failed to save discount:",b)}},u=async m=>{if(confirm("Delete this discount?"))try{await rs.delete(m),c()}catch(b){console.error("Failed to delete discount:",b)}},x=m=>{const b=new Date,f=new Date(m.validFrom),y=new Date(m.validTo);return m.active&&f<=b&&y>=b};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Discount Manager"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage discount rules"})]}),e.jsxs("button",{onClick:()=>{n(!0),o(null),l({name:"",percentage:"",validFrom:"",validTo:"",active:!0})},className:"btn-primary flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Discount"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.map(m=>e.jsxs("div",{className:`card ${x(m)?"border-green-200 bg-green-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${x(m)?"bg-green-600":"bg-gray-400"}`,children:e.jsx(za,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:m.name}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[m.percentage,"% OFF"]})]})]}),e.jsx("span",{className:`badge ${x(m)?"badge-success":"bg-gray-200 text-gray-600"}`,children:x(m)?"Active":"Inactive"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsxs("span",{children:["From: ",new Date(m.validFrom).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsxs("span",{children:["To: ",new Date(m.validTo).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{o(m),l(m),n(!0)},className:"p-2 hover:bg-blue-50 rounded-lg flex-1",children:e.jsx(Et,{className:"w-4 h-4 text-blue-600 mx-auto"})}),e.jsx("button",{onClick:()=>u(m.id),className:"p-2 hover:bg-red-50 rounded-lg flex-1",children:e.jsx(ze,{className:"w-4 h-4 text-red-600 mx-auto"})})]})]},m.id)),t.length===0&&e.jsxs("div",{className:"card text-center py-12 col-span-full",children:[e.jsx(za,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No discounts yet. Create your first discount!"})]})]}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:[r?"Edit":"Add"," Discount"]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Discount Name"}),e.jsx("input",{type:"text",className:"input",value:i.name,onChange:m=>l({...i,name:m.target.value}),placeholder:"e.g., Holiday Sale",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Percentage (%)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:"100",className:"input",value:i.percentage,onChange:m=>l({...i,percentage:parseFloat(m.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Valid From"}),e.jsx("input",{type:"date",className:"input",value:i.validFrom,onChange:m=>l({...i,validFrom:m.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Valid To"}),e.jsx("input",{type:"date",className:"input",value:i.validTo,onChange:m=>l({...i,validTo:m.target.value}),required:!0})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:i.active,onChange:m=>l({...i,active:m.target.checked})}),e.jsx("span",{className:"text-sm",children:"Active"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Save"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"btn-secondary",children:"Cancel"})]})]})]})})]})}function Cp(){const[t,s]=h.useState([]),[a,n]=h.useState("all"),[r,o]=h.useState(null),[i,l]=h.useState(""),[c,d]=h.useState(!1),[u,x]=h.useState(null);h.useEffect(()=>{m();const j=setInterval(m,1e4);return()=>clearInterval(j)},[]);const m=async()=>{try{const j=await Bs.getAll();s(j||[])}catch(j){console.error("Failed to load credit requests:",j)}},b=async j=>{o(j);try{await Bs.update(j,{status:"approved"}),console.log("âœ… Credit request approved"),m()}catch(S){console.error("Failed to approve request:",S),alert("Failed to approve request: "+(S.message||"Unknown error"))}finally{o(null)}},f=j=>{x(j),d(!0)},y=async()=>{if(u){o(u.id);try{await Bs.update(u.id,{status:"rejected",rejectionReason:i}),console.log("âœ… Credit request rejected"),d(!1),l(""),x(null),m()}catch(j){console.error("Failed to reject request:",j),alert("Failed to reject request: "+(j.message||"Unknown error"))}finally{o(null)}}},g=t.filter(j=>a==="all"?!0:j.status===a),p=j=>{switch(j){case"pending":return"bg-orange-50 border-orange-200";case"approved":return"bg-green-50 border-green-200";case"rejected":return"bg-red-50 border-red-200";default:return"bg-gray-50 border-gray-200"}},v=j=>{switch(j){case"pending":return e.jsx(tt,{className:"w-6 h-6 text-orange-600"});case"approved":return e.jsx(Ze,{className:"w-6 h-6 text-green-600"});case"rejected":return e.jsx(ls,{className:"w-6 h-6 text-red-600"});default:return e.jsx(At,{className:"w-6 h-6 text-gray-600"})}};return e.jsxs("div",{className:"p-4 md:p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Credit Requests"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Review and manage credit requests from cashiers"})]}),e.jsx("div",{className:"flex gap-2",children:["all","pending","approved","rejected"].map(j=>e.jsxs("button",{onClick:()=>n(j),className:`px-4 py-2 rounded-lg font-medium transition ${a===j?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[j.charAt(0).toUpperCase()+j.slice(1),j==="pending"&&t.filter(S=>S.status==="pending").length>0&&e.jsx("span",{className:"ml-2 bg-red-500 text-white text-xs rounded-full px-2 py-1",children:t.filter(S=>S.status==="pending").length})]},j))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[g.map(j=>e.jsx("div",{className:`card border-l-4 ${p(j.status)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${j.status==="pending"?"bg-orange-600":j.status==="approved"?"bg-green-600":"bg-red-600"}`,children:v(j.status)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:j.customerName}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Requested by: ",j.cashierName]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsxs("span",{children:["Amount: ",e.jsxs("strong",{className:"text-green-600",children:["KSH ",j.amount?.toLocaleString()]})]}),j.reason&&e.jsxs("span",{children:["Reason: ",e.jsx("strong",{children:j.reason.replace(/_/g," ")})]})]}),j.notes&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Notes: ",j.notes]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Requested: ",new Date(j.createdAt).toLocaleString()]}),j.approvalDate&&e.jsxs("p",{className:"text-xs text-gray-500",children:[j.status==="approved"?"Approved":"Processed",": ",new Date(j.approvalDate).toLocaleString(),j.approvedBy&&` by ${j.approvedBy}`]}),j.rejectionReason&&e.jsxs("p",{className:"text-xs text-red-600 mt-2",children:["Rejection reason: ",j.rejectionReason]})]})]}),j.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>b(j.id),disabled:r===j.id,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition disabled:opacity-50",children:[e.jsx(Ze,{size:16}),r===j.id?"Approving...":"Approve"]}),e.jsxs("button",{onClick:()=>f(j),disabled:r===j.id,className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition disabled:opacity-50",children:[e.jsx(ls,{size:16}),r===j.id?"Rejecting...":"Reject"]})]}),j.status!=="pending"&&e.jsx("span",{className:`badge ${j.status==="approved"?"badge-success":"bg-red-100 text-red-800"}`,children:j.status.toUpperCase()})]})},j.id)),g.length===0&&e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(At,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-500",children:["No ",a!=="all"?a:""," credit requests found."]})]})]}),c&&u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-red-600 p-6 text-white flex items-center gap-3",children:[e.jsx(ft,{className:"w-6 h-6"}),e.jsx("h3",{className:"text-xl font-bold",children:"Reject Credit Request"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to reject this credit request from ",e.jsx("strong",{children:u.customerName})," for ",e.jsxs("strong",{children:["KSH ",u.amount?.toLocaleString()]}),"?"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Rejection Reason"}),e.jsx("textarea",{placeholder:"Enter reason for rejection...",value:i,onChange:j=>l(j.target.value),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-red-500",rows:"4"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:y,disabled:r!==null,className:"flex-1 bg-red-600 hover:bg-red-700 text-white py-3 rounded-lg font-bold transition disabled:opacity-50",children:r?"Rejecting...":"Confirm Rejection"}),e.jsx("button",{onClick:()=>{d(!1),l(""),x(null)},disabled:r!==null,className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-400 transition disabled:opacity-50",children:"Cancel"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[g.map(j=>e.jsx("div",{className:`card border-l-4 ${p(j.status)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${j.status==="pending"?"bg-orange-600":j.status==="approved"?"bg-green-600":"bg-red-600"}`,children:v(j.status)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:j.customerName}),e.jsx("p",{className:"text-sm text-gray-600",children:getProductName(j.productId)}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsxs("span",{children:["Quantity: ",e.jsx("strong",{children:j.quantity})]}),e.jsxs("span",{children:["Amount: ",e.jsxs("strong",{className:"text-green-600",children:["KSH ",j.amount?.toLocaleString()]})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Requested: ",new Date(j.createdAt).toLocaleString()]}),j.approvedAt&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Approved: ",new Date(j.approvedAt).toLocaleString()]})]})]}),j.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>b(j.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition",children:[e.jsx(Ze,{size:16}),"Approve"]}),e.jsxs("button",{onClick:()=>handleReject(j.id),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition",children:[e.jsx(ls,{size:16}),"Reject"]})]}),j.status!=="pending"&&e.jsx("span",{className:`badge ${j.status==="approved"?"badge-success":"bg-red-100 text-red-800"}`,children:j.status.toUpperCase()})]})},j.id)),g.length===0&&e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(At,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-500",children:["No ",a!=="all"?a:""," credit requests found."]})]})]})]})}function Pp(){const[t,s]=h.useState([]),[a,n]=h.useState(!0),[r,o]=h.useState(!1),[i,l]=h.useState(null),[c,d]=h.useState(""),[u,x]=h.useState({name:"",email:"",phone:"",address:"",city:"",country:"",products:""});h.useEffect(()=>{m()},[]);const m=async()=>{try{n(!0);const v=localStorage.getItem("token"),j=await fetch(`${ee}/vendors`,{headers:{Authorization:`Bearer ${v}`}});if(j.ok){const S=await j.json();s(Array.isArray(S)?S:[])}}catch(v){console.error("Failed to load vendors:",v),s([])}finally{n(!1)}},b=()=>{l(null),x({name:"",email:"",phone:"",address:"",city:"",country:"",products:""}),o(!0)},f=v=>{l(v),x(v),o(!0)},y=async v=>{if(window.confirm("Are you sure you want to delete this vendor?"))try{const j=localStorage.getItem("token");(await fetch(`${ee}/vendors/${v}`,{method:"DELETE",headers:{Authorization:`Bearer ${j}`}})).ok?(s(t.filter(P=>P.id!==v)),alert("Vendor deleted successfully")):alert("Failed to delete vendor")}catch(j){console.error("Failed to delete vendor:",j),alert("Failed to delete vendor")}},g=async v=>{v.preventDefault();try{const j=localStorage.getItem("token"),S=i?"PUT":"POST",P=i?`${ee}/vendors/${i.id}`:`${ee}/vendors`,T=await fetch(P,{method:S,headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"},body:JSON.stringify(u)});if(T.ok){const M=await T.json();s(i?t.map(N=>N.id===M.id?M:N):[...t,M]),o(!1),alert(i?"Vendor updated":"Vendor added")}else alert("Failed to save vendor")}catch(j){console.error("Failed to save vendor:",j),alert("Failed to save vendor")}},p=t.filter(v=>v.name?.toLowerCase().includes(c.toLowerCase())||v.email?.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Vendors"}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[e.jsx(ge,{className:"w-5 h-5"}),"Add Vendor"]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(Kt,{className:"absolute left-3 top-3 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search vendors...",value:c,onChange:v=>d(v.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg"})]})}),a?e.jsx("div",{className:"text-center py-8",children:"Loading vendors..."}):p.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:["No vendors found. ",t.length===0&&"Add your first vendor to get started."]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map(v=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:v.name}),e.jsx("p",{className:"text-sm text-gray-500",children:v.products})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(v),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",children:e.jsx(Et,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>y(v.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",children:e.jsx(ze,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[v.email&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(zt,{className:"w-4 h-4"}),e.jsx("a",{href:`mailto:${v.email}`,children:v.email})]}),v.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Ki,{className:"w-4 h-4"}),e.jsx("a",{href:`tel:${v.phone}`,children:v.phone})]}),v.address&&e.jsxs("div",{className:"flex items-start gap-2 text-gray-600",children:[e.jsx(yc,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[v.address,v.city&&`, ${v.city}`,v.country&&`, ${v.country}`]})]})]})]},v.id))}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:i?"Edit Vendor":"Add Vendor"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(Qe,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendor Name *"}),e.jsx("input",{type:"text",required:!0,value:u.name,onChange:v=>x({...u,name:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., ABC Supplies"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Products/Services"}),e.jsx("input",{type:"text",value:u.products,onChange:v=>x({...u,products:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"e.g., Vegetables, Fruits"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:u.email,onChange:v=>x({...u,email:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"vendor@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:u.phone,onChange:v=>x({...u,phone:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"+1 (555) 000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:u.address,onChange:v=>x({...u,address:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Street address"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:u.city,onChange:v=>x({...u,city:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsx("input",{type:"text",value:u.country,onChange:v=>x({...u,country:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Country"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 text-white bg-blue-600 rounded-lg hover:bg-blue-700",children:[i?"Update":"Add"," Vendor"]})]})]})]})})]})}function Xl({onClose:t}){const[s,a]=h.useState([]),[n,r]=h.useState(!0),o=h.useRef({data:null,timestamp:null}),i=3e4;h.useEffect(()=>{l()},[]);const l=async()=>{try{const d=Date.now();if(o.current.data&&o.current.timestamp&&d-o.current.timestamp<i){console.log("ðŸ“¦ Using cached reminders"),a(o.current.data),r(!1);return}const u=localStorage.getItem("token"),x=await fetch(`${ee}/reminders/today`,{headers:{Authorization:`Bearer ${u}`}});if(!x.ok){console.error("API Error:",x.status,x.statusText),a([]),r(!1);return}const m=await x.json();Array.isArray(m)?(o.current.data=m,o.current.timestamp=Date.now(),a(m)):(console.error("Expected array but got:",typeof m,m),a([]))}catch(d){console.error("Failed to fetch reminders:",d),a([])}finally{r(!1)}},c=async d=>{try{const u=localStorage.getItem("token");await fetch(`${ee}/reminders/${d}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`},body:JSON.stringify({status:"fulfilled"})}),o.current={data:null,timestamp:null},l()}catch(u){console.error("Failed to update reminder:",u)}};return n?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Today's Reminders"}),e.jsx("button",{onClick:t,className:"hover:bg-white/20 p-2 rounded-lg transition",children:e.jsx(Qe,{size:24})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ft,{className:"mx-auto h-12 w-12 text-green-500 mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"No reminders for today"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"You're all caught up!"})]}):s.map(d=>e.jsxs("div",{className:"mb-4 p-4 border-l-4 border-red-500 bg-red-50 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:d.customerName}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Product ID: ",d.productId]}),e.jsx("p",{className:"text-xs text-gray-500",children:d.frequency})]}),e.jsxs("button",{onClick:()=>c(d.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition",children:[e.jsx(Ze,{size:18}),"Mark Done"]})]},d.id))})]})})}function Zl({onUnlock:t,userType:s="user"}){const[a,n]=h.useState(""),[r,o]=h.useState(""),[i,l]=h.useState("password"),[c,d]=h.useState(!1),[u,x]=h.useState(""),[m,b]=h.useState(!1),[f,y]=h.useState("2005"),g=JSON.parse(localStorage.getItem("user")||"{}");h.useEffect(()=>{(async()=>{try{const S=await cs.get();S?.screenLockPassword&&y(S.screenLockPassword)}catch(S){console.warn("Failed to load settings, using default password:",S)}})()},[]),h.useEffect(()=>{const j=document.getElementById(i==="password"?"unlock-password":"unlock-pin");j&&j.focus()},[i]);const p=async j=>{j.preventDefault(),j.stopPropagation(),b(!0),x("");try{const S=localStorage.getItem("token");if(!S)throw new Error("No authentication token found");const P=await fetch("https://universal-backend-w0x1.onrender.com/api/auth/unlock-screen",{method:"POST",headers:{Authorization:`Bearer ${S}`,"Content-Type":"application/json"},body:JSON.stringify({pin:r})});if(!P.ok){const M=await P.json();throw P.status===429?new Error(M.message||"Too many failed attempts. Try again later."):P.status===401?new Error(M.message||"Incorrect PIN"):new Error(M.message||"Unlock failed")}const T=await P.json();T.token&&localStorage.setItem("token",T.token),o(""),n(""),t(T)}catch(S){x(S.message||"Unlock failed")}finally{b(!1)}},v=j=>{const S=j.replace(/\D/g,"").slice(0,4);o(S)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:j=>j.stopPropagation(),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 p-8",onClick:j=>j.stopPropagation(),children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:`w-16 h-16 rounded-2xl mx-auto mb-4 flex items-center justify-center ${s==="main_admin"?"bg-gradient-to-br from-red-600 to-orange-600":"bg-gradient-to-br from-blue-600 to-purple-600"}`,children:e.jsx(Ve,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Screen Locked"}),e.jsx("p",{className:"text-gray-600",children:s==="main_admin"?"Main Admin":g.name||"User"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Enter your ",i," to continue"]})]}),e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter PIN to unlock"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",id:"unlock-pin",value:r,onChange:j=>v(j.target.value),placeholder:"0000",maxLength:"4",className:"w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-center tracking-widest text-2xl",disabled:m})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"ðŸ”’ PIN validated securely on server"})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-red-700 text-sm font-medium",children:[u.includes("Too many")?"âŒ ":"âš ï¸ ",u]})}),e.jsx("button",{type:"submit",disabled:m||r.length<4,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold py-3 rounded-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:m?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Verifying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-5 h-5"}),"Unlock Screen"]})})]})]})})}function Ql(t=6e4){const[s,a]=h.useState(!1),n=h.useRef(Date.now()),r=h.useCallback(()=>{n.current=Date.now(),a(!1)},[]),o=h.useCallback(()=>{a(!1),n.current=Date.now()},[]);return h.useEffect(()=>{const i=["mousedown","mousemove","keypress","scroll","touchstart","click"],l=()=>{n.current=Date.now(),s&&a(!1)};i.forEach(d=>{document.addEventListener(d,l,!0)});const c=setInterval(()=>{Date.now()-n.current>t&&!s&&a(!0)},5e3);return()=>{i.forEach(d=>{document.removeEventListener(d,l,!0)}),clearInterval(c)}},[t,s]),[s,o,r]}function da(){const{user:t,logout:s,isCashierUserManagementEnabled:a}=re(),n=Ee(),r=Bi(),[o,i]=h.useState(!0),[l,c]=h.useState(!1),[d,u]=h.useState({}),[x,m]=Ql(45e3),b=t?.subscription==="pro"||t?.plan==="pro"||t?.subscription==="custom"||t?.plan===3e3,f=t?.businessType||t?.business_type;if(b&&f)return console.log("ðŸš« [AdminDashboard] Pro user detected - redirecting to business dashboard:",f),e.jsx(ae,{to:`/admin/${f}`,replace:!0});if(b&&!f&&t?.role==="admin")return console.log("ðŸš« [AdminDashboard] Pro user without business type - redirecting to selector"),e.jsx(ae,{to:"/select-business-type",replace:!0});h.useEffect(()=>{const j=()=>{const P=localStorage.getItem("user");if(P){const T=JSON.parse(P);let M=!1;(T.plan==="ultra"||T.role==="admin")&&(T.active||(T.active=!0,M=!0),T.plan==="ultra"&&T.role!=="admin"&&(T.role="admin",M=!0),T.plan==="ultra"&&(!T.price||T.price!==1600)&&(T.price=1600,M=!0),M&&(localStorage.setItem("user",JSON.stringify(T)),window.dispatchEvent(new Event("storage")),window.dispatchEvent(new Event("localStorageUpdated"))))}};j(),setTimeout(j,100);const S=setTimeout(()=>{c(!0)},1e3);return y(),()=>clearTimeout(S)},[]);const y=async()=>{try{const j=await cs.get();u(j)}catch(j){console.error("Failed to load settings:",j)}},g=async()=>{if(window.confirm("Are you sure you want to clear all sales and expenses data? This action cannot be undone."))try{const j=localStorage.getItem("token"),P=await fetch(`${ee}/clear-data`,{method:"POST",headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"},body:JSON.stringify({type:"all"})});if(!P.ok){const T=await P.json();throw new Error(T.message||"Failed to clear data")}alert("Data cleared successfully!"),window.location.reload()}catch(j){console.error("Failed to clear data:",j),alert("Failed to clear data: "+j.message)}},p=[{id:"overview",label:"Dashboard",icon:jc,path:"/admin"},{id:"analytics",label:"Analytics",icon:Ae,path:"/admin/analytics"},{id:"sales",label:"Sales",icon:Ui,path:"/admin/sales"},{id:"inventory",label:"Inventory",icon:De,path:"/admin/inventory"},{id:"recipes",label:"Recipes/BOM",icon:vc,path:"/admin/recipes"},{id:"expenses",label:"Expenses",icon:Xs,path:"/admin/expenses"},{id:"vendors",label:"Vendors",icon:Nc,path:"/admin/vendors"},...a()?[{id:"users",label:"Users",icon:be,path:"/admin/users"}]:[],{id:"time",label:"Time Tracking",icon:tt,path:"/admin/time"},{id:"reminders",label:"Reminders",icon:jn,path:"/admin/reminders"},{id:"service-fees",label:"Service Fees",icon:$e,path:"/admin/service-fees"},{id:"discounts",label:"Discounts",icon:za,path:"/admin/discounts"},{id:"credit-requests",label:"Credit Requests",icon:At,path:"/admin/credit-requests"},{id:"settings",label:"Settings",icon:Gi,path:"/admin/settings"}],v=j=>j==="/admin"?r.pathname==="/admin":r.pathname.startsWith(j);return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsxs("aside",{className:`bg-white border-r border-gray-200 transition-all duration-300 ${o?"w-64":"w-20"} flex flex-col`,children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[o&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Admin Panel"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ultra Package"})]}),e.jsx("button",{onClick:()=>i(!o),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:o?e.jsx(Qe,{className:"w-5 h-5"}):e.jsx(wc,{className:"w-5 h-5"})})]})}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:p.map(j=>{const S=j.icon;return e.jsxs("button",{onClick:()=>n(j.path),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${v(j.path)?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-md":"text-gray-700 hover:bg-gray-100"}`,children:[e.jsx(S,{className:"w-5 h-5 flex-shrink-0"}),o&&e.jsx("span",{className:"font-medium",children:j.label})]},j.id)})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[e.jsxs("button",{onClick:()=>window.open("/cashier","_blank"),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(Sc,{className:"w-5 h-5 flex-shrink-0"}),o&&e.jsx("span",{className:"font-medium",children:"Open POS"})]}),e.jsxs("button",{onClick:s,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-red-600 hover:bg-red-50 transition-colors",children:[e.jsx(ot,{className:"w-5 h-5 flex-shrink-0"}),o&&e.jsx("span",{className:"font-medium",children:"Logout"})]}),e.jsxs("button",{onClick:g,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-orange-600 hover:bg-orange-50 transition-colors",children:[e.jsx(Qe,{className:"w-5 h-5 flex-shrink-0"}),o&&e.jsx("span",{className:"font-medium",children:"Clear Data"})]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:p.find(j=>v(j.path))?.label||"Dashboard"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t?.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t?.email})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white font-bold",children:t?.name?.charAt(0).toUpperCase()})]})]})}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsxs(_i,{children:[e.jsx(X,{path:"/analytics",element:e.jsx(hp,{})}),e.jsx(X,{path:"/",element:e.jsx(sd,{})}),e.jsx(X,{path:"/sales",element:e.jsx(bp,{})}),e.jsx(X,{path:"/inventory",element:e.jsx(fp,{})}),e.jsx(X,{path:"/recipes",element:e.jsx(gp,{})}),e.jsx(X,{path:"/expenses",element:e.jsx(yp,{})}),e.jsx(X,{path:"/vendors",element:e.jsx(Pp,{})}),e.jsx(X,{path:"/reminders",element:e.jsx(Sp,{})}),e.jsx(X,{path:"/service-fees",element:e.jsx(wp,{})}),e.jsx(X,{path:"/discounts",element:e.jsx(kp,{})}),e.jsx(X,{path:"/credit-requests",element:e.jsx(Cp,{})}),e.jsx(X,{path:"/users",element:e.jsx(jp,{})}),e.jsx(X,{path:"/time",element:e.jsx(vp,{})}),e.jsx(X,{path:"/settings",element:e.jsx(Np,{})})]})})]}),l&&e.jsx(Xl,{onClose:()=>c(!1)}),x&&e.jsx(Zl,{onUnlock:m,logo:d.logo})]})}function Tp(t){if(!t)return console.warn("[getDashboardRoute] No user provided"),"/auth/login";const s=t.subscription||t.plan||"basic",a=t.role||"cashier",n=t.businessType||t.business_type,r=t.businessRole||t.business_role;if(console.log("[getDashboardRoute] Evaluating:",{subscription:s,role:a,businessType:n,businessRole:r,user:t.email}),a==="owner")return console.log("[getDashboardRoute] â†’ /main-admin (Owner)"),"/main-admin";if((s==="pro"||s==="custom")&&n){if(a==="admin")return console.log(`[getDashboardRoute] â†’ /admin/${n} (Pro Admin - ${n})`),`/admin/${n}`;if(r&&r!=="admin")return console.log(`[getDashboardRoute] â†’ /dashboard/${n}/${r} (Pro ${r})`),`/dashboard/${n}/${r}`;if(a==="cashier")return console.log(`[getDashboardRoute] â†’ /dashboard/${n}/cashier (Pro Cashier - ${n})`),`/dashboard/${n}/cashier`}if((s==="pro"||s==="custom")&&!n){if(a==="admin")return console.log("[getDashboardRoute] â†’ /select-business-type (Pro Admin - No business type)"),"/select-business-type";if(a==="cashier")return console.log("[getDashboardRoute] â†’ /cashier (Pro Cashier - No business type)"),"/cashier"}return a==="admin"?(console.log(`[getDashboardRoute] â†’ /admin (${s} Admin)`),"/admin"):a==="cashier"?(console.log(`[getDashboardRoute] â†’ /cashier (${s} Cashier)`),"/cashier"):(console.warn("[getDashboardRoute] â†’ /dashboard (Fallback)"),"/dashboard")}function Ap(t){if(!t)return!1;const s=t.subscription||t.plan;return s==="pro"||s==="custom"}function Dp(t){return t?!!(t.businessType||t.business_type):!1}function Ep(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState([]),[o,i]=h.useState(null),[l,c]=h.useState(!1),[d,u]=h.useState(!0),[x,m]=h.useState({medications:"",dosage:"",instructions:"",duration:""});h.useEffect(()=>{b()},[]);const b=async()=>{try{const g=localStorage.getItem("token"),p=await fetch(`${ee}/appointments?doctor_id=${t.id}&status=scheduled`,{headers:{Authorization:`Bearer ${g}`}});if(p.ok){const v=await p.json();a(v)}}catch(g){console.error("Failed to load appointments:",g)}finally{u(!1)}},f=async()=>{try{const g=localStorage.getItem("token");(await fetch(`${ee}/prescriptions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({patient_id:o.id,patient_name:o.name,doctor_id:t.id,doctor_name:t.name,medications:x.medications,dosage:x.dosage,instructions:x.instructions,duration:x.duration,status:"active"})})).ok&&(c(!1),m({medications:"",dosage:"",instructions:"",duration:""}),i(null),alert("Prescription created successfully"))}catch(g){console.error("Failed to create prescription:",g),alert("Failed to create prescription")}},y=s.filter(g=>{const p=new Date(g.appointment_date).toDateString(),v=new Date().toDateString();return p===v});return d?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Doctor Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Welcome back, Dr. ",t.name]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Today's Appointments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:y.length})]}),e.jsx("div",{className:"bg-blue-100 rounded-full p-3",children:e.jsx(it,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Patients"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:n.length})]}),e.jsx("div",{className:"bg-green-100 rounded-full p-3",children:e.jsx(be,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Prescriptions Written"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:"0"})]}),e.jsx("div",{className:"bg-purple-100 rounded-full p-3",children:e.jsx(Ji,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Pending Reviews"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:"0"})]}),e.jsx("div",{className:"bg-orange-100 rounded-full p-3",children:e.jsx(Yi,{className:"w-6 h-6 text-orange-600"})})]})})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Today's Schedule"}),e.jsx(tt,{className:"w-5 h-5 text-gray-400"})]}),y.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(it,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No appointments scheduled for today"})]}):e.jsx("div",{className:"space-y-4",children:y.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:e.jsx(ua,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:g.patient_name}),e.jsx("p",{className:"text-sm text-gray-600",children:g.reason||"General checkup"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:new Date(g.appointment_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),e.jsx("button",{onClick:()=>{i({id:g.patient_id,name:g.patient_name}),c(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Write Prescription"})]})]},g.id))})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(V.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl shadow-xl max-w-2xl w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Write Prescription"}),e.jsx("button",{onClick:()=>{c(!1),i(null)},className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-gray-600",children:["Patient: ",e.jsx("span",{className:"font-medium text-gray-900",children:o?.name})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Medications"}),e.jsx("input",{type:"text",value:x.medications,onChange:g=>m({...x,medications:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Amoxicillin, Ibuprofen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dosage"}),e.jsx("input",{type:"text",value:x.dosage,onChange:g=>m({...x,dosage:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 500mg twice daily"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Instructions"}),e.jsx("textarea",{value:x.instructions,onChange:g=>m({...x,instructions:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:"Take with food, avoid alcohol, etc."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration"}),e.jsx("input",{type:"text",value:x.duration,onChange:g=>m({...x,duration:g.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., 7 days, 2 weeks"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{c(!1),i(null)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create Prescription"})]})]})})]})}function Fi(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState(!1),[o,i]=h.useState(!0),[l,c]=h.useState({patient_name:"",patient_phone:"",patient_email:"",appointment_date:"",appointment_time:"",reason:"",doctor_id:""});h.useEffect(()=>{d()},[]);const d=async()=>{try{const f=localStorage.getItem("token"),y=await fetch(`${ee}/appointments`,{headers:{Authorization:`Bearer ${f}`}});if(y.ok){const g=await y.json();a(g)}}catch(f){console.error("Failed to load appointments:",f)}finally{i(!1)}},u=async()=>{try{const f=localStorage.getItem("token"),y=`${l.appointment_date}T${l.appointment_time}:00`;(await fetch(`${ee}/appointments`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({patient_name:l.patient_name,patient_phone:l.patient_phone,patient_email:l.patient_email,appointment_date:y,reason:l.reason,doctor_id:l.doctor_id||null,status:"scheduled"})})).ok&&(r(!1),c({patient_name:"",patient_phone:"",patient_email:"",appointment_date:"",appointment_time:"",reason:"",doctor_id:""}),d(),alert("Appointment scheduled successfully"))}catch(f){console.error("Failed to create appointment:",f),alert("Failed to schedule appointment")}},x=async(f,y)=>{try{const g=localStorage.getItem("token");(await fetch(`${ee}/appointments/${f}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({status:y})})).ok&&d()}catch(g){console.error("Failed to update appointment:",g)}},m=s.filter(f=>{const y=new Date(f.appointment_date).toDateString(),g=new Date().toDateString();return y===g}),b=s.filter(f=>new Date(f.appointment_date)>new Date&&f.status==="scheduled");return o?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Reception Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Welcome, ",t.name]})]}),e.jsxs("button",{onClick:()=>r(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(kc,{className:"w-5 h-5"}),"New Appointment"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Today's Appointments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:m.length})]}),e.jsx("div",{className:"bg-blue-100 rounded-full p-3",children:e.jsx(it,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Upcoming"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:b.length})]}),e.jsx("div",{className:"bg-green-100 rounded-full p-3",children:e.jsx(tt,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Completed Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:m.filter(f=>f.status==="completed").length})]}),e.jsx("div",{className:"bg-purple-100 rounded-full p-3",children:e.jsx(Ze,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Cancelled"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:m.filter(f=>f.status==="cancelled").length})]}),e.jsx("div",{className:"bg-red-100 rounded-full p-3",children:e.jsx(ls,{className:"w-6 h-6 text-red-600"})})]})})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Today's Schedule"}),m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(it,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No appointments scheduled for today"})]}):e.jsx("div",{className:"space-y-4",children:m.map(f=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:e.jsx(be,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:f.patient_name}),e.jsx("p",{className:"text-sm text-gray-600",children:f.reason||"General checkup"}),e.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[f.patient_phone&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Ki,{className:"w-3 h-3"}),f.patient_phone]}),f.patient_email&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(zt,{className:"w-3 h-3"}),f.patient_email]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:new Date(f.appointment_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${f.status==="completed"?"bg-green-100 text-green-700":f.status==="cancelled"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:f.status}),f.status==="scheduled"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(f.id,"completed"),className:"bg-green-600 text-white px-3 py-1 rounded text-xs hover:bg-green-700 transition-colors",children:"Complete"}),e.jsx("button",{onClick:()=>x(f.id,"cancelled"),className:"bg-red-600 text-white px-3 py-1 rounded text-xs hover:bg-red-700 transition-colors",children:"Cancel"})]})]})]},f.id))})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(V.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl shadow-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Schedule New Appointment"}),e.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient Name *"}),e.jsx("input",{type:"text",value:l.patient_name,onChange:f=>c({...l,patient_name:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter patient name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:l.patient_phone,onChange:f=>c({...l,patient_phone:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+254 XXX XXX XXX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:l.patient_email,onChange:f=>c({...l,patient_email:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"patient@example.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),e.jsx("input",{type:"date",value:l.appointment_date,onChange:f=>c({...l,appointment_date:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time *"}),e.jsx("input",{type:"time",value:l.appointment_time,onChange:f=>c({...l,appointment_time:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for Visit"}),e.jsx("textarea",{value:l.reason,onChange:f=>c({...l,reason:f.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",placeholder:"Enter reason for visit"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>r(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Schedule Appointment"})]})]})})]})}function Ip(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState([]),[o,i]=h.useState(!0),[l,c]=h.useState("");h.useEffect(()=>{d(),u()},[]);const d=async()=>{try{const y=localStorage.getItem("token"),g=await fetch(`${ee}/prescriptions?status=active`,{headers:{Authorization:`Bearer ${y}`}});if(g.ok){const p=await g.json();a(p)}}catch(y){console.error("Failed to load prescriptions:",y)}},u=async()=>{try{const y=localStorage.getItem("token"),g=await fetch(`${ee}/products`,{headers:{Authorization:`Bearer ${y}`}});if(g.ok){const p=await g.json();r(p)}}catch(y){console.error("Failed to load products:",y)}finally{i(!1)}},x=async(y,g)=>{try{const p=localStorage.getItem("token");(await fetch(`${ee}/prescriptions/${y}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({status:"dispensed",dispensed_at:new Date().toISOString(),dispensed_by:t.id})})).ok&&(d(),alert("Prescription dispensed successfully"))}catch(p){console.error("Failed to dispense prescription:",p),alert("Failed to dispense prescription")}},m=s.filter(y=>y.patient_name.toLowerCase().includes(l.toLowerCase())||y.medications.toLowerCase().includes(l.toLowerCase())),b=s.filter(y=>y.status==="active"),f=s.filter(y=>{if(y.status!=="dispensed"||!y.dispensed_at)return!1;const g=new Date(y.dispensed_at).toDateString(),p=new Date().toDateString();return g===p});return o?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Pharmacy Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Welcome, ",t.name]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Active Prescriptions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:b.length})]}),e.jsx("div",{className:"bg-blue-100 rounded-full p-3",children:e.jsx(Ji,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Dispensed Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:f.length})]}),e.jsx("div",{className:"bg-green-100 rounded-full p-3",children:e.jsx(Ze,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Stock Items"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:n.length})]}),e.jsx("div",{className:"bg-purple-100 rounded-full p-3",children:e.jsx(De,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Low Stock Alerts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:n.filter(y=>y.quantity<10).length})]}),e.jsx("div",{className:"bg-orange-100 rounded-full p-3",children:e.jsx(ft,{className:"w-6 h-6 text-orange-600"})})]})})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(Kt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",value:l,onChange:y=>c(y.target.value),placeholder:"Search prescriptions by patient name or medication...",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Pending Prescriptions"}),m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Wa,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No prescriptions found"})]}):e.jsx("div",{className:"space-y-4",children:m.map(y=>e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:e.jsx(Wa,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:y.patient_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Prescribed by Dr. ",y.doctor_name]})]})]}),e.jsxs("div",{className:"ml-11 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Medications"}),e.jsx("p",{className:"text-sm text-gray-900",children:y.medications})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Dosage"}),e.jsx("p",{className:"text-sm text-gray-900",children:y.dosage})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Instructions"}),e.jsx("p",{className:"text-sm text-gray-900",children:y.instructions})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Duration"}),e.jsx("p",{className:"text-sm text-gray-900",children:y.duration})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Date Prescribed"}),e.jsx("p",{className:"text-sm text-gray-900",children:new Date(y.created_at).toLocaleDateString()})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${y.status==="dispensed"?"bg-green-100 text-green-700":y.status==="cancelled"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:y.status}),y.status==="active"&&e.jsxs("button",{onClick:()=>x(y.id,y.medications),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Dispense"]}),y.status==="dispensed"&&y.dispensed_at&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(tt,{className:"w-3 h-3"}),new Date(y.dispensed_at).toLocaleString()]})]})]})},y.id))})]})]})}function Rp(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState([]),[o,i]=h.useState([]),[l,c]=h.useState(null),[d,u]=h.useState(!1),[x,m]=h.useState(!0),[b,f]=h.useState([]);h.useEffect(()=>{y(),g(),p()},[]);const y=async()=>{try{const N=localStorage.getItem("token"),A=await fetch(`${ee}/table-orders`,{headers:{Authorization:`Bearer ${N}`}});if(A.ok){const L=await A.json(),E={};L.forEach(F=>{E[F.table_number]||(E[F.table_number]={table_number:F.table_number,orders:[],total:0,status:F.status}),E[F.table_number].orders.push(F),F.status!=="paid"&&(E[F.table_number].total+=F.total_amount)}),a(Object.values(E))}}catch(N){console.error("Failed to load tables:",N)}},g=async()=>{try{const N=localStorage.getItem("token"),A=await fetch(`${ee}/table-orders`,{headers:{Authorization:`Bearer ${N}`}});if(A.ok){const L=await A.json();r(L)}}catch(N){console.error("Failed to load orders:",N)}},p=async()=>{try{const N=localStorage.getItem("token"),A=await fetch(`${ee}/products?category=drinks`,{headers:{Authorization:`Bearer ${N}`}});if(A.ok){const L=await A.json();i(L)}}catch(N){console.error("Failed to load products:",N)}finally{m(!1)}},v=N=>{const A=b.find(L=>L.product_id===N.id);f(A?b.map(L=>L.product_id===N.id?{...L,quantity:L.quantity+1}:L):[...b,{product_id:N.id,product_name:N.name,price:N.price,quantity:1}])},j=async()=>{if(!(!l||b.length===0))try{const N=localStorage.getItem("token"),A=b.reduce((E,F)=>E+F.price*F.quantity,0);(await fetch(`${ee}/table-orders`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${N}`},body:JSON.stringify({table_number:l,items:b,total_amount:A,status:"pending",waiter_id:t.id,waiter_name:t.name})})).ok&&(u(!1),c(null),f([]),y(),g(),alert("Order created successfully"))}catch(N){console.error("Failed to create order:",N),alert("Failed to create order")}},S=async(N,A)=>{try{const L=localStorage.getItem("token");(await fetch(`${ee}/table-orders/${N}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${L}`},body:JSON.stringify({status:A})})).ok&&(y(),g())}catch(L){console.error("Failed to update order:",L)}},P=n.filter(N=>N.status==="pending"||N.status==="preparing"),T=n.filter(N=>{if(N.status!=="paid")return!1;const A=new Date(N.created_at).toDateString(),L=new Date().toDateString();return A===L}),M=T.reduce((N,A)=>N+A.total_amount,0);return x?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Bar Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Welcome, ",t.name]})]}),e.jsxs("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"New Order"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Active Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:P.length})]}),e.jsx("div",{className:"bg-blue-100 rounded-full p-3",children:e.jsx(tt,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Occupied Tables"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:s.filter(N=>N.status!=="paid").length})]}),e.jsx("div",{className:"bg-green-100 rounded-full p-3",children:e.jsx(be,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Today's Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["KES ",M.toLocaleString()]})]}),e.jsx("div",{className:"bg-purple-100 rounded-full p-3",children:e.jsx($e,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Completed Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:T.length})]}),e.jsx("div",{className:"bg-orange-100 rounded-full p-3",children:e.jsx(Xe,{className:"w-6 h-6 text-orange-600"})})]})})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Active Tables"}),s.filter(N=>N.status!=="paid").length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Cc,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No active tables"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:s.filter(N=>N.status!=="paid").map(N=>e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 hover:shadow-lg transition-shadow cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"font-bold text-gray-900",children:["Table ",N.table_number]}),e.jsx(be,{className:"w-4 h-4 text-blue-600"})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[N.orders.length," orders"]}),e.jsxs("p",{className:"text-lg font-bold text-blue-600 mt-2",children:["KES ",N.total.toLocaleString()]}),e.jsx("div",{className:"flex gap-2 mt-3",children:e.jsx("button",{onClick:()=>{const A=N.orders[N.orders.length-1];A&&S(A.id,"paid")},className:"flex-1 bg-green-600 text-white px-2 py-1 rounded text-xs hover:bg-green-700 transition-colors",children:"Pay"})})]},N.table_number))})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(V.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl shadow-xl max-w-4xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Create New Order"}),e.jsx("button",{onClick:()=>{u(!1),f([]),c(null)},className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Table Number *"}),e.jsx("input",{type:"number",value:l||"",onChange:N=>c(N.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter table number"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Select Items"}),e.jsx("div",{className:"grid grid-cols-3 gap-3 max-h-60 overflow-y-auto",children:o.map(N=>e.jsxs("button",{onClick:()=>v(N),className:"bg-gray-50 hover:bg-blue-50 p-3 rounded-lg text-left transition-colors",children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:N.name}),e.jsxs("p",{className:"text-blue-600 font-bold text-sm",children:["KES ",N.price]})]},N.id))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Order Items"}),b.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No items added"}):e.jsx("div",{className:"space-y-2",children:b.map((N,A)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:N.product_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["KES ",N.price," Ã— ",N.quantity]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{N.quantity>1&&f(b.map(L=>L.product_id===N.product_id?{...L,quantity:L.quantity-1}:L))},className:"bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded",children:"-"}),e.jsx("span",{className:"font-medium",children:N.quantity}),e.jsx("button",{onClick:()=>{f(b.map(L=>L.product_id===N.product_id?{...L,quantity:L.quantity+1}:L))},className:"bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded",children:"+"}),e.jsx("button",{onClick:()=>{f(b.filter(L=>L.product_id!==N.product_id))},className:"text-red-600 hover:text-red-700",children:e.jsx(Qe,{className:"w-5 h-5"})})]})]},A))})]}),e.jsx("div",{className:"border-t pt-4 mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total:"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:["KES ",b.reduce((N,A)=>N+A.price*A.quantity,0).toLocaleString()]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{u(!1),f([]),c(null)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:j,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create Order"})]})]})})]})}function Lp(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState(!1),[o,i]=h.useState(!0),[l,c]=h.useState({guest_name:"",guest_phone:"",guest_email:"",room_number:"",room_type:"",check_in:"",check_out:"",guests_count:1,rate_per_night:0});h.useEffect(()=>{d()},[]);const d=async()=>{try{const p=localStorage.getItem("token"),v=await fetch(`${ee}/room-bookings`,{headers:{Authorization:`Bearer ${p}`}});if(v.ok){const j=await v.json();a(j)}}catch(p){console.error("Failed to load bookings:",p)}finally{i(!1)}},u=async()=>{try{const p=localStorage.getItem("token"),v=new Date(l.check_in),j=new Date(l.check_out),P=Math.ceil((j-v)/(1e3*60*60*24))*l.rate_per_night;(await fetch(`${ee}/room-bookings`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify({guest_name:l.guest_name,guest_phone:l.guest_phone,guest_email:l.guest_email,room_number:l.room_number,room_type:l.room_type,check_in:l.check_in,check_out:l.check_out,guests_count:l.guests_count,rate_per_night:l.rate_per_night,total_amount:P,status:"confirmed",booked_by:t.id})})).ok&&(r(!1),c({guest_name:"",guest_phone:"",guest_email:"",room_number:"",room_type:"",check_in:"",check_out:"",guests_count:1,rate_per_night:0}),d(),alert("Booking created successfully"))}catch(p){console.error("Failed to create booking:",p),alert("Failed to create booking")}},x=async p=>{try{const v=localStorage.getItem("token");(await fetch(`${ee}/room-bookings/${p}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify({status:"checked_in"})})).ok&&d()}catch(v){console.error("Failed to check in:",v)}},m=async p=>{try{const v=localStorage.getItem("token");(await fetch(`${ee}/room-bookings/${p}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify({status:"checked_out"})})).ok&&(d(),alert("Guest checked out successfully"))}catch(v){console.error("Failed to check out:",v)}},b=s.filter(p=>p.status==="confirmed"||p.status==="checked_in"),f=s.filter(p=>{if(p.status!=="checked_in")return!1;const v=new Date(p.check_in).toDateString(),j=new Date().toDateString();return v===j}),y=s.filter(p=>p.status==="checked_in").length,g=s.filter(p=>{const v=new Date(p.check_in).toDateString(),j=new Date().toDateString();return v===j&&p.status!=="cancelled"}).reduce((p,v)=>p+v.total_amount,0);return o?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Hotel Dashboard"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Welcome, ",t.name]})]}),e.jsxs("button",{onClick:()=>r(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"New Booking"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Occupied Rooms"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:y})]}),e.jsx("div",{className:"bg-blue-100 rounded-full p-3",children:e.jsx(Ha,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Active Bookings"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:b.length})]}),e.jsx("div",{className:"bg-green-100 rounded-full p-3",children:e.jsx(it,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Today's Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:["KES ",g.toLocaleString()]})]}),e.jsx("div",{className:"bg-purple-100 rounded-full p-3",children:e.jsx($e,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Check-ins Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:f.length})]}),e.jsx("div",{className:"bg-orange-100 rounded-full p-3",children:e.jsx(be,{className:"w-6 h-6 text-orange-600"})})]})})]}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Current Bookings"}),b.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No active bookings"})]}):e.jsx("div",{className:"space-y-4",children:b.map(p=>{const v=new Date(p.check_in),j=new Date(p.check_out),S=Math.ceil((j-v)/(1e3*60*60*24));return e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"bg-blue-100 rounded-full p-2",children:e.jsx(pt,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:p.guest_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Room ",p.room_number," â€¢ ",p.room_type]})]})]}),e.jsxs("div",{className:"ml-11 grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Check-in"}),e.jsx("p",{className:"text-sm text-gray-900",children:v.toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Check-out"}),e.jsx("p",{className:"text-sm text-gray-900",children:j.toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Duration"}),e.jsxs("p",{className:"text-sm text-gray-900",children:[S," night",S>1?"s":""]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Guests"}),e.jsx("p",{className:"text-sm text-gray-900",children:p.guests_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Rate/Night"}),e.jsxs("p",{className:"text-sm text-gray-900",children:["KES ",p.rate_per_night?.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Total"}),e.jsxs("p",{className:"text-sm font-bold text-blue-600",children:["KES ",p.total_amount?.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${p.status==="checked_in"?"bg-green-100 text-green-700":p.status==="confirmed"?"bg-blue-100 text-blue-700":p.status==="checked_out"?"bg-gray-100 text-gray-700":"bg-red-100 text-red-700"}`,children:p.status.replace("_"," ")}),p.status==="confirmed"&&e.jsxs("button",{onClick:()=>x(p.id),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Check In"]}),p.status==="checked_in"&&e.jsxs("button",{onClick:()=>m(p.id),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),"Check Out"]})]})]})},p.id)})})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(V.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl shadow-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"New Booking"}),e.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600",children:"âœ•"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guest Name *"}),e.jsx("input",{type:"text",value:l.guest_name,onChange:p=>c({...l,guest_name:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter guest name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:l.guest_phone,onChange:p=>c({...l,guest_phone:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+254 XXX XXX XXX"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:l.guest_email,onChange:p=>c({...l,guest_email:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"guest@example.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Room Number *"}),e.jsx("input",{type:"text",value:l.room_number,onChange:p=>c({...l,room_number:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"101"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Room Type *"}),e.jsxs("select",{value:l.room_type,onChange:p=>c({...l,room_type:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select room type"}),e.jsx("option",{value:"Single",children:"Single"}),e.jsx("option",{value:"Double",children:"Double"}),e.jsx("option",{value:"Suite",children:"Suite"}),e.jsx("option",{value:"Deluxe",children:"Deluxe"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Check-in Date *"}),e.jsx("input",{type:"date",value:l.check_in,onChange:p=>c({...l,check_in:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Check-out Date *"}),e.jsx("input",{type:"date",value:l.check_out,onChange:p=>c({...l,check_out:p.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Guests"}),e.jsx("input",{type:"number",value:l.guests_count,onChange:p=>c({...l,guests_count:parseInt(p.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rate per Night (KES)"}),e.jsx("input",{type:"number",value:l.rate_per_night,onChange:p=>c({...l,rate_per_night:parseFloat(p.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0"})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>r(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create Booking"})]})]})})]})}function Mp(){const{user:t,logout:s}=re(),a=Ee(),[n,r]=h.useState("overview"),[o,i]=h.useState(!1),[l,c]=h.useState({totalProducts:0,lowStockItems:0,todaySales:0,activeCashiers:0});h.useEffect(()=>{if(!t){a("/auth/login");return}d()},[t,a]);const d=async()=>{i(!0);try{c({totalProducts:0,lowStockItems:0,todaySales:0,activeCashiers:0})}catch(m){console.error("Error loading dashboard data:",m)}finally{i(!1)}},u=()=>{s(),a("/auth/login")},x=[{id:"overview",label:"Overview",icon:Ae},{id:"products",label:"Products",icon:De},{id:"cashiers",label:"Cashiers",icon:be},{id:"reports",label:"Reports",icon:$e},{id:"settings",label:"Settings",icon:Gi}];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Supermarket Admin Dashboard"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[t?.name," â€¢ ",t?.email]})]}),e.jsxs("button",{onClick:u,className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(ot,{className:"w-4 h-4"}),e.jsx("span",{children:"Logout"})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Products"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:l.totalProducts})]}),e.jsx(De,{className:"w-12 h-12 text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Low Stock Items"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:l.lowStockItems})]}),e.jsx(ft,{className:"w-12 h-12 text-orange-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Today's Sales"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["KES ",l.todaySales.toLocaleString()]})]}),e.jsx($e,{className:"w-12 h-12 text-green-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Cashiers"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:l.activeCashiers})]}),e.jsx(be,{className:"w-12 h-12 text-purple-500"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex -mb-px",children:x.map(m=>{const b=m.icon;return e.jsxs("button",{onClick:()=>r(m.id),className:`flex items-center gap-2 px-6 py-4 border-b-2 font-medium text-sm transition-colors ${n===m.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(b,{className:"w-5 h-5"}),m.label]},m.id)})})}),e.jsxs("div",{className:"p-6",children:[n==="overview"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Welcome to your Supermarket Dashboard"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Manage your retail operations efficiently with our comprehensive tools."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Quick Actions"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add new products to inventory"]}),e.jsxs("li",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(be,{className:"w-4 h-4"}),"Manage cashier accounts"]}),e.jsxs("li",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Ae,{className:"w-4 h-4"}),"View sales reports"]})]})]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Recent Activity"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No recent activity"})]})]})]}),n==="products"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Product Inventory"}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Product"]})]}),e.jsxs("div",{className:"text-gray-600",children:[e.jsx("p",{children:"Product management interface will appear here."}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Features: Barcode scanning, stock management, pricing, and more."})]})]}),n==="cashiers"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Cashier Management"}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Cashier"]})]}),e.jsx("div",{className:"text-gray-600",children:e.jsx("p",{children:"Cashier management interface will appear here."})})]}),n==="reports"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Sales Reports"}),e.jsx("div",{className:"text-gray-600",children:e.jsx("p",{children:"Detailed sales analytics and reports will appear here."})})]}),n==="settings"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Name"}),e.jsx("input",{type:"text",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter business name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax Rate (%)"}),e.jsx("input",{type:"number",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]})]})]})]})]})]})]})}function Fp(){const{user:t}=re(),s=Ee();if(h.useEffect(()=>{if(!t){s("/auth/login");return}if(!Ap(t)){t.role==="admin"?(console.log("[PRO ROUTER] Not a Pro user - redirecting admin to /admin"),s("/admin")):t.role==="cashier"?(console.log("[PRO ROUTER] Not a Pro user - redirecting cashier to /cashier"),s("/cashier")):(console.log("[PRO ROUTER] Not a Pro user - redirecting to /dashboard"),s("/dashboard"));return}if(!Dp(t)&&t.role==="admin"){console.log("[PRO ROUTER] Pro admin without business type - redirecting to /select-business-type"),s("/select-business-type");return}console.log("[PRO ROUTER] Pro user with business type:",t.businessType||t.business_type,"- rendering dashboard")},[t,s]),!t)return null;const a=t.businessType||t.business_type||localStorage.getItem("businessType")||localStorage.getItem("selectedBusinessType"),n=t.businessRole||t.business_role||t.role;if(console.log("[PRO PLAN ROUTER] Business Type:",a,"Role:",n,"User:",t),!a)return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Business Type Not Set"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Please select your business type to continue."}),e.jsx("button",{onClick:()=>s("/select-business-type"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Select Business Type"})]})});if(a==="clinic")switch(n){case"doctor":return e.jsx(Ep,{});case"reception":return e.jsx(Fi,{});case"pharmacy":return e.jsx(Ip,{});default:return e.jsx(Fi,{})}return a==="bar"||a==="restaurant"?e.jsx(Rp,{}):a==="hotel"?e.jsx(Lp,{}):a==="supermarket"||a==="retail"?e.jsx(Mp,{}):a==="hospital"||a==="pharmacy"||a==="petrol"||a==="school"||a==="gym"||a==="salon"?(console.log(`[PRO PLAN ROUTER] Using standard admin dashboard for ${a}`),e.jsx(da,{})):(console.warn("[PRO PLAN ROUTER] Unknown business type, using default admin dashboard"),e.jsx(da,{}))}function Op(){const{user:t}=re(),s=Ee(),[a,n]=h.useState(!1),[r,o]=h.useState(null),[i,l]=h.useState([]),[c,d]=h.useState(""),u={Utensils:qa,Hotel:pt,Stethoscope:ua,Building2:Dc,ShoppingCart:ct,ChefHat:qa,Pill:Wa,Fuel:Xi,GraduationCap:Ac,Dumbbell:Tc,Scissors:Pc,Store:Ka};h.useEffect(()=>{if(!t||!["pro","custom"].includes(t.plan)){s("/admin");return}if(t.businessType||t.business_type){s("/pro-dashboard");return}x()},[t,s]);const x=async()=>{try{const f=localStorage.getItem("token"),y=await fetch("http://localhost:5000/api/business/business-types",{headers:{Authorization:`Bearer ${f}`}});if(!y.ok)throw new Error("Failed to load business types");const g=await y.json();g.success&&l(g.businessTypes)}catch(f){console.error("Error loading business types:",f),d("Failed to load business types. Please try again.")}},m=f=>{o(f)},b=async()=>{if(!r){d("Please select a business type");return}n(!0),d("");try{const f=localStorage.getItem("token"),y=await fetch("http://localhost:5000/api/business/select",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${f}`},body:JSON.stringify({business_type:r.id})}),g=await y.json();if(y.ok&&g.success){const p=localStorage.getItem("user");if(p){const v=JSON.parse(p);v.businessType=r.id,v.business_type=r.id,localStorage.setItem("user",JSON.stringify(v))}localStorage.setItem("businessType",r.id),localStorage.setItem("selectedBusinessType",r.id),console.log("âœ… Business type selected:",r.id),s("/pro-dashboard")}else d(g.error||"Failed to set business type")}catch(f){console.error("Error setting business type:",f),d("An error occurred. Please try again.")}finally{n(!1)}};return t?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Choose Your Business Type"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Select the business type that best describes your operation. This will customize your dashboard and features."}),e.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-800 rounded-full",children:[e.jsx(Xe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Pro Plan Activated"})]})]}),c&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 text-center",children:c}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:i.map(f=>{const y=u[f.icon]||Ka,g=r?.id===f.id;return e.jsxs("button",{onClick:()=>m(f),className:`relative p-6 rounded-xl border-2 transition-all ${g?"border-blue-500 bg-blue-50 shadow-lg scale-105":"border-gray-200 bg-white hover:border-blue-300 hover:shadow-md"}`,children:[g&&e.jsx("div",{className:"absolute top-4 right-4 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(Xe,{className:"w-4 h-4 text-white"})}),e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center mb-4 ${g?"bg-blue-100":"bg-gray-100"}`,children:e.jsx(y,{className:`w-8 h-8 ${g?"text-blue-600":"text-gray-600"}`})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:f.name}),e.jsx("p",{className:"text-sm text-gray-600",children:f.description})]},f.id)})}),r&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8 animate-fade-in",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:r.name}),e.jsx("p",{className:"text-gray-600 mb-4",children:r.description}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:b,disabled:a,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed font-semibold shadow-md hover:shadow-lg",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Setting up..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Confirm & Continue"}),e.jsx(Zs,{className:"w-5 h-5"})]})}),e.jsx("button",{onClick:()=>o(null),disabled:a,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Change Selection"})]})]}),e.jsx("div",{className:"text-center text-gray-500 text-sm",children:e.jsx("p",{children:"You can change your business type later from the settings menu."})})]})}):null}function Oi(){const t=Ee(),{user:s}=re(),[a,n]=h.useState({x:0,y:0}),[r,o]=h.useState(!1),{scrollY:i}=cp(),l=h.useRef(null),c=h.useRef(null),d=Ys(i,[0,500],[0,150]),u=Ys(i,[0,300],[1,0]),x=Ys(i,[0,800],[0,200]);h.useEffect(()=>{const f=y=>{n({x:(y.clientX-window.innerWidth/2)/50,y:(y.clientY-window.innerHeight/2)/50})};return window.addEventListener("mousemove",f),()=>window.removeEventListener("mousemove",f)},[]);const m=[{icon:Qs,title:"Real-Time Sync",description:"Instant inventory updates across all devices with WebSocket technology",color:"from-[#8b5a2b] to-[#00ff88]"},{icon:Tt,title:"Bank-Level Security",description:"Enterprise-grade encryption and role-based access control",color:"from-[#cd853f] to-[#ff6b35]"},{icon:Ae,title:"Smart Analytics",description:"AI-powered insights to boost revenue and optimize inventory",color:"from-[#8b5a2b] via-[#00ff88] to-[#ff6b35]"},{icon:De,title:"Inventory Management",description:"Automated stock tracking with low-stock alerts and reordering",color:"from-[#d2691e] to-[#00ff88]"},{icon:be,title:"Multi-User Access",description:"Team collaboration with customizable permissions per role",color:"from-[#cd853f] to-[#8b5a2b]"},{icon:bn,title:"Advanced Reports",description:"Comprehensive sales reports with trend analysis and forecasting",color:"from-[#ff6b35] to-[#cd853f]"}],b=[{value:"99.9%",label:"Uptime SLA"},{value:"<50ms",label:"Response Time"},{value:"10K+",label:"Businesses"},{value:"24/7",label:"Support"}];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#2c1810] via-[#3d2817] to-[#1a0f08] overflow-hidden relative",children:[e.jsx("div",{className:"fixed inset-0 opacity-10 pointer-events-none",children:e.jsxs("svg",{className:"w-full h-full",children:[e.jsx("defs",{children:e.jsxs("pattern",{id:"africanPattern",x:"0",y:"0",width:"120",height:"120",patternUnits:"userSpaceOnUse",children:[e.jsx("path",{d:"M 60 10 L 70 30 L 90 30 L 75 45 L 80 65 L 60 50 L 40 65 L 45 45 L 30 30 L 50 30 Z",fill:"rgba(139, 90, 43, 0.3)"}),e.jsx("circle",{cx:"20",cy:"20",r:"3",fill:"rgba(205, 133, 63, 0.4)"}),e.jsx("circle",{cx:"100",cy:"20",r:"3",fill:"rgba(205, 133, 63, 0.4)"}),e.jsx("circle",{cx:"20",cy:"100",r:"3",fill:"rgba(205, 133, 63, 0.4)"}),e.jsx("circle",{cx:"100",cy:"100",r:"3",fill:"rgba(205, 133, 63, 0.4)"}),e.jsx("rect",{x:"55",y:"85",width:"10",height:"10",fill:"rgba(139, 90, 43, 0.2)",transform:"rotate(45 60 90)"})]})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#africanPattern)"})]})}),e.jsxs(V.div,{style:{y:x},className:"fixed inset-0 pointer-events-none opacity-20",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#8b5a2b]/20 via-transparent to-[#cd853f]/20"}),e.jsxs("svg",{className:"absolute inset-0 w-full h-full",children:[e.jsxs("defs",{children:[e.jsxs("pattern",{id:"woodGrain",width:"80",height:"80",patternUnits:"userSpaceOnUse",children:[e.jsx("path",{d:"M 0 40 Q 20 35, 40 40 T 80 40",fill:"none",stroke:"url(#woodGradient)",strokeWidth:"0.5",opacity:"0.4"}),e.jsx("path",{d:"M 0 45 Q 20 42, 40 45 T 80 45",fill:"none",stroke:"url(#woodGradient)",strokeWidth:"0.3",opacity:"0.3"})]}),e.jsxs("linearGradient",{id:"woodGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#8b5a2b",stopOpacity:"0.6"}),e.jsx("stop",{offset:"50%",stopColor:"#cd853f",stopOpacity:"0.4"}),e.jsx("stop",{offset:"100%",stopColor:"#d2691e",stopOpacity:"0.5"})]})]}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#woodGrain)"})]})]}),e.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[e.jsx(V.div,{animate:{x:[0,80,0],y:[0,-80,0]},transition:{duration:25,repeat:1/0,ease:"easeInOut"},className:"absolute top-1/4 left-1/4 w-96 h-96 bg-gradient-to-br from-[#8b5a2b]/30 via-[#00ff88]/10 to-transparent rounded-full blur-3xl"}),e.jsx(V.div,{animate:{x:[0,-80,0],y:[0,80,0]},transition:{duration:30,repeat:1/0,ease:"easeInOut"},className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-gradient-to-br from-[#cd853f]/30 via-[#ff6b35]/10 to-transparent rounded-full blur-3xl"}),e.jsx(V.div,{animate:{x:[0,60,0],y:[0,-60,0]},transition:{duration:20,repeat:1/0,ease:"easeInOut"},className:"absolute top-1/2 right-1/3 w-64 h-64 bg-gradient-to-br from-[#d2691e]/20 to-transparent rounded-full blur-2xl"})]}),e.jsx("nav",{className:"sticky top-0 z-50 px-6 py-6 bg-gradient-to-r from-[#2c1810]/95 via-[#3d2817]/95 to-[#2c1810]/95 backdrop-blur-xl border-b border-[#8b5a2b]/20",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs(V.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#8b5a2b] via-[#00ff88] to-[#cd853f] rounded-xl flex items-center justify-center shadow-lg shadow-[#8b5a2b]/40",children:e.jsx(lr,{className:"w-6 h-6 text-[#f5deb3]"})}),e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-[#f5deb3] via-[#00ff88] to-[#ff6b35] bg-clip-text text-transparent",children:"PosiFine"})]}),e.jsxs(V.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"flex items-center gap-6",children:[e.jsx("a",{href:"#features",className:"text-[#e8c39e] hover:text-white font-medium transition-colors hidden md:block",children:"Features"}),e.jsx("a",{href:"#pricing",className:"text-[#e8c39e] hover:text-white font-medium transition-colors hidden md:block",children:"Pricing"}),e.jsx("button",{onClick:()=>t("/auth/login"),className:"px-6 py-2.5 text-[#f5deb3] hover:text-white font-medium transition-colors",children:"Login"}),e.jsx("button",{onClick:()=>t("/choose-subscription"),className:"px-6 py-2.5 bg-gradient-to-r from-[#8b5a2b] via-[#00ff88] to-[#cd853f] text-white rounded-full font-medium shadow-lg shadow-[#8b5a2b]/40 hover:shadow-xl hover:shadow-[#00ff88]/50 transition-all hover:scale-105",children:"Get Started"})]})]})}),e.jsx(V.section,{ref:l,style:{y:d,opacity:u},className:"relative z-10 pt-20 pb-32 px-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-16 items-center",children:[e.jsx("div",{children:e.jsxs(V.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsx(V.span,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"inline-block px-4 py-2 bg-gradient-to-r from-[#8b5a2b]/20 to-[#00ff88]/20 border border-[#8b5a2b]/40 rounded-full text-sm font-medium mb-6",children:e.jsx("span",{className:"bg-gradient-to-r from-[#cd853f] to-[#00ff88] bg-clip-text text-transparent",children:"âš¡ Next-Generation POS Technology"})}),e.jsxs("h1",{className:"text-6xl lg:text-7xl font-bold leading-tight mb-6",children:[e.jsx("span",{className:"text-[#f5deb3]",children:"Elevate Your"}),e.jsx("br",{}),e.jsx("span",{className:"bg-gradient-to-r from-[#8b5a2b] via-[#00ff88] to-[#ff6b35] bg-clip-text text-transparent",children:"Business Today"})]}),e.jsx("p",{className:"text-xl text-[#e8c39e] mb-8 leading-relaxed",children:"Experience the future of point-of-sale with real-time sync, intelligent analytics, and enterprise-grade security. Built for modern businesses that demand excellence."}),e.jsxs("div",{className:"flex flex-wrap gap-4 mb-12",children:[e.jsxs(V.button,{onClick:()=>t("/choose-subscription"),whileHover:{scale:1.05},whileTap:{scale:.95},className:"group px-8 py-4 bg-gradient-to-r from-[#8b5a2b] via-[#00ff88] to-[#cd853f] text-white rounded-full font-semibold shadow-xl shadow-[#8b5a2b]/40 hover:shadow-2xl hover:shadow-[#00ff88]/50 transition-all flex items-center gap-2",children:["Start Free Trial",e.jsx(Zs,{className:"w-5 h-5 group-hover:translate-x-1 transition-transform"})]}),e.jsxs(V.button,{onClick:()=>o(!0),whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-8 py-4 bg-[#3d2817]/80 backdrop-blur-xl border-2 border-[#8b5a2b]/40 text-[#f5deb3] rounded-full font-semibold hover:border-[#00ff88]/60 transition-all flex items-center gap-2 group",children:[e.jsx(Vs,{className:"w-5 h-5 text-[#ff6b35]"}),"Watch Demo"]})]}),e.jsxs("div",{className:"flex items-center gap-8 text-sm text-[#e8c39e]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5 text-[#00ff88]"}),e.jsx("span",{children:"No credit card"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5 text-[#00ff88]"}),e.jsx("span",{children:"14-day trial"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5 text-[#00ff88]"}),e.jsx("span",{children:"Cancel anytime"})]})]})]})}),e.jsx("div",{className:"relative",children:e.jsxs(V.div,{style:{x:a.x,y:a.y},className:"relative",children:[e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"relative bg-[#3d2817]/80 backdrop-blur-xl rounded-3xl p-6 shadow-2xl border border-[#8b5a2b]/40",style:{boxShadow:"0 0 80px rgba(139, 90, 43, 0.3), 0 0 40px rgba(0, 255, 136, 0.2)"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#8b5a2b] to-[#00ff88] rounded-xl"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-3 w-24 bg-[#2c1810]/60 rounded"}),e.jsx("div",{className:"h-2 w-16 bg-[#2c1810]/40 rounded mt-1"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-[#2c1810]/40 rounded-lg"}),e.jsx("div",{className:"w-8 h-8 bg-[#2c1810]/40 rounded-lg"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs(V.div,{whileHover:{scale:1.05},className:"bg-gradient-to-br from-[#8b5a2b]/30 to-[#00ff88]/20 rounded-2xl p-4 border border-[#8b5a2b]/30",children:[e.jsx("div",{className:"text-xs text-[#d2a679] mb-1",children:"Revenue"}),e.jsx("div",{className:"text-2xl font-bold bg-gradient-to-r from-[#cd853f] to-[#00ff88] bg-clip-text text-transparent",children:"$12,450"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-[#00ff88] mt-1",children:[e.jsx(Ae,{className:"w-3 h-3"}),e.jsx("span",{children:"+12.5%"})]})]}),e.jsxs(V.div,{whileHover:{scale:1.05},className:"bg-gradient-to-br from-[#cd853f]/30 to-[#ff6b35]/20 rounded-2xl p-4 border border-[#cd853f]/30",children:[e.jsx("div",{className:"text-xs text-[#d2a679] mb-1",children:"Orders"}),e.jsx("div",{className:"text-2xl font-bold bg-gradient-to-r from-[#ff6b35] to-[#ff8c42] bg-clip-text text-transparent",children:"1,247"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-[#ff6b35] mt-1",children:[e.jsx(Qs,{className:"w-3 h-3"}),e.jsx("span",{children:"Live"})]})]})]}),e.jsx("div",{className:"relative h-40 bg-gradient-to-br from-[#2c1810]/80 to-[#1a0f08]/90 rounded-2xl p-4 overflow-hidden",children:e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 400 100",children:[e.jsx(V.path,{d:"M 0 80 Q 50 60, 100 70 T 200 65 T 300 55 T 400 50",fill:"none",stroke:"url(#chartGradient)",strokeWidth:"3",initial:{pathLength:0},animate:{pathLength:1},transition:{duration:2,ease:"easeInOut"}}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"chartGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#8b5a2b"}),e.jsx("stop",{offset:"50%",stopColor:"#00ff88"}),e.jsx("stop",{offset:"100%",stopColor:"#ff6b35"})]})})]})})]}),e.jsx(V.div,{initial:{opacity:0,x:20,y:-20},animate:{opacity:1,x:0,y:0},transition:{delay:.4},className:"absolute -top-8 -right-8 bg-[#3d2817]/90 backdrop-blur-xl rounded-2xl p-4 shadow-xl border border-[#8b5a2b]/40",style:{boxShadow:"0 0 40px rgba(0, 255, 136, 0.3)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-[#8b5a2b] to-[#00ff88] rounded-xl flex items-center justify-center",children:e.jsx(ps,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#d2a679]",children:"Live Updates"}),e.jsx("div",{className:"text-sm font-bold text-[#f5deb3]",children:"Real-time Sync"})]})]})}),e.jsx(V.div,{initial:{opacity:0,x:-20,y:20},animate:{opacity:1,x:0,y:0},transition:{delay:.6},className:"absolute -bottom-8 -left-8 bg-[#3d2817]/90 backdrop-blur-xl rounded-2xl p-4 shadow-xl border border-[#cd853f]/40",style:{boxShadow:"0 0 40px rgba(255, 107, 53, 0.3)"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-[#ff6b35] to-[#ff8c42] rounded-xl flex items-center justify-center",children:e.jsx(Tt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-[#d2a679]",children:"Security"}),e.jsx("div",{className:"text-sm font-bold text-[#f5deb3]",children:"Bank-Level"})]})]})})]})})]})})}),e.jsx(Ml,{children:r&&e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",onClick:()=>o(!1),children:e.jsxs(V.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"relative w-full max-w-4xl bg-gradient-to-br from-[#3d2817] via-[#2c1810] to-[#1a0f08] rounded-3xl shadow-2xl border border-[#8b5a2b]/40 overflow-hidden",onClick:f=>f.stopPropagation(),children:[e.jsx("button",{onClick:()=>o(!1),className:"absolute top-4 right-4 z-10 w-10 h-10 flex items-center justify-center bg-[#2c1810]/80 backdrop-blur-xl rounded-full border border-[#8b5a2b]/40 text-[#f5deb3] hover:text-white hover:border-[#00ff88]/60 transition-all hover:scale-110",children:e.jsx(Qe,{className:"w-5 h-5"})}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-[#f5deb3] via-[#00ff88] to-[#ff6b35] bg-clip-text text-transparent mb-2",children:"PosiFine Demo"}),e.jsx("p",{className:"text-[#d2a679]",children:"See how our premium POS system transforms retail management"})]}),e.jsx("div",{className:"relative aspect-video bg-[#1a0f08]/90 rounded-2xl overflow-hidden border border-[#8b5a2b]/30",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-br from-[#8b5a2b] via-[#00ff88] to-[#cd853f] rounded-full flex items-center justify-center shadow-xl shadow-[#8b5a2b]/40",children:e.jsx(Vs,{className:"w-10 h-10 text-white ml-1"})}),e.jsx("p",{className:"text-[#d2a679] text-lg",children:"Demo Video Coming Soon"}),e.jsx("p",{className:"text-[#8b5a2b] text-sm mt-2",children:"Experience real-time sync, analytics, and seamless operations"})]})})}),e.jsx("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[{icon:ps,label:"Real-time Sync"},{icon:Ae,label:"Live Analytics"},{icon:Tt,label:"Secure Payments"}].map((f,y)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-[#2c1810]/60 rounded-xl border border-[#8b5a2b]/30",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#8b5a2b] to-[#00ff88] rounded-lg flex items-center justify-center",children:e.jsx(f.icon,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-[#f5deb3] text-sm font-medium",children:f.label})]},y))}),e.jsxs("div",{className:"mt-6 flex gap-4",children:[e.jsx("button",{onClick:()=>{o(!1),t("/choose-subscription")},className:"flex-1 px-6 py-3 bg-gradient-to-r from-[#8b5a2b] via-[#00ff88] to-[#cd853f] text-white rounded-xl font-semibold shadow-lg shadow-[#8b5a2b]/40 hover:shadow-xl hover:shadow-[#00ff88]/50 transition-all hover:scale-105",children:"Start Free Trial"}),e.jsx("button",{onClick:()=>o(!1),className:"px-6 py-3 bg-[#2c1810]/80 backdrop-blur-xl text-[#f5deb3] rounded-xl font-semibold border border-[#8b5a2b]/40 hover:border-[#00ff88]/60 transition-all hover:scale-105",children:"Close"})]})]})]})})}),e.jsx("section",{className:"relative z-10 py-16 px-6 bg-gradient-to-r from-[#2c1810]/80 via-[#3d2817]/70 to-[#2c1810]/80 border-y border-[#8b5a2b]/30",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-8",children:b.map((f,y)=>e.jsxs(V.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:y*.1},className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold bg-gradient-to-r from-[#cd853f] via-[#00ff88] to-[#ff6b35] bg-clip-text text-transparent mb-2",children:f.value}),e.jsx("div",{className:"text-[#e8c39e] font-medium",children:f.label})]},y))})})}),e.jsx("section",{id:"features",ref:c,className:"relative z-10 py-32 px-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(V.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mb-16",children:[e.jsx("span",{className:"inline-block px-4 py-2 bg-gradient-to-r from-[#8b5a2b]/20 to-[#00ff88]/20 border border-[#8b5a2b]/40 rounded-full text-sm font-medium mb-6",children:e.jsx("span",{className:"bg-gradient-to-r from-[#cd853f] to-[#00ff88] bg-clip-text text-transparent",children:"Features that matter"})}),e.jsxs("h2",{className:"text-5xl font-bold mb-6",children:[e.jsx("span",{className:"text-[#f5deb3]",children:"Built for"})," ",e.jsx("span",{className:"bg-gradient-to-r from-[#8b5a2b] via-[#00ff88] to-[#ff6b35] bg-clip-text text-transparent",children:"Performance"})]}),e.jsx("p",{className:"text-xl text-[#e8c39e] max-w-2xl mx-auto",children:"Everything you need to run your business efficiently, all in one beautiful platform"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-8",children:m.map((f,y)=>e.jsxs(V.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:y*.1},whileHover:{y:-10},className:"group relative bg-[#3d2817]/80 backdrop-blur-xl rounded-3xl p-8 shadow-lg border border-[#8b5a2b]/40 hover:shadow-2xl hover:shadow-[#8b5a2b]/50 transition-all duration-300",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${f.color} opacity-0 group-hover:opacity-20 rounded-3xl transition-opacity duration-300`}),e.jsx("div",{className:`w-14 h-14 bg-gradient-to-br ${f.color} rounded-2xl flex items-center justify-center mb-6 shadow-lg shadow-[#8b5a2b]/40`,children:e.jsx(f.icon,{className:"w-7 h-7 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-[#f5f0e8] mb-3",children:f.title}),e.jsx("p",{className:"text-[#e8c39e] leading-relaxed",children:f.description}),e.jsxs("div",{className:"mt-6 flex items-center gap-2 text-sm font-medium opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("span",{className:`bg-gradient-to-r ${f.color} bg-clip-text text-transparent`,children:"Learn more"}),e.jsx(Ec,{className:"w-4 h-4 text-[#00ff88] group-hover:translate-x-1 transition-transform"})]})]},y))})]})}),e.jsx("section",{className:"relative z-10 py-32 px-6",children:e.jsx("div",{className:"max-w-5xl mx-auto",children:e.jsxs(V.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"relative bg-gradient-to-br from-[#8b5a2b] via-[#cd853f] to-[#d2691e] rounded-[3rem] p-16 overflow-hidden shadow-2xl shadow-[#8b5a2b]/50",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",children:e.jsxs("svg",{className:"w-full h-full",children:[e.jsxs("pattern",{id:"ctaPattern",width:"60",height:"60",patternUnits:"userSpaceOnUse",children:[e.jsx("circle",{cx:"30",cy:"30",r:"2",fill:"white"}),e.jsx("path",{d:"M 30 20 L 35 30 L 30 40 L 25 30 Z",fill:"white",opacity:"0.5"})]}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#ctaPattern)"})]})}),e.jsxs("div",{className:"relative z-10 text-center",children:[e.jsx("h2",{className:"text-5xl font-bold text-white mb-6",children:"Ready to Transform Your Business?"}),e.jsx("p",{className:"text-xl text-white/90 mb-10 max-w-2xl mx-auto",children:"Join thousands of businesses using PosiFine to streamline operations and boost revenue"}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[e.jsxs(V.button,{onClick:()=>t("/choose-subscription"),whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-10 py-5 bg-white text-[#8b5a2b] rounded-full font-bold text-lg shadow-2xl hover:shadow-3xl transition-all flex items-center gap-2",children:["Start Free Trial",e.jsx(Zs,{className:"w-5 h-5"})]}),e.jsxs(V.button,{onClick:()=>o(!0),whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-10 py-5 bg-white/10 backdrop-blur-xl text-white border-2 border-white/30 rounded-full font-bold text-lg hover:bg-white/20 transition-all flex items-center gap-2",children:[e.jsx(Vs,{className:"w-5 h-5"}),"Watch Demo"]})]}),e.jsx("p",{className:"text-white/80 text-sm mt-8",children:"No credit card required â€¢ 14-day free trial â€¢ Cancel anytime"})]})]})})}),e.jsx("footer",{className:"relative z-10 bg-gradient-to-br from-[#2c1810] via-[#1a0f08] to-[#0d0604] py-12 px-6 border-t border-[#8b5a2b]/30",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#8b5a2b] via-[#00ff88] to-[#cd853f] rounded-xl flex items-center justify-center shadow-lg shadow-[#8b5a2b]/40",children:e.jsx(lr,{className:"w-6 h-6 text-white"})}),e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-[#f5deb3] via-[#00ff88] to-[#ff6b35] bg-clip-text text-transparent",children:"PosiFine"})]}),e.jsx("p",{className:"text-[#e8c39e] text-sm",children:"Â© 2026 Mabrixel Technologies. All rights reserved."}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-[#e8c39e]",children:[e.jsx("button",{onClick:()=>t("/choose-subscription"),className:"hover:text-[#f5deb3] transition-colors",children:"Pricing"}),e.jsx("button",{onClick:()=>t("/auth/login"),className:"hover:text-[#f5deb3] transition-colors",children:"Login"})]})]})})})]})}function $i(){const t=Bi(),[s,a]=h.useState(t.pathname==="/auth/login"),[n,r]=h.useState("password"),[o,i]=h.useState({email:"",password:"",pin:"",name:"",newPassword:"",confirmPassword:""}),[l,c]=h.useState(""),[d,u]=h.useState(!1),[x,m]=h.useState(!1),b=Ee(),{login:f}=re(),y=()=>{try{return JSON.parse(localStorage.getItem("selectedPlan")||"null")}catch(p){return console.warn("Invalid selectedPlan in localStorage:",p),null}},g=async p=>{p.preventDefault(),c(""),u(!0);try{if(x){if(o.newPassword!==o.confirmPassword){c("Passwords do not match"),u(!1);return}if(o.newPassword.length<6){c("Password must be at least 6 characters"),u(!1);return}const S=await Ft.login({email:o.email,newPassword:o.newPassword});S.token&&S.user&&(await f(S),b("/dashboard"));return}if(s){if(n==="pin"){if(!o.pin||o.pin.length!==4){c("Please enter a valid 4-digit PIN"),u(!1);return}}else if(!o.password){c("Please enter your password"),u(!1);return}}let v;if(s)if(n==="pin")try{v=await Ft.pinLogin({email:o.email,pin:o.pin})}catch(S){if(S.message.includes("PIN not set"))c("PIN not set for this user. Please use password login.");else if(S.message.includes("Invalid PIN"))c("Invalid PIN. Please try again.");else throw S;u(!1);return}else v=await Ft.login({email:o.email,password:o.password});else{const S=y(),P=localStorage.getItem("planId")||S?.id||"basic",T=localStorage.getItem("businessType")||localStorage.getItem("selectedBusinessType")||S?.business_type,M=localStorage.getItem("selectedFeatures");v=await Ft.signup({email:o.email,password:o.password,name:o.name,plan:P,business_type:T,selectedFeatures:M?JSON.parse(M):[]})}if(v.needsPasswordSetup){m(!0),i({...o,email:v.email}),c(""),u(!1);return}if(!v||!v.user||!v.token)throw new Error("Authentication failed. Please try again.");await f(v);const j=Tp(v.user);b(j,{replace:!0})}catch(v){c(v.message||"Authentication failed")}finally{u(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl mx-auto mb-4 flex items-center justify-center",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:"P"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:s?"Welcome Back":"Get Started"}),e.jsx("p",{className:"text-gray-500 text-sm",children:s?"Sign in to your account":"Create your account today"})]}),e.jsxs("form",{onSubmit:g,className:"space-y-5",children:[x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Please set a new password"})}),e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"New Password",className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none transition-all",value:o.newPassword,onChange:p=>i({...o,newPassword:p.target.value}),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"Confirm Password",className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none transition-all",value:o.confirmPassword,onChange:p=>i({...o,confirmPassword:p.target.value}),required:!0})]})]}):e.jsxs(e.Fragment,{children:[!s&&e.jsxs("div",{className:"relative",children:[e.jsx(yn,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Full Name",className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none transition-all",value:o.name,onChange:p=>i({...o,name:p.target.value}),required:!0})]}),e.jsxs("div",{className:"relative",children:[e.jsx(zt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",placeholder:"Email",className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none transition-all",value:o.email,onChange:p=>i({...o,email:p.target.value}),required:!0})]}),s&&e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg",children:[e.jsx("button",{type:"button",onClick:()=>r("password"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all ${n==="password"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Password"}),e.jsx("button",{type:"button",onClick:()=>r("pin"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all ${n==="pin"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"PIN"})]})}),s&&n==="password"&&e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"Password",className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none transition-all",value:o.password,onChange:p=>i({...o,password:p.target.value}),required:!0})]}),s&&n==="pin"&&e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",inputMode:"numeric",placeholder:"4-digit PIN",className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none transition-all text-center text-2xl tracking-widest",value:o.pin,onChange:p=>i({...o,pin:p.target.value.replace(/\D/g,"").slice(0,4)}),maxLength:4,required:!0})]}),!s&&e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",placeholder:"Password (min 6 characters)",className:"w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-100 outline-none transition-all",value:o.password,onChange:p=>i({...o,password:p.target.value}),required:!0})]})]}),l&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-3 rounded-lg text-sm flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),e.jsx("span",{children:l})]}),e.jsx("button",{type:"submit",disabled:d,className:"w-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg active:scale-[0.98]",children:d?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(Ic,{className:"animate-spin h-5 w-5"}),"Processing..."]}):x?"Set Password":s?"Sign In":"Create Account"})]}),s&&!x&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-700 font-medium transition-colors",children:"Forgot password?"})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[s?"Don't have an account?":"Already have an account?"," ",e.jsx("button",{type:"button",onClick:()=>{a(!s),c(""),m(!1)},className:"text-blue-600 hover:text-blue-700 font-semibold transition-colors",children:s?"Sign up":"Sign in"})]})})]})})}function $p(){const[t,s]=h.useState("ultra"),[a,n]=h.useState(!1),[r,o]=h.useState(!1),[i,l]=h.useState(null),[c,d]=h.useState({name:"",email:"",company:""}),u=Ee();console.log("âœ… Subscription component mounted, navigate available:",typeof u);const x=[{id:"basic",name:"Basic",price:1e3,icon:ps,color:"from-green-500 to-teal-600",popular:!1,features:["âœ“ Admin Dashboard + Cashier POS","âœ“ Basic Inventory Management","âœ“ Sales Tracking","âœ“ Daily/Weekly Reports","âœ“ Basic Profit/Loss View","âœ“ Email Support","âœ“ 1 Cashier Only"]},{id:"ultra",name:"Ultra",price:2500,icon:Rc,color:"from-blue-600 to-purple-600",popular:!0,features:["âœ“ Admin Dashboard + Cashier POS","âœ“ Full Inventory Management","âœ“ Automatic Stock Deduction","âœ“ User Management (Unlimited)","âœ“ Permission Controls","âœ“ Expense Tracking","âœ“ Advanced Analytics","âœ“ Priority Support"]},{id:"pro",name:"Pro",price:3e3,icon:Ua,color:"from-purple-600 to-pink-600",popular:!1,badge:"NEW",features:["âœ“ Everything in Ultra Plan","âœ“ Business-Specific Dashboards","âœ“ Clinic/Hospital Management","âœ“ Bar/Restaurant Tables","âœ“ Hotel Room Booking","âœ“ Supermarket Features","âœ“ Role-Based Dashboards","âœ“ Priority 24/7 Support"]}],m=[{id:"clinic",name:"Clinic / Hospital",icon:ua,description:"Patient management, appointments, prescriptions",roles:["Doctor","Reception","Pharmacy","Admin"]},{id:"bar",name:"Bar / Club",icon:Lc,description:"Table orders, drink menu, hold bills",roles:["Bartender","Waiter","Manager"]},{id:"hotel",name:"Hotel",icon:pt,description:"Room bookings, check-in/out, guest billing",roles:["Reception","Housekeeping","Manager"]},{id:"supermarket",name:"Supermarket",icon:ct,description:"Advanced inventory, bulk sales, departments",roles:["Cashier","Stock Manager","Department Head"]}],b=g=>{g?.preventDefault?.(),console.log("[BUTTON] Get Started clicked, selected plan:",t);const p=x.find(v=>v.id===t);if(console.log("[BUTTON] Found plan:",p),!p){console.error("[BUTTON] Plan not found!"),alert("Please select a plan first");return}if(t==="pro"){o(!0);return}try{const v={id:p.id,name:p.name,price:p.price};localStorage.setItem("selectedPlan",JSON.stringify(v)),localStorage.setItem("planId",t),console.log("[BUTTON] Stored to localStorage, navigating..."),console.log("[BUTTON] Going to /auth/signup"),u("/auth/signup")}catch(v){console.error("[BUTTON] Error:",v),alert("Error: "+v.message)}},f=g=>{try{const p=x.find(j=>j.id==="pro"),v={id:p.id,name:p.name,price:p.price,business_type:g.id};localStorage.setItem("selectedPlan",JSON.stringify(v)),localStorage.setItem("planId","pro"),localStorage.setItem("businessType",g.id),console.log("[PRO] Business type selected:",g.id),u("/auth/signup")}catch(p){console.error("[PRO] Error:",p),alert("Error: "+p.message)}},y=async g=>{g.preventDefault();try{await fetch(`${ee}/demo-requests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)}),alert("Demo request submitted! Admin will review and contact you."),n(!1),d({name:"",email:"",company:""})}catch(p){console.error("Demo request failed:",p),alert("Failed to submit demo request. Please try again.")}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 py-6 md:py-12 px-4 md:px-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>u("/"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 transition",children:[e.jsx(Zi,{size:20}),"Back to Home"]}),e.jsxs(V.div,{className:"flex items-center gap-2",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},children:[e.jsx("img",{src:"/posifine-logo.png",alt:"PosiFine Logo",className:"w-8 h-8 object-contain",onError:g=>{g.target.style.display="none"}}),e.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"PosiFine"})]})]}),e.jsxs(V.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-12 md:mb-16",children:[e.jsx(V.h1,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.2},className:"text-3xl md:text-5xl font-bold mb-3 md:mb-4 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Choose Your Plan"}),e.jsx(V.p,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.4},className:"text-gray-600 text-base md:text-lg",children:"Pick the perfect plan and unlock your POS potential"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8 mb-8 md:mb-12 max-w-5xl mx-auto",children:x.map((g,p)=>{const v=g.icon;return e.jsxs(V.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5,delay:p*.15},whileHover:{y:-8,transition:{duration:.2}},onClick:()=>s(g.id),className:`card cursor-pointer transition-all transform ${t===g.id?"ring-4 ring-blue-600 shadow-2xl scale-105 bg-gradient-to-br from-blue-50 to-purple-50":"hover:shadow-lg hover:scale-102"} relative`,children:[g.popular&&e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:e.jsx("span",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg",children:"Most Popular"})}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${g.color} flex items-center justify-center`,children:e.jsx(v,{className:"w-5 h-5 text-white"})}),e.jsx("h3",{className:"text-lg md:text-xl font-bold",children:g.name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("span",{className:"text-2xl md:text-3xl font-bold",children:["KSH ",g.price]}),e.jsx("span",{className:"text-gray-600 text-xs md:text-sm",children:"/month"})]}),e.jsx("ul",{className:"space-y-2",children:g.features.map((j,S)=>e.jsxs("li",{className:"flex items-start gap-2 text-xs md:text-sm",children:[e.jsx(Xe,{className:"w-4 h-4 text-green-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:j})]},S))})]},g.id)})}),e.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"flex flex-col md:flex-row gap-4 items-center justify-center mt-8",children:[e.jsx(V.button,{type:"button",onClick:b,whileHover:{scale:1.05,boxShadow:"0 20px 40px rgba(0,0,0,0.2)"},whileTap:{scale:.95},className:"cursor-pointer px-8 md:px-12 py-3 md:py-4 text-base md:text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg shadow-lg",children:"Get Started"}),e.jsx(V.button,{type:"button",onClick:()=>n(!0),whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer px-8 md:px-12 py-3 md:py-4 text-base md:text-lg font-bold border-2 border-gray-300 bg-white text-gray-700 rounded-lg hover:border-gray-400 transition-all",children:"Request Free Demo"})]}),e.jsx("p",{className:"text-xs md:text-sm text-gray-500 mt-4 text-center",children:"Secure payment â€¢ Cancel anytime"}),a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-teal-600 p-6 text-white rounded-t-2xl",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Request Free Demo"}),e.jsx("p",{className:"text-green-100 text-sm mt-1",children:"We'll contact you to schedule a demo"})]}),e.jsxs("form",{onSubmit:y,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Full Name"}),e.jsx("input",{type:"text",value:c.name,onChange:g=>d({...c,name:g.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-green-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:c.email,onChange:g=>d({...c,email:g.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-green-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Company Name"}),e.jsx("input",{type:"text",value:c.company,onChange:g=>d({...c,company:g.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-green-500",placeholder:"Optional"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-green-600 text-white py-3 rounded-lg font-bold hover:bg-green-700 transition",children:"Submit Request"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-6 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition",children:"Cancel"})]})]})]})})]}),e.jsx("footer",{className:"mt-16 border-t border-gray-200 pt-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 text-center",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V.img,{src:"/posifine-logo.png",alt:"PosiFine Logo",className:"w-6 h-6 object-contain",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},onError:g=>{g.target.style.display="none"}}),e.jsx("span",{className:"text-sm font-semibold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"PosiFine"})]}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Â© 2026 Mabrixel Technologies. All rights reserved."}),e.jsx("button",{onClick:()=>u("/auth/login"),className:"text-sm text-blue-600 hover:text-blue-700 transition-colors",children:"Already have an account? Login"})]})})}),e.jsx(Ml,{children:r&&e.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(V.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white rounded-2xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Choose Your Business Type"}),e.jsx("p",{className:"text-gray-600",children:"Select the industry that matches your business for specialized features"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:m.map(g=>{const p=g.icon;return e.jsx(V.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>f(g),className:"p-6 border-2 border-gray-200 rounded-xl hover:border-purple-500 hover:shadow-lg transition-all text-left",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(p,{className:"w-8 h-8 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:g.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-3",children:g.description}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.roles.map(v=>e.jsx("span",{className:"px-2 py-1 bg-purple-50 text-purple-700 text-xs rounded-full",children:v},v))})]})]})},g.id)})}),e.jsx("button",{onClick:()=>o(!1),className:"mt-6 w-full px-6 py-3 border-2 border-gray-300 rounded-xl text-gray-700 font-semibold hover:bg-gray-50 transition-colors",children:"Back to Plans"})]})})})]})}const Ba={bar:{id:"bar",name:"Bar / Alcohol Business",description:"Drinks, happy hour pricing, brand tracking, staff shifts",icon:"Wine",color:"amber",features:["Bottle size + brand management","Happy hour pricing rules","Staff shift tracking","Profit by brand","Low stock alerts","Age-check functionality"],productFields:["name","brand","size","category","price","cost","stock"],categories:["Beer","Wine","Spirits","Beverages","Mixers"],adminModules:["inventory","staff","shifts","pricing","reports"],cashierModules:["categories","quick-tap","age-check","shift-view"]},hospital:{id:"hospital",name:"Hospital / Clinic",description:"Patient billing, services, medicines, doctor commission",icon:"Heart",color:"red",features:["Services + medicines separation","Patient search + billing","Doctor commission tracking","Batch + expiry tracking","Medicine inventory","Invoice printing"],productFields:["name","type","category","price","batchNo","expiryDate","stock"],categories:["Services","Medicines","Lab Tests","Equipment"],adminModules:["patients","services","medicines","doctors","inventory"],cashierModules:["patient-search","add-services","add-medicines","print"]},school:{id:"school",name:"School",description:"Student billing, term fees, canteen, uniform/books",icon:"BookOpen",color:"blue",features:["Student management","Term fees tracking","Canteen inventory","Uniform + books stock","Fee payment receipts","Student balance"],productFields:["name","type","category","price","stock","description"],categories:["Fees","Canteen","Uniforms","Books","Supplies"],adminModules:["students","fees","canteen","inventory","reports"],cashierModules:["student-lookup","fee-payment","canteen-sales","receipts"]},kiosk:{id:"kiosk",name:"Kiosk / Small Shop",description:"Simple inventory, supplier tracking, fast POS",icon:"Store",color:"green",features:["Simple inventory management","Supplier tracking","Price rules","Profit reports","Low stock alerts","Fast checkout"],productFields:["name","category","price","cost","stock","supplier"],categories:["General","Electronics","Food","Drinks","Supplies"],adminModules:["inventory","suppliers","pricing","reports"],cashierModules:["search","quick-scan","low-stock-alerts"]},petrol:{id:"petrol",name:"Petrol / Gas Station",description:"Fuel types, pump tracking, tank stock, shift reconciliation",icon:"Fuel",color:"yellow",features:["Fuel type management","Pump tracking","Tank stock management","Shift reconciliation","Pump totals","Attendant management"],productFields:["name","fuelType","pricePerLiter","tankCapacity","pumpId","stock"],categories:["Petrol","Diesel","Premium","LPG"],adminModules:["fuel-types","pumps","tanks","staff","reconciliation"],cashierModules:["pump-selector","fuel-buttons","shift-totals","attendant-view"]},shoes:{id:"shoes",name:"Shoe / Clothing Store",description:"Size & color variants, margin tracking, returns/refunds",icon:"Shirt",color:"pink",features:["Size + color variants","Margin per product","Returns + refunds","Variant inventory","Barcode + search POS","Stock by variant"],productFields:["name","category","price","cost","size","color","stock","margin"],categories:["Shoes","Shirts","Pants","Dresses","Accessories"],adminModules:["variants","inventory","returns","pricing","reports"],cashierModules:["variant-selector","search","barcode","returns"]}};function Vp(){const t=Ee(),[s,a]=h.useState(null),[n,r]=h.useState(1),o=u=>{a(u),r(2)},i=()=>{if(!s){alert("Please select a business type");return}const u=Ba[s];localStorage.setItem("selectedBusinessType",s),localStorage.setItem("businessMetadata",JSON.stringify(u)),console.log("[BUILD POS] Selected business:",s),t("/auth/signup")},l=()=>{n===2?(r(1),a(null)):t("/plans")},c=s?Ba[s]:null,d=Object.entries(Ba).map(([u,x])=>({id:u,...x}));return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center gap-4 mb-8",children:e.jsxs("button",{onClick:l,className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 transition p-2 rounded-lg hover:bg-white",children:[e.jsx(Zi,{size:20}),"Back"]})}),n===1&&e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Choose Your Business Type"}),e.jsx("p",{className:"text-gray-600 mb-12 text-lg",children:"Select the type that best matches your operation. We'll customize your dashboard accordingly."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(u=>e.jsxs("button",{onClick:()=>o(u.id),className:`text-left p-6 rounded-xl border-2 transition-all transform hover:scale-105 ${s===u.id?"border-blue-600 bg-blue-50 ring-2 ring-blue-400 shadow-lg":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:u.name}),e.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center ${s===u.id?"bg-blue-600 border-blue-600":"border-gray-300"}`,children:s===u.id&&e.jsx(Xe,{size:16,className:"text-white"})})]}),e.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:u.description}),e.jsx("ul",{className:"space-y-2",children:u.features.slice(0,3).map((x,m)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[e.jsx("span",{className:"text-green-600 font-bold mt-0.5",children:"â€¢"}),e.jsx("span",{children:x})]},m))})]},u.id))})]}),n===2&&c&&e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8 text-center",children:"Confirm Your Selection"}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border-2 border-blue-600",children:[e.jsx("h2",{className:"text-3xl font-bold mb-4 text-blue-600",children:c.name}),e.jsx("p",{className:"text-gray-600 mb-8 text-lg",children:c.description}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Your Dashboard Includes:"}),e.jsx("ul",{className:"space-y-3",children:c.features.map((u,x)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-600 flex items-center justify-center flex-shrink-0 mt-0.5",children:e.jsx(Xe,{size:16,className:"text-white"})}),e.jsx("span",{className:"text-gray-700",children:u})]},x))})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-8",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-bold",children:"Custom Price:"})," 3,500 KES/month"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Your admin will be customized for ",c.name.toLowerCase(),". You can modify your selection later."]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>{r(1),a(null)},className:"flex-1 px-6 py-3 rounded-lg border-2 border-gray-300 font-bold text-gray-700 hover:bg-gray-50 transition",children:"Choose Different"}),e.jsxs("button",{onClick:i,className:"flex-1 px-6 py-3 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 text-white font-bold hover:shadow-lg transition flex items-center justify-center gap-2",children:["Continue to Sign Up",e.jsx(Zs,{size:20})]})]})]})]})]})})}function Bp({isLocked:t,onUnlock:s,userPin:a,userName:n="Cashier"}){const[r,o]=h.useState(""),[i,l]=h.useState(""),[c,d]=h.useState(0),[u,x]=h.useState(!1);h.useEffect(()=>{t&&(l(""),o(""),d(0),x(!1))},[t]),h.useEffect(()=>{c>=3&&(x(!0),setTimeout(()=>{x(!1),d(0)},3e4))},[c]);const m=y=>{u||r.length<4&&(o(g=>g+y),l(""))},b=()=>{u||(o(y=>y.slice(0,-1)),l(""))},f=()=>{if(u){l("Too many attempts. Please wait.");return}if(r.length!==4){l("PIN must be 4 digits");return}String(r)===String(a)?(o(""),l(""),s()):(l("Incorrect PIN"),d(y=>y+1),o(""))};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[9999] backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 w-96 max-w-full mx-4",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"bg-red-100 p-4 rounded-full",children:e.jsx(Ve,{className:"w-12 h-12 text-red-600"})})}),e.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-2",children:"Screen Locked"}),e.jsxs("p",{className:"text-center text-gray-600 mb-6",children:[n,", enter your PIN to continue"]}),e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 mb-6 flex justify-center gap-2",children:[0,1,2,3].map(y=>e.jsx("div",{className:"w-12 h-12 bg-white border-2 border-gray-300 rounded-lg flex items-center justify-center font-bold text-xl text-gray-800",children:r[y]?"â—":""},y))}),i&&e.jsxs("div",{className:`text-center text-sm font-medium mb-4 p-2 rounded ${i.includes("Incorrect")?"bg-red-100 text-red-700":i.includes("must be")?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[i,c>0&&c<3&&e.jsxs("p",{className:"text-xs mt-1",children:[3-c," attempt",3-c!==1?"s":""," remaining"]}),u&&e.jsx("p",{className:"text-xs mt-1",children:"Locked. Try again in 30 seconds."})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[[1,2,3,4,5,6,7,8,9].map(y=>e.jsx("button",{onClick:()=>m(String(y)),disabled:u||r.length>=4,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white font-bold py-3 rounded-lg transition-colors text-lg",children:y},y)),e.jsx("button",{onClick:()=>m("0"),disabled:u||r.length>=4,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white font-bold py-3 rounded-lg transition-colors col-span-1 text-lg",children:"0"}),e.jsxs("button",{onClick:b,disabled:u||r.length===0,className:"bg-red-500 hover:bg-red-600 disabled:bg-gray-300 text-white font-bold py-3 rounded-lg transition-colors col-span-2 flex items-center justify-center gap-2",children:[e.jsx(Qe,{size:16}),"Back"]})]}),e.jsx("button",{onClick:f,disabled:u||r.length!==4,className:"w-full bg-green-600 hover:bg-green-700 disabled:bg-gray-300 text-white font-bold py-3 rounded-lg transition-colors mb-3",children:u?"Locked":"Unlock"}),e.jsx("p",{className:"text-center text-xs text-gray-500 mt-4",children:"Enter your 4-digit PIN"})]})}):null}function _p(){const[t,s]=h.useState([]),[a,n]=h.useState([]);h.useEffect(()=>{const i=async()=>{try{const c=await Ie.getLowStockWarnings?.();c?.warnings&&s(c.warnings)}catch(c){console.warn("Failed to fetch low-stock warnings:",c)}};i();const l=setInterval(i,1e4);return()=>clearInterval(l)},[]);const r=t.filter(i=>!a.includes(i.id));if(r.length===0)return null;const o=i=>{n([...a,i])};return e.jsx("div",{className:"fixed top-24 right-6 max-w-md space-y-2 z-40",children:r.map(i=>e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded shadow-lg animate-pulse",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qt,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900",children:"âš ï¸ Stock Warning"}),e.jsxs("p",{className:"text-sm text-red-800 mt-1",children:[e.jsx("strong",{children:i.name}),": ",i.quantity,i.unit," remaining"]}),e.jsxs("p",{className:"text-xs text-red-700 mt-0.5",children:["Threshold: ",i.threshold,i.unit]})]})]}),e.jsx("button",{onClick:()=>o(i.id),className:"text-red-600 hover:text-red-900 flex-shrink-0",children:e.jsx(Qe,{className:"w-4 h-4"})})]})},i.id))})}const Up="http://localhost:5000";let _a=null;const qp=()=>(_a||(_a=localStorage.getItem("token")),_a),zp=async(t,s={})=>{const a=performance.now(),n=qp();try{const r=await fetch(`${Up}${t}`,{...s,headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`,...s.headers},keepalive:!0,priority:"high"});if(!r.ok){const l=await r.json().catch(()=>({error:"Request failed"}));throw new Error(l.error||`HTTP ${r.status}`)}const o=await r.json(),i=performance.now()-a;return i>200&&console.warn(`âš ï¸ Slow API request: ${t} took ${i.toFixed(1)}ms`),o}catch(r){const o=performance.now()-a;throw console.error(`âŒ API error (${o.toFixed(1)}ms): ${t}`,r),r}},Wp=async(t,s,a,n)=>{const r=performance.now();let o=!1;try{console.log("ðŸš€ [Transaction] Starting sale transaction",{items:t.items?.length||0,total:t.total}),s&&(s({action:"SALE_PENDING",cartCleared:!0,message:"Processing sale...",timestamp:Date.now()}),o=!0,console.log("âœ… [Transaction] Optimistic update applied"));const i=performance.now(),l=await zp("/api/v2/sales/complete",{method:"POST",body:JSON.stringify({items:t.items,total:t.total,discount:t.discount||0,tax:t.tax||0,taxType:t.taxType||"exclusive",paymentMethod:t.paymentMethod||"cash",shiftId:t.shiftId})}),c=performance.now()-i;console.log(`âœ… [Transaction] API completed in ${c.toFixed(1)}ms`);const d=performance.now()-r;if(!l.success||!l.saleId)throw new Error(l.error||"Invalid server response");const u={...l,clientElapsedMs:d,apiElapsedMs:c,performanceGrade:d<100?"ðŸš€ EXCELLENT":d<200?"âœ… GOOD":d<300?"âš ï¸ ACCEPTABLE":"âŒ SLOW",updatedProducts:l.updatedProducts||[],stockDeductions:l.stockDeductions||{},lowStockWarnings:l.lowStockWarnings||[]};return console.log(`âœ… [Transaction] Complete! Total: ${d.toFixed(1)}ms ${u.performanceGrade}`),a&&a(u),u}catch(i){const l=performance.now()-r;console.error(`âŒ [Transaction] Failed after ${l.toFixed(1)}ms:`,i);const c={error:i.message||"Transaction failed",elapsedMs:l,action:"SALE_FAILED",needsRollback:o,timestamp:Date.now()};throw n&&n(c),i}},Hp="products_cache_v2",Kp=()=>{sessionStorage.removeItem(Hp),console.log("ðŸ—‘ï¸ [Cache] Product cache invalidated")},Gp=(t,s)=>{if(!s||!Array.isArray(s.products))return t;const a=performance.now(),n=new Map;s.products.forEach(i=>{n.set(i.id,i.deducted||i.quantity)});const r=t.map(i=>{const l=n.get(i.id);return l!==void 0?{...i,quantity:Math.max(0,i.quantity-l)}:i}),o=performance.now()-a;return console.log(`âœ… [Optimistic] Inventory updated in ${o.toFixed(2)}ms`),r},Jp={sales:[],clockIns:[],clockOuts:[],record(t,s){const a=this[t];a&&(a.push({duration:s,timestamp:Date.now()}),a.length>100&&a.shift())},getStats(t){const s=this[t];if(!s||s.length===0)return{count:0,avg:0,min:0,max:0,p95:0};const a=s.map(i=>i.duration).sort((i,l)=>i-l),n=a.length,r=a.reduce((i,l)=>i+l,0),o=Math.floor(n*.95);return{count:n,avg:r/n,min:a[0],max:a[n-1],p95:a[o]||a[n-1]}},logReport(){console.group("ðŸ“Š Transaction Performance Report"),console.log("Sales:",this.getStats("sales")),console.log("Clock Ins:",this.getStats("clockIns")),console.log("Clock Outs:",this.getStats("clockOuts")),console.groupEnd()}};typeof window<"u"&&(window.__transactionMetrics=Jp);function yt(){const{user:t,logout:s}=re(),{products:a,refreshProducts:n}=vn(),{isLocked:r,lock:o,unlock:i}=oo(),[l,c]=h.useState([]),[d,u]=h.useState([]),[x,m]=h.useState([]),[b,f]=h.useState("cash"),[y,g]=h.useState("pos"),[p,v]=h.useState({sales:[],expenses:[],stats:{}}),[j,S]=h.useState(""),[P,T]=h.useState(!1),[M,N]=h.useState(!1),[A,L]=h.useState(null),[E,F]=h.useState({name:"",price:"",cost:"",category:"finished",image:""}),[te,ye]=h.useState({quantity:"",expiryDate:"",batchNumber:"",cost:""}),[we,Be]=h.useState(!1),[ue,de]=h.useState(!1),[oe,ve]=h.useState({customerName:"",amount:"",reason:"",notes:""}),[D,K]=h.useState(!1),[q,J]=h.useState({description:"",amount:"",category:""}),[C,_]=h.useState(""),[O,Q]=h.useState([]),[G,he]=h.useState(null),[pe,se]=h.useState("exclusive"),[mt,vt]=h.useState(!1),[ya,It]=h.useState(null),[ks,Nt]=h.useState(null),[Rt,Lt]=h.useState({}),[Xt,Cs]=h.useState(!1),[er,Ps]=h.useState(!1),[tr,k]=h.useState(!1),[I,$]=h.useState(Date.now()),[ie,U]=h.useState(0);h.useEffect(()=>{st(),n();const w=localStorage.getItem(`cart_${t?.id}`),R=localStorage.getItem(`paymentMethod_${t?.id}`),H=localStorage.getItem(`selectedDiscount_${t?.id}`),Y=localStorage.getItem(`taxType_${t?.id}`);if(w)try{m(JSON.parse(w))}catch(B){console.warn("Failed to restore cart:",B)}if(R&&f(R),Y&&se(Y),H)try{he(JSON.parse(H))}catch{}Ts();const ne=B=>{console.log("ðŸ“¦ Stock update event received:",B.detail),st(),n()},Se=B=>{if(console.log("ðŸ”„ Products sync event received:",B.detail),B.detail&&B.detail.products){const Ce=B.detail.products.filter(Ke=>Ke.visibleToCashier!==!1&&!Ke.expenseOnly);c(Ce)}},Me=()=>{console.log("ðŸ“ Product update event received"),st(),n()};window.addEventListener("stock_updated",ne),window.addEventListener("productsSync",Se),window.addEventListener("productUpdated",Me),window.addEventListener("productCreated",Me);const at=localStorage.getItem("token");at&&nt.connect(at,B=>{if(console.log("ðŸ“¡ WebSocket callback received:",B),B&&B.allProducts){console.log(`ðŸ“¦ Merging ${B.allProducts.length} products from WebSocket`);const Ce=B.allProducts.filter(Ke=>Ke.visibleToCashier!==!1&&!Ke.expenseOnly);c(Ce)}B&&B.productId!==void 0&&B.newQuantity!==void 0&&(console.log(`ðŸ“¦ Stock update for product ${B.productId}: ${B.newQuantity}${B.unit||""}`),c(Ce=>Ce.map(me=>me.id===B.productId?{...me,quantity:B.newQuantity}:me))),B&&B.discounts&&(console.log("ðŸ“Š Discount list updated"),Q(B.discounts)),B&&B.sale&&(console.log("ðŸ’° Sale detected, reloading stats"),st())}).catch(B=>{console.warn("âš ï¸ WebSocket connection failed:",B)});const Zt=Xc(B=>{try{if(!B)return;console.log("ðŸ“¨ Product subscription message:",B.type),(B.type==="initial"||B.type==="products_snapshot"||B.type==="product_created"||B.type==="product_updated"||B.type==="product_deleted")&&Ie.getAll().then(Ce=>{const Ke=Ce.filter(me=>me.visibleToCashier!==!1&&!me.expenseOnly);console.log(`âœ… Subscription update: ${Ke.length} products`),c(Ke)}).catch(Ce=>{console.error("Failed to fetch products from subscription:",Ce)})}catch(Ce){console.error("âŒ Product subscription handler error",Ce)}}),sr=setInterval(()=>{console.log("ðŸ”„ Auto-refreshing products..."),Ps(!0),n().finally(()=>Ps(!1))},3e4);return()=>{window.removeEventListener("stock_updated",ne),window.removeEventListener("productsSync",Se),window.removeEventListener("productUpdated",Me),window.removeEventListener("productCreated",Me),clearInterval(sr);try{Zt()}catch{}nt.disconnect()}},[t?.id]),h.useEffect(()=>{if(a){const w=a.filter(R=>R.visibleToCashier!==!1&&!R.expenseOnly&&!R.pendingDelete);c(w),$(Date.now()),U(R=>R+1)}},[a]),h.useEffect(()=>{const w=localStorage.getItem("token");let R=null;return w&&nt.connect(w,H=>{console.log("ðŸ“¡ WebSocket callback received:",H),H&&H.allProducts&&(console.log(`ðŸ“¦ Merging ${H.allProducts.length} products from WebSocket`),R&&clearTimeout(R),R=setTimeout(()=>{const Y=H.allProducts.filter(ne=>ne.visibleToCashier!==!1&&!ne.expenseOnly);c(Y)},300)),H&&H.productId!==void 0&&H.newQuantity!==void 0&&(console.log(`ðŸ“¦ Stock update for product ${H.productId}: ${H.newQuantity}${H.unit||""}`),c(Y=>Y.map(Se=>Se.id===H.productId?{...Se,quantity:H.newQuantity}:Se))),H&&H.discounts&&(console.log("ðŸ“Š Discount list updated"),Q(H.discounts)),H&&H.sale&&(console.log("ðŸ’° Sale detected, reloading stats"),st())}).catch(H=>{console.warn("âš ï¸ WebSocket connection failed:",H)}),()=>{R&&clearTimeout(R)}},[]),h.useEffect(()=>{(x.length>0||b||pe)&&Z()},[x,b,pe,G,t?.id]);const Z=()=>{localStorage.setItem(`cart_${t?.id}`,JSON.stringify(x)),localStorage.setItem(`paymentMethod_${t?.id}`,b),localStorage.setItem(`taxType_${t?.id}`,pe),G&&localStorage.setItem(`selectedDiscount_${t?.id}`,JSON.stringify(G))},ce=async()=>{try{k(!0);const w=await _s.create("clock_in");It(w),vt(!0);const R=new Date(w.clockInTime);Nt(R),localStorage.setItem(`clockIn_${t?.id}_${new Date().toDateString()}`,R.toISOString()),console.log("âœ… Clocked in successfully"),alert("âœ… Clocked in successfully at "+R.toLocaleTimeString())}catch(w){console.error("Clock in failed:",w),alert("âŒ Clock in failed: "+(w.message||"Unknown error"))}finally{k(!1)}},lt=async()=>{try{k(!0);const w=await _s.create("clock_out");It(w),vt(!1),Nt(null),localStorage.removeItem(`clockIn_${t?.id}_${new Date().toDateString()}`),console.log("âœ… Clocked out successfully");const R=w.duration?`${w.duration} minutes`:"unknown duration";alert("âœ… Clocked out successfully. Duration: "+R)}catch(w){console.error("Clock out failed:",w),alert("âŒ Clock out failed: "+(w.message||"Unknown error"))}finally{k(!1)}},Ts=async()=>{try{const w=await _s.getStatus();w.isClockedIn?(vt(!0),Nt(new Date(w.clockInTime)),It(w),console.log("âœ… User is clocked in since:",w.clockInTime)):(vt(!1),Nt(null),It(null),console.log("User is not clocked in"))}catch(w){console.warn("Failed to check clock status:",w),vt(!1),Nt(null)}},st=async()=>{try{const[w,R,H,Y,ne,Se]=await Promise.all([Ie.getAll(),ma.getAll(),ea.getAll(),ao.get(),ta.getAll(),rs.getAll().catch(()=>[])]);c(w.filter(Me=>Me.visibleToCashier!==!1&&!Me.expenseOnly)),v({sales:R,expenses:H,stats:Y}),u(ne),Q(Se||[])}catch(w){console.error("Failed to load data:",w)}},As=(w,R=!0)=>{const H=w.target.files[0];if(H){const Y=new FileReader;Y.onload=ne=>{const Se=ne.target.result;_(Se),R&&F({...E,image:Se})},Y.readAsDataURL(H)}},Ds=w=>d.filter(H=>H.productId===w&&H.quantity>0).reduce((H,Y)=>H+Y.quantity,0),tc=w=>{const R=Ds(w.id);if(R<=0){alert("Product is out of stock!");return}const H=x.find(ne=>ne.id===w.id);if((H?H.quantity:0)>=R){alert(`Only ${R} units available in stock!`);return}m(H?x.map(ne=>ne.id===w.id?{...ne,quantity:ne.quantity+1}:ne):[...x,{...w,quantity:1}])},ja=(w,R)=>{l.find(Y=>Y.id===w);const H=Ds(w);m(x.map(Y=>{if(Y.id===w){const ne=Y.quantity+R;return ne>H?(alert(`Only ${H} units available!`),Y):{...Y,quantity:Math.max(1,ne)}}return Y}).filter(Y=>Y.quantity>0))},sc=w=>{m(x.filter(R=>R.id!==w))},He=x.reduce((w,R)=>w+R.price*R.quantity,0),ac=async()=>{if(console.log("ðŸ›’ [Checkout] Starting optimized checkout flow"),x.length===0||Xt){console.log("âš ï¸ [Checkout] Blocked: cart empty or already processing");return}Cs(!0),k(!0);const w=[...x],R={...Rt},H=G,Y=pe;try{const ne=x.reduce((B,Ce)=>B+Ce.price*Ce.quantity,0),Se=G?G.type==="percentage"?ne*G.value/100:G.value:0;let Me=0,at=0;pe==="inclusive"?(Me=ne/1.16*.16,at=ne-Se):(Me=(ne-Se)*.16,at=ne-Se+Me);const Zt=x.map(B=>({productId:B.id,quantity:B.quantity,unit:Rt[B.id]||B.unit||"piece",price:B.price,name:B.name}));console.log("ðŸ’³ [Checkout] Processing sale:",{items:Zt.length,total:at,discount:Se,tax:Me});const sr=await Wp({items:Zt,total:at,discount:Se,tax:Me,taxType:pe,paymentMethod:b,shiftId:ya?.id},B=>{console.log("âš¡ [Checkout] Optimistic update:",B.action),m([]),Lt({}),he(null),se("exclusive")},B=>{if(console.log(`âœ… [Checkout] Sale completed in ${B.clientElapsedMs.toFixed(1)}ms ${B.performanceGrade}`),B.updatedProducts&&B.updatedProducts.length>0)c(B.updatedProducts),console.log("ðŸ“¦ [Checkout] Products updated from server");else{const me=Gp(l,B.stockDeductions);c(me),console.log("ðŸ“¦ [Checkout] Products updated optimistically")}Kp();const Ce={id:B.saleId,items:Zt,total:at,discount:Se,tax:Me,taxType:pe,paymentMethod:b,accountId:t?.accountId,cashierId:t?.id,cashierName:t?.name||"Cashier",stockDeductions:B.stockDeductions||{},createdAt:B.timestamp||new Date().toISOString()};v(me=>({...me,sales:[Ce,...me.sales]})),console.log("ðŸ“¢ [Checkout] Dispatching sale_completed event for Monitor"),window.dispatchEvent(new CustomEvent("sale_completed",{detail:{sale:Ce,saleId:B.saleId,total:at,timestamp:new Date().toISOString()}}));const Ke=B.stockDeductions?.products?.map?.(me=>`${me.name||me.productName}: -${me.quantity||me.deducted}${me.unit||""}`).join(`
`)||"Stock updated";if(alert(`âœ… SALE COMPLETE!

Sale ID: #${B.saleId}
Amount: KSH ${at.toLocaleString()}
Time: ${B.processingTime||B.clientElapsedMs.toFixed(1)+"ms"}
Performance: ${B.performanceGrade}

Stock Deducted:
${Ke}`),B.lowStockWarnings&&B.lowStockWarnings.length>0){const me=B.lowStockWarnings.map(Qt=>`âš ï¸ ${Qt.name}: ${Qt.quantity}${Qt.unit} (Low Stock!)`).join(`
`);console.warn(`âš ï¸ [Checkout] Low stock warnings:
`+me),setTimeout(()=>alert(`Low Stock Alert:

`+me),1e3)}setTimeout(()=>{Ie.getAll().then(me=>{const Qt=me.filter(ar=>ar.visibleToCashier!==!1&&!ar.expenseOnly);c(Qt),console.log("ðŸ”„ [Checkout] Background refresh complete")}).catch(me=>console.warn("Background refresh failed:",me))},100)},B=>{console.error(`âŒ [Checkout] Failed after ${B.elapsedMs.toFixed(1)}ms:`,B.error),B.needsRollback&&(m(w),Lt(R),he(H),se(Y),console.log("ðŸ”„ [Checkout] Rolled back to previous state")),alert(`âŒ Sale Failed:

${B.error}

Please try again.`)});console.log("âœ… [Checkout] Transaction completed successfully")}catch(ne){console.error("âŒ [Checkout] Unexpected error:",ne),m(w),Lt(R),he(H),se(Y),alert(`âŒ Checkout Failed:

${ne.message||"Unknown error occurred"}

Your cart has been restored.`)}finally{Cs(!1),k(!1)}},nc=async w=>{w.preventDefault();try{console.log("âž• Creating new product:",E.name);const R=await Ie.create({...E,price:parseFloat(E.price),cost:parseFloat(E.cost||0),quantity:0,visibleToCashier:!0,expenseOnly:!1});console.log("âœ… Product created:",R),R&&c(H=>[...H,R]),F({name:"",price:"",cost:"",category:"finished",image:""}),_(""),T(!1),console.log("âœ… Product added successfully and visible in POS!"),alert("âœ… Product added successfully!")}catch(R){console.error("âŒ Failed to add product:",R.message,R),alert(`âŒ Failed to add product: ${R.message||"Unknown error"}`)}},rc=async w=>{w.preventDefault();try{const R=Array.isArray(d)?d:[],Y={id:R.length>0?Math.max(...R.map(ne=>ne.id||0))+1:1,productId:A.id,quantity:parseInt(te.quantity),expiryDate:te.expiryDate,batchNumber:te.batchNumber||`BATCH-${Date.now()}`,cost:parseFloat(te.cost||A.cost||0)};u(ne=>[...ne,Y]),await ta.create({productId:A.id,quantity:parseInt(te.quantity),expiryDate:te.expiryDate,batchNumber:te.batchNumber||`BATCH-${Date.now()}`,cost:parseFloat(te.cost||A.cost||0)}),ye({quantity:"",expiryDate:"",batchNumber:"",cost:""}),N(!1),L(null),await st(),alert("Stock added successfully!")}catch(R){console.error("Failed to add stock:",R),alert("Failed to add stock")}},ic=async w=>{w.preventDefault();try{const R={...q,amount:parseFloat(q.amount)};await ea.create(R),J({description:"",amount:"",category:""}),Be(!1),window.dispatchEvent(new CustomEvent("expense_added",{detail:{expense:R}})),await st()}catch(R){console.error("Failed to add expense:",R),alert("Failed to add expense")}},oc=async w=>{if(w.preventDefault(),!oe.customerName||!oe.amount){alert("Please fill in all required fields");return}K(!0);try{const R=await Bs.create({customerName:oe.customerName,amount:parseFloat(oe.amount),reason:oe.reason,notes:oe.notes});console.log("âœ… Credit request submitted:",R),ve({customerName:"",amount:"",reason:"",notes:""}),de(!1),alert("âœ… Credit request submitted successfully!")}catch(R){console.error("Failed to submit credit request:",R),alert("âŒ Failed to submit credit request: "+(R.message||"Unknown error"))}finally{K(!1)}},lc=async()=>{if(window.confirm("Are you sure you want to clear all sales and expenses? This action cannot be undone."))try{const w=localStorage.getItem("token"),H=await fetch(`${ee}/clear-data`,{method:"POST",headers:{Authorization:`Bearer ${w}`,"Content-Type":"application/json"},body:JSON.stringify({type:"all"})});if(!H.ok){const Y=await H.json();throw new Error(Y.message||"Failed to clear data")}v({sales:[],expenses:[],stats:{totalSales:0,totalExpenses:0,profit:0}}),m([]),alert("Data cleared successfully!"),await st()}catch(w){console.error("Failed to clear data:",w),alert("Failed to clear data: "+w.message)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex flex-col",children:[e.jsx(_p,{}),e.jsx("nav",{className:"bg-white/80 backdrop-blur-md border-b border-gray-200 px-6 py-4 sticky top-0 z-50 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-green-600 to-teal-600 bg-clip-text text-transparent",children:"Cashier Dashboard"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Cashier Plan - KSH 900/month"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t?.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t?.email})]}),mt&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xs text-green-600 font-semibold",children:"ðŸŸ¢ Clocked In"}),e.jsxs("button",{onClick:lt,className:"px-4 py-2 rounded-lg font-medium transition-all bg-red-600 hover:bg-red-700 text-white flex items-center gap-2 shadow-md",children:[e.jsx(Mc,{className:"w-4 h-4"}),"Clock Out"]})]}),!mt&&e.jsxs("button",{onClick:ce,className:"px-4 py-2 rounded-lg font-medium transition-all bg-green-600 hover:bg-green-700 text-white flex items-center gap-2 shadow-md",children:[e.jsx(Vs,{className:"w-4 h-4"}),"Clock In"]}),e.jsxs("button",{onClick:()=>{Z(),s()},className:"px-4 py-2 rounded-lg font-medium transition-all bg-red-100 hover:bg-red-200 text-red-600 border border-red-300 flex items-center gap-2",children:[e.jsx(ot,{className:"w-4 h-4"}),"Logout"]}),e.jsxs("button",{onClick:lc,className:"px-4 py-2 rounded-lg font-medium transition-all bg-orange-100 hover:bg-orange-200 text-orange-600 border border-orange-300 flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),"Clear"]}),e.jsxs("button",{onClick:()=>de(!0),className:"px-4 py-2 rounded-lg font-medium transition-all bg-blue-100 hover:bg-blue-200 text-blue-600 border border-blue-300 flex items-center gap-2",children:[e.jsx(At,{className:"w-4 h-4"}),"Request Credit"]}),mt&&ks&&e.jsx("div",{className:"ml-auto text-right text-xs",children:e.jsxs("p",{className:"text-green-600 font-semibold flex items-center gap-1",children:[e.jsx(tt,{className:"w-4 h-4"}),"Clocked In: ",ks.toLocaleTimeString()]})})]})]})}),e.jsxs("div",{className:"flex gap-2 px-6 py-4 bg-white border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>g("pos"),className:`px-6 py-2 rounded-lg font-medium transition-all ${y==="pos"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(ct,{className:"w-4 h-4 inline mr-2"}),"POS"]}),e.jsxs("button",{onClick:()=>g("monitor"),className:`px-6 py-2 rounded-lg font-medium transition-all ${y==="monitor"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(bn,{className:"w-4 h-4 inline mr-2"}),"Monitor"]}),e.jsxs("button",{onClick:()=>g("products"),className:`px-6 py-2 rounded-lg font-medium transition-all ${y==="products"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(De,{className:"w-4 h-4 inline mr-2"}),"Products"]}),e.jsxs("button",{onClick:()=>g("expenses"),className:`px-6 py-2 rounded-lg font-medium transition-all ${y==="expenses"?"bg-gradient-to-r from-green-600 to-teal-600 text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(Xs,{className:"w-4 h-4 inline mr-2"}),"Expenses"]})]}),y==="pos"&&e.jsxs("div",{className:"flex-1 flex",children:[e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(Kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"input pl-10",value:j,onChange:w=>S(w.target.value)})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:l.filter(w=>w.name?.toLowerCase().includes(j.toLowerCase())).map(w=>{const R=Ds(w.id),H=R<10,Y=R<=0;return e.jsxs("button",{onClick:()=>tc(w),disabled:Y,className:`card text-left hover:shadow-xl transition-all transform hover:scale-105 relative ${Y?"opacity-50 cursor-not-allowed bg-gray-100":"bg-gradient-to-br from-white to-gray-50"}`,children:[w.image&&e.jsx("div",{className:"w-full h-32 mb-3 rounded-lg overflow-hidden bg-gray-100",children:e.jsx("img",{src:w.image,alt:w.name,className:"w-full h-full object-cover"})}),H&&!Y&&e.jsx("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white p-1 rounded-full",children:e.jsx(qt,{className:"w-4 h-4"})}),Y&&e.jsx("div",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:"OUT"}),e.jsx("h3",{className:"font-semibold mb-2 text-gray-900",children:w.name}),e.jsxs("p",{className:"text-xl font-bold text-green-600",children:["KSH ",w.price?.toLocaleString()]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("p",{className:`text-xs font-medium ${Y?"text-red-600":H?"text-yellow-600":"text-gray-500"}`,children:["Stock: ",R]}),H&&!Y&&e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full font-medium",children:"Low Stock"})]})]},w.id)})})]}),e.jsxs("div",{className:"w-96 bg-white border-l border-gray-200 p-6 flex flex-col shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-600 to-teal-600 rounded-xl flex items-center justify-center",children:e.jsx(ct,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold",children:"Cart"}),e.jsxs("span",{className:"ml-auto bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-semibold",children:[x.length," items"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto mb-6",children:x.length===0?e.jsxs("div",{className:"text-center mt-16",children:[e.jsx(ct,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Cart is empty"})]}):e.jsx("div",{className:"space-y-3",children:x.map(w=>e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:w.name}),e.jsx("button",{onClick:()=>sc(w.id),className:"text-red-600 hover:bg-red-50 p-1 rounded",children:e.jsx(ze,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ja(w.id,-1),className:"w-8 h-8 rounded-lg bg-white shadow-sm flex items-center justify-center hover:bg-gray-100 transition-colors",children:e.jsx(Fc,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-10 text-center font-semibold",children:w.quantity}),e.jsx("button",{onClick:()=>ja(w.id,1),className:"w-8 h-8 rounded-lg bg-white shadow-sm flex items-center justify-center hover:bg-gray-100 transition-colors",children:e.jsx(ge,{className:"w-4 h-4"})})]}),e.jsxs("span",{className:"font-bold text-green-600",children:["KSH ",(w.price*w.quantity).toLocaleString()]})]}),e.jsxs("div",{className:"flex gap-2 items-center mt-2",children:[e.jsx("label",{className:"text-xs font-semibold text-gray-600",children:"Unit:"}),e.jsxs("select",{value:Rt[w.id]||w.unit||"piece",onChange:R=>{Lt({...Rt,[w.id]:R.target.value})},className:"text-xs px-2 py-1 border border-gray-300 rounded bg-white",children:[e.jsx("option",{value:"piece",children:"Piece"}),e.jsx("option",{value:"kg",children:"Kilogram (kg)"}),e.jsx("option",{value:"g",children:"Grams (g)"}),e.jsx("option",{value:"l",children:"Liters (L)"})]}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",max:"999",placeholder:"qty",defaultValue:w.quantity,className:"text-xs px-2 py-1 border border-gray-300 rounded w-16",onChange:R=>{const H=parseFloat(R.target.value);!isNaN(H)&&H>0&&ja(w.id,H-w.quantity)}})]})]},w.id))})}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2 bg-gray-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{className:"text-gray-700",children:["KSH ",He.toLocaleString()]})]}),G&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-KSH ",(G.type==="percentage"?He*G.value/100:G.value).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-orange-600",children:[e.jsxs("span",{children:["Tax (",pe==="exclusive"?"Added":"Included","):"]}),e.jsxs("span",{children:[pe==="exclusive"?"+":"","KSH ",((He-(G?G.type==="percentage"?He*G.value/100:G.value:0))*.16).toLocaleString()]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Final Total:"}),e.jsxs("span",{className:"text-green-600",children:["KSH ",(pe==="exclusive"?He-(G?G.type==="percentage"?He*G.value/100:G.value:0)+(He-(G?G.type==="percentage"?He*G.value/100:G.value:0))*.16:He-(G?G.type==="percentage"?He*G.value/100:G.value:0)).toLocaleString()]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Discount (Optional)"}),e.jsxs("select",{value:G?.id||"",onChange:w=>{w.target.value?he(O.find(R=>R.id===parseInt(w.target.value))):he(null)},className:"input",children:[e.jsx("option",{value:"",children:"No Discount"}),O.filter(w=>w.active).map(w=>e.jsxs("option",{value:w.id,children:[w.name," - ",w.type==="percentage"?`${w.value}%`:`KSH ${w.value}`]},w.id))]}),G&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Discount: KSH ",(G.type==="percentage"?He*G.value/100:G.value).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Tax Type"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"exclusive",checked:pe==="exclusive",onChange:w=>se(w.target.value)}),e.jsx("span",{className:"text-sm",children:"Tax Exclusive (16% added)"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",value:"inclusive",checked:pe==="inclusive",onChange:w=>se(w.target.value)}),e.jsx("span",{className:"text-sm",children:"Tax Inclusive"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Payment Method"}),e.jsxs("select",{value:b,onChange:w=>f(w.target.value),className:"input",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"mpesa",children:"M-Pesa"}),e.jsx("option",{value:"card",children:"Card"})]})]}),e.jsx("button",{onClick:()=>{try{console.log("ðŸ›’ Complete Sale button clicked"),ac()}catch(w){console.error("âŒ Button handler error:",w),alert(`Error: ${w.message}`)}},disabled:x.length===0||Xt,className:"btn-primary w-full py-4 text-lg bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:Xt?"â³ Processing...":"Checkout"})]})]})]}),y==="monitor"&&e.jsxs("div",{className:"p-6 max-w-7xl mx-auto w-full",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"card bg-gradient-to-br from-green-500 to-emerald-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-100 mb-1",children:"Total Sales"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",p.stats.totalSales?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx($e,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-red-500 to-pink-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-100 mb-1",children:"Expenses"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",p.stats.totalExpenses?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(Xs,{className:"w-8 h-8"})})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-blue-500 to-indigo-600 text-white border-0 shadow-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-100 mb-1",children:"Net Profit"}),e.jsxs("p",{className:"text-3xl font-bold",children:["KSH ",p.stats.profit?.toLocaleString()||0]})]}),e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx($e,{className:"w-8 h-8"})})]})})]}),e.jsxs("div",{className:"card shadow-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Sales"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date & Time"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Items"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Payment"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock Deducted"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Total"})]})}),e.jsx("tbody",{children:p.sales&&p.sales.slice(-15).reverse().map((w,R)=>{const H=w.stockDeductions?.products?.slice(0,2).map(Y=>`${Y.name}: -${Y.deducted}${Y.unit}`).join(", ")+(w.stockDeductions?.products?.length>2?"...":"")||"None";return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:new Date(w.createdAt).toLocaleString()}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[w.items?.length||0," items"]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-success",children:w.paymentMethod||"cash"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-orange-600 font-semibold",children:H}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",w.total?.toLocaleString()]})]},R)})})]})})]}),e.jsxs("div",{className:"card shadow-lg mt-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5 text-orange-600"}),"Stock Deductions Log"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-orange-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Sale ID"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Before"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Deducted"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"After"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Unit"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700",children:"Time"})]})}),e.jsx("tbody",{children:p.sales&&p.sales.slice(-20).reverse().map(w=>w.stockDeductions?.products?.map((R,H)=>e.jsxs("tr",{className:"border-t border-orange-100 hover:bg-orange-50 transition-colors",children:[e.jsxs("td",{className:"px-4 py-3 font-medium text-blue-600",children:["#",w.id]}),e.jsx("td",{className:"px-4 py-3",children:R.name}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:R.before}),e.jsxs("td",{className:"px-4 py-3 font-semibold text-red-600",children:["-",R.deducted]}),e.jsx("td",{className:"px-4 py-3 font-semibold text-green-600",children:R.after}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:R.unit}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:new Date(w.createdAt).toLocaleTimeString()})]},`${w.id}-${H}`)))})]}),(!p.sales||p.sales.length===0||!p.sales.some(w=>w.stockDeductions?.products?.length>0))&&e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No stock deductions yet"})]})]})]}),e.jsx("div",{className:"p-6 max-w-7xl mx-auto w-full",children:e.jsxs("div",{className:"card shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Manage Products & Stock"}),e.jsxs("button",{onClick:()=>T(!0),className:"btn-primary flex items-center gap-2 bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Product"]})]}),P&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-green-50 to-teal-50 rounded-xl border-2 border-green-200",children:[e.jsx("h4",{className:"font-semibold mb-4 text-lg",children:"Add New Product"}),e.jsxs("form",{onSubmit:nc,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Product Name",className:"input",value:E.name,onChange:w=>F({...E,name:w.target.value}),required:!0}),e.jsxs("select",{className:"input",value:E.category,onChange:w=>F({...E,category:w.target.value}),children:[e.jsx("option",{value:"finished",children:"Finished Product"}),e.jsx("option",{value:"raw",children:"Raw Material"}),e.jsx("option",{value:"service",children:"Service"})]}),e.jsx("input",{type:"number",placeholder:"Selling Price",className:"input",value:E.price,onChange:w=>F({...E,price:w.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Cost Price (Optional)",className:"input",value:E.cost,onChange:w=>F({...E,cost:w.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Product Image"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:w=>As(w,!0),className:"input"}),e.jsx(zi,{className:"w-5 h-5 text-gray-400"})]}),C&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:C,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Product"}),e.jsx("button",{type:"button",onClick:()=>{T(!1),_(""),F({name:"",price:"",cost:"",category:"finished",image:""})},className:"btn-secondary",children:"Cancel"})]})]})]}),M&&A&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border-2 border-blue-200",children:[e.jsxs("h4",{className:"font-semibold mb-4 text-lg",children:["Add Stock for ",A.name]}),e.jsxs("form",{onSubmit:rc,className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("input",{type:"number",placeholder:"Quantity",className:"input",value:te.quantity,onChange:w=>ye({...te,quantity:w.target.value}),required:!0}),e.jsx("input",{type:"date",placeholder:"Expiry Date (Optional)",className:"input",value:te.expiryDate,onChange:w=>ye({...te,expiryDate:w.target.value})}),e.jsx("input",{type:"text",placeholder:"Batch Number (Optional)",className:"input",value:te.batchNumber,onChange:w=>ye({...te,batchNumber:w.target.value})}),e.jsx("input",{type:"number",placeholder:"Cost per Unit",className:"input",value:te.cost,onChange:w=>ye({...te,cost:w.target.value})}),e.jsxs("div",{className:"flex gap-2 md:col-span-4",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add Stock"}),e.jsx("button",{type:"button",onClick:()=>{N(!1),L(null),ye({quantity:"",expiryDate:"",batchNumber:"",cost:""})},className:"btn-secondary",children:"Cancel"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Stock"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Batches"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:l.map(w=>{const R=Ds(w.id),H=d.filter(ne=>ne.productId===w.id&&ne.quantity>0),Y=R<10;return e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[w.image&&e.jsx("img",{src:w.image,alt:w.name,className:"w-10 h-10 object-cover rounded-lg"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:w.name}),e.jsx("div",{className:"text-xs text-gray-500",children:w.category})]})]})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-green-600",children:["KSH ",w.price?.toLocaleString()]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-medium ${R===0?"text-red-600":Y?"text-yellow-600":"text-gray-900"}`,children:R}),Y&&R>0&&e.jsx(qt,{className:"w-4 h-4 text-yellow-500"}),R===0&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full font-medium",children:"Out of Stock"})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:"text-gray-600",children:[H.length," active"]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{L(w),N(!0)},className:"p-2 hover:bg-blue-50 rounded-lg text-blue-600 transition-colors",title:"Add Stock",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 hover:bg-green-50 rounded-lg text-green-600 transition-colors",title:"Edit Product",children:e.jsx(Et,{className:"w-4 h-4"})})]})})]},w.id)})})]})})]})}),")}",y==="expenses"&&e.jsx("div",{className:"p-6 max-w-7xl mx-auto w-full",children:e.jsxs("div",{className:"card shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Track Expenses"}),e.jsxs("button",{onClick:()=>Be(!0),className:"btn-primary flex items-center gap-2 bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700",children:[e.jsx(ge,{className:"w-4 h-4"}),"Add Expense"]})]}),we&&e.jsxs("div",{className:"mb-6 p-6 bg-gradient-to-br from-red-50 to-pink-50 rounded-xl border-2 border-red-200",children:[e.jsx("h4",{className:"font-semibold mb-4 text-lg",children:"Add New Expense"}),e.jsxs("form",{onSubmit:ic,className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("input",{type:"text",placeholder:"Description",className:"input",value:q.description,onChange:w=>J({...q,description:w.target.value}),required:!0}),e.jsx("input",{type:"number",placeholder:"Amount",className:"input",value:q.amount,onChange:w=>J({...q,amount:w.target.value}),required:!0}),e.jsx("input",{type:"text",placeholder:"Category",className:"input",value:q.category,onChange:w=>J({...q,category:w.target.value})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Add"}),e.jsx("button",{type:"button",onClick:()=>Be(!1),className:"btn-secondary",children:"Cancel"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Amount"})]})}),e.jsx("tbody",{children:p.expenses.slice().reverse().map((w,R)=>e.jsxs("tr",{className:"border-t border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(w.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:w.description}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"badge badge-warning",children:w.category||"General"})}),e.jsxs("td",{className:"px-4 py-3 text-sm font-semibold text-red-600",children:["KSH ",w.amount?.toLocaleString()]})]},R))})]})})]})}),ue&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full max-h-96 overflow-y-auto",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 p-6 text-white flex justify-between items-center sticky top-0",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(At,{}),"Request Credit"]}),e.jsx("button",{onClick:()=>de(!1),className:"hover:bg-white/20 p-2 rounded-lg transition",children:e.jsx(Qe,{size:24})})]}),e.jsxs("form",{onSubmit:oc,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Customer Name *"}),e.jsx("input",{type:"text",placeholder:"Enter customer name",value:oe.customerName,onChange:w=>ve({...oe,customerName:w.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:D})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Amount (KES) *"}),e.jsx("input",{type:"number",placeholder:"0.00",value:oe.amount,onChange:w=>ve({...oe,amount:w.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",step:"0.01",required:!0,disabled:D})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Reason"}),e.jsxs("select",{value:oe.reason,onChange:w=>ve({...oe,reason:w.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:D,children:[e.jsx("option",{value:"",children:"Select reason..."}),e.jsx("option",{value:"regular_customer",children:"Regular Customer"}),e.jsx("option",{value:"emergency",children:"Emergency"}),e.jsx("option",{value:"bulk_order",children:"Bulk Order"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notes"}),e.jsx("textarea",{placeholder:"Add any additional notes...",value:oe.notes,onChange:w=>ve({...oe,notes:w.target.value}),className:"w-full px-4 py-3 rounded-lg border focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3",disabled:D})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx("button",{type:"submit",disabled:D,className:"flex-1 bg-gradient-to-r from-blue-500 to-indigo-600 text-white py-3 rounded-lg font-bold hover:shadow-lg transition disabled:opacity-50 disabled:cursor-not-allowed",children:D?"Submitting...":"Submit Request"}),e.jsx("button",{type:"button",onClick:()=>de(!1),disabled:D,className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition disabled:opacity-50",children:"Cancel"})]})]})]})}),e.jsx(Bp,{isLocked:r,onUnlock:i,userPin:t?.pin||"1234",userName:t?.name})]})}function Yp(){const{user:t,logout:s}=re(),a=Ee(),[n,r]=h.useState({sales:0,count:0});return h.useEffect(()=>{const o=JSON.parse(localStorage.getItem("dayStats")||'{"sales": 0, "count": 0}');r(o)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-900 to-amber-700",children:[e.jsx("div",{className:"bg-amber-900 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qi,{size:32,className:"text-amber-300"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Bar POS"}),e.jsx("p",{className:"text-amber-200 text-sm",children:"Drinks & Beverages"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-amber-200 text-sm",children:"Today's Sales"}),e.jsxs("p",{className:"text-2xl font-bold text-green-400",children:[n.sales.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-amber-300 text-xs",children:[n.count," transactions"]})]}),e.jsxs("button",{onClick:()=>{s(),a("/auth/login")},className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg transition",children:[e.jsx(ot,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-amber-800 text-white border-b border-amber-700",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-amber-600 rounded-lg font-semibold",children:"ðŸº Beer"}),e.jsx("div",{className:"px-4 py-2 hover:bg-amber-700 rounded-lg cursor-pointer transition",children:"ðŸ· Wine"}),e.jsx("div",{className:"px-4 py-2 hover:bg-amber-700 rounded-lg cursor-pointer transition",children:"ðŸ¥ƒ Spirits"}),e.jsx("div",{className:"px-4 py-2 hover:bg-amber-700 rounded-lg cursor-pointer transition",children:"ðŸ§Š Mixers"}),e.jsx("div",{className:"px-4 py-2 hover:bg-amber-700 rounded-lg cursor-pointer transition",children:"ðŸ¸ Cocktails"})]})}),e.jsx("div",{className:"bg-amber-50",children:e.jsx(yt,{businessType:"bar"})}),e.jsx("div",{className:"bg-amber-900 text-white py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(ps,{size:16,className:"text-yellow-400"}),e.jsx("p",{className:"text-sm",children:"Fast checkout â€¢ Age verification on premium items â€¢ Real-time inventory"})]})})]})}function Xp(){const{user:t,logout:s}=re(),a=Ee(),[n,r]=h.useState(""),[o,i]=h.useState({revenue:0,patients:0});return h.useEffect(()=>{const l=JSON.parse(localStorage.getItem("dayStats")||'{"revenue": 0, "patients": 0}');i(l)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-red-100",children:[e.jsx("div",{className:"bg-red-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oc,{size:32,className:"text-red-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Hospital POS"}),e.jsx("p",{className:"text-red-200 text-sm",children:"Patient Billing System"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-red-200 text-sm",children:"Daily Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-green-300",children:[o.revenue.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-red-200 text-xs",children:[o.patients," patients served"]})]}),e.jsxs("button",{onClick:()=>{s(),a("/auth/login")},className:"flex items-center gap-2 bg-red-900 hover:bg-red-950 px-4 py-2 rounded-lg transition",children:[e.jsx(ot,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Kt,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search patient by ID or name...",value:n,onChange:l=>r(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-red-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),e.jsxs("button",{className:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition flex items-center gap-2",children:[e.jsx(tt,{size:18}),"Recent Patients"]})]})})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-red-600 text-white rounded-lg font-semibold",children:"ðŸ¥ Services"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ’Š Medicines"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ§ª Lab Tests"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ“‹ Procedures"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(yt,{businessType:"hospital"})}),e.jsx("div",{className:"bg-red-700 text-white py-4 text-center",children:e.jsx("p",{className:"text-sm",children:"Patient records integrated â€¢ Invoice generation â€¢ Real-time inventory tracking"})})]})}function Zp(){const{user:t,logout:s}=re(),a=Ee(),[n,r]=h.useState(""),[o,i]=h.useState({feesCollected:0,transactions:0});return h.useEffect(()=>{const l=JSON.parse(localStorage.getItem("dayStats")||'{"feesCollected": 0, "transactions": 0}');i(l)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-blue-100",children:[e.jsx("div",{className:"bg-blue-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($c,{size:32,className:"text-blue-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"School POS"}),e.jsx("p",{className:"text-blue-200 text-sm",children:"Student & Fee Management"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-blue-200 text-sm",children:"Fees Collected Today"}),e.jsxs("p",{className:"text-2xl font-bold text-green-300",children:[o.feesCollected.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-blue-200 text-xs",children:[o.transactions," transactions"]})]}),e.jsxs("button",{onClick:()=>{s(),a("/auth/login")},className:"flex items-center gap-2 bg-blue-900 hover:bg-blue-950 px-4 py-2 rounded-lg transition",children:[e.jsx(ot,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(be,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search student by name, admission number, or class...",value:n,onChange:l=>r(l.target.value),className:"w-full pl-10 pr-4 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition flex items-center gap-2",children:[e.jsx(Vc,{size:18}),"Fee Slip"]})]})})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold",children:"ðŸ’° Term Fees"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ½ï¸ Canteen"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ‘• Uniforms"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ“š Books"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"âœï¸ Supplies"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(yt,{businessType:"school"})}),e.jsx("div",{className:"bg-blue-700 text-white py-4 text-center",children:e.jsx("p",{className:"text-sm",children:"Student records linked â€¢ Receipt generation â€¢ Year-end reports"})})]})}function Qp(){const{user:t,logout:s}=re(),a=Ee(),[n,r]=h.useState({sales:0,itemsSold:0,lowStockItems:0});return h.useEffect(()=>{const o=JSON.parse(localStorage.getItem("dayStats")||'{"sales": 0, "itemsSold": 0, "lowStockItems": 0}');r(o)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-green-100",children:[e.jsx("div",{className:"bg-green-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ka,{size:32,className:"text-green-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Kiosk POS"}),e.jsx("p",{className:"text-green-200 text-sm",children:"Fast & Simple Checkout"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-green-200 text-sm",children:"Today's Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-300",children:[n.sales.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-green-200 text-xs",children:[n.itemsSold," items sold"]})]}),e.jsxs("button",{onClick:()=>{s(),a("/auth/login")},className:"flex items-center gap-2 bg-green-900 hover:bg-green-950 px-4 py-2 rounded-lg transition",children:[e.jsx(ot,{size:20}),"Logout"]})]})]})})}),n.lowStockItems>0&&e.jsx("div",{className:"bg-yellow-50 border-b border-yellow-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center gap-2 text-yellow-800",children:[e.jsx(ft,{size:20}),e.jsxs("span",{className:"font-semibold",children:[n.lowStockItems," items running low on stock"]})]})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-green-600 text-white rounded-lg font-semibold",children:"ðŸª All Items"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ”Œ Electronics"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸª Food"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ¥¤ Drinks"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ›’ Supplies"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(yt,{businessType:"kiosk"})}),e.jsxs("div",{className:"bg-green-700 text-white py-4 text-center flex items-center justify-center gap-2",children:[e.jsx(ps,{size:18,className:"text-yellow-300"}),e.jsx("p",{className:"text-sm",children:"Lightning-fast checkout â€¢ Low stock alerts â€¢ Real-time updates"})]})]})}function ef(){const{user:t,logout:s}=re(),a=Ee(),[n,r]=h.useState("1"),[o,i]=h.useState({revenue:0,liters:0,pumpTotal:0});return h.useEffect(()=>{const l=JSON.parse(localStorage.getItem("dayStats")||'{"revenue": 0, "liters": 0, "pumpTotal": 0}');i(l)},[]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-yellow-100",children:[e.jsx("div",{className:"bg-gradient-to-r from-yellow-600 to-yellow-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xi,{size:32,className:"text-yellow-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Petrol POS"}),e.jsx("p",{className:"text-yellow-200 text-sm",children:"Fuel & Tank Management"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-yellow-200 text-sm",children:"Daily Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-green-300",children:[o.revenue.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-yellow-200 text-xs",children:[o.liters.toLocaleString()," liters sold"]})]}),e.jsxs("button",{onClick:()=>{s(),a("/auth/login")},className:"flex items-center gap-2 bg-yellow-900 hover:bg-yellow-950 px-4 py-2 rounded-lg transition",children:[e.jsx(ot,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Select Pump:"}),e.jsx("div",{className:"flex gap-3",children:[1,2,3,4,5,6].map(l=>e.jsxs("button",{onClick:()=>r(l.toString()),className:`px-6 py-2 rounded-lg font-bold transition ${n===l.toString()?"bg-yellow-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[e.jsx(Bc,{size:18,className:"inline mr-2"}),"Pump ",l]},l))}),e.jsxs("div",{className:"ml-auto text-right",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Pump ",n," Total"]}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:[o.pumpTotal.toLocaleString()," KES"]})]})]})})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-yellow-600 text-white rounded-lg font-semibold",children:"â›½ Super"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"â›½ Regular"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"â›½ Diesel"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ›¢ï¸ LPG"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(yt,{businessType:"petrol",pumpNumber:n})}),e.jsxs("div",{className:"bg-yellow-700 text-white py-4 text-center flex items-center justify-center gap-2",children:[e.jsx(Ae,{size:18}),e.jsx("p",{className:"text-sm",children:"Pump tracking â€¢ Tank management â€¢ Shift reconciliation â€¢ Real-time readings"})]})]})}function tf(){const{user:t,logout:s}=re(),a=Ee(),[n,r]=h.useState({size:"",color:""}),[o,i]=h.useState({sales:0,pairs:0,topSize:""});h.useEffect(()=>{const d=JSON.parse(localStorage.getItem("dayStats")||'{"sales": 0, "pairs": 0, "topSize": ""}');i(d)},[]);const l=["5","6","7","8","9","10","11","12","13"],c=["Black","White","Brown","Blue","Red","Green","Pink","Gray"];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-purple-100",children:[e.jsx("div",{className:"bg-purple-700 text-white shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 text-purple-200",children:"ðŸ‘Ÿ"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Shoes POS"}),e.jsx("p",{className:"text-purple-200 text-sm",children:"Footwear & Variants"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-purple-200 text-sm",children:"Daily Sales"}),e.jsxs("p",{className:"text-2xl font-bold text-green-300",children:[o.sales.toLocaleString()," KES"]}),e.jsxs("p",{className:"text-purple-200 text-xs",children:[o.pairs," pairs sold â€¢ Top: Size ",o.topSize]})]}),e.jsxs("button",{onClick:()=>{s(),a("/auth/login")},className:"flex items-center gap-2 bg-purple-900 hover:bg-purple-950 px-4 py-2 rounded-lg transition",children:[e.jsx(ot,{size:20}),"Logout"]})]})]})})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx(_c,{size:18,className:"inline mr-2"}),"Filter by Size"]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:l.map(d=>e.jsx("button",{onClick:()=>r({...n,size:d===n.size?"":d}),className:`w-10 h-10 rounded-lg font-bold transition ${n.size===d?"bg-purple-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:d},d))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[e.jsx(De,{size:18,className:"inline mr-2"}),"Filter by Color"]}),e.jsxs("select",{value:n.color,onChange:d=>r({...n,color:d.target.value}),className:"px-4 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Colors"}),c.map(d=>e.jsx("option",{value:d,children:d},d))]})]})]})})}),e.jsx("div",{className:"bg-gray-100 border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex gap-4 overflow-x-auto",children:[e.jsx("div",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg font-semibold",children:"ðŸ‘Ÿ All Shoes"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸƒ Sports"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ‘ž Formal"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ‘  Casual"}),e.jsx("div",{className:"px-4 py-2 bg-white rounded-lg cursor-pointer hover:bg-gray-200 transition",children:"ðŸ‘¢ Boots"})]})}),e.jsx("div",{className:"bg-white",children:e.jsx(yt,{businessType:"shoes",filters:n})}),e.jsx("div",{className:"bg-purple-700 text-white py-4 text-center",children:e.jsx("p",{className:"text-sm",children:"Variant management â€¢ Size & color tracking â€¢ Stock by variant â€¢ Real-time availability"})})]})}function Vi(){const[t,s]=h.useState([]),[a,n]=h.useState([]),[r,o]=h.useState("all"),[i,l]=h.useState(""),[c,d]=h.useState(!1),[u,x]=h.useState([]),[m,b]=h.useState({subject:"",message:""}),[f,y]=h.useState(!0),[g,p]=h.useState(null),[v,j]=h.useState(!0),[S,P]=h.useState(null),T=Ee(),[M,N]=h.useState({totalUsers:0,activeUsers:0,lockedUsers:0,totalRevenue:0,pendingPayments:0,overduePayments:0}),[A,L]=h.useState([]);h.useEffect(()=>{const D=localStorage.getItem("token")||localStorage.getItem("mainAdminToken"),K=localStorage.getItem("user")||localStorage.getItem("mainAdminUser");if(!D||!K){T("/main-admin/login");return}try{if(JSON.parse(K).role!=="owner"){T("/main-admin/login");return}}catch{T("/main-admin/login");return}E().finally(()=>y(!1));const q=JSON.parse(localStorage.getItem("authActivities")||"[]");L(q.slice(0,10));const J=setInterval(()=>{const C=JSON.parse(localStorage.getItem("authActivities")||"[]");L(C.slice(0,10))},5e3);return()=>clearInterval(J)},[T]);const E=async()=>{try{p(null);let D=[],K=!0;try{D=await Na.getUsers()}catch(q){console.warn("MainAdmin API not available, falling back to regular users API:",q.message);try{D=await kt.getAll()}catch(J){console.warn("Users API also failed:",J.message),K=!1}}D.length===0&&!K&&(D=te()),s(D),j(K),we(D,[])}catch(D){console.error("Failed to load data:",D),p("Failed to load dashboard data");const K=te();s(K),n(ye(K)),j(!1),we(K,[])}},F=()=>{localStorage.removeItem("mainAdminToken"),localStorage.removeItem("mainAdminUser"),T("/main-admin/login")},te=()=>{const D=localStorage.getItem("user"),K=[];if(D){const J=JSON.parse(D);K.push({...J,id:J.id||"real-user"})}return[{name:"John Doe",email:"john@example.com",plan:"ultra",price:1600,active:!0,locked:!1,role:"admin"},{name:"Jane Smith",email:"jane@example.com",plan:"basic",price:900,active:!0,locked:!1,role:"cashier"},{name:"Bob Wilson",email:"bob@example.com",plan:"ultra",price:1600,active:!1,locked:!1,role:"admin"},{name:"Alice Brown",email:"alice@example.com",plan:"basic",price:900,active:!0,locked:!0,role:"cashier"},{name:"Mike Johnson",email:"mike@example.com",plan:"ultra",price:1600,active:!0,locked:!1,role:"admin"},{name:"Sarah Davis",email:"sarah@example.com",plan:"basic",price:900,active:!1,locked:!1,role:"cashier"}].forEach((J,C)=>{K.push({id:`demo-${C+1}`,...J,createdAt:new Date(Date.now()-C*864e5).toISOString(),lastLogin:new Date(Date.now()-Math.random()*864e5).toISOString()})}),K},ye=D=>D.flatMap(K=>[{id:`payment-${K.id}-1`,userId:K.id,amount:K.plan==="ultra"?1600:900,status:Math.random()>.3?"paid":"pending",createdAt:new Date(Date.now()-30*864e5).toISOString(),dueDate:new Date(Date.now()+5*864e5).toISOString()},{id:`payment-${K.id}-2`,userId:K.id,amount:K.plan==="ultra"?1600:900,status:Math.random()>.7?"paid":Math.random()>.5?"pending":"overdue",createdAt:new Date(Date.now()-60*864e5).toISOString(),dueDate:new Date(Date.now()-5*864e5).toISOString()}]),we=(D,K)=>{const q=D.length,J=D.filter(G=>G.active).length,C=D.filter(G=>G.locked).length,_=K.filter(G=>G.status==="paid").reduce((G,he)=>G+he.amount,0),O=K.filter(G=>G.status==="pending").length,Q=K.filter(G=>G.status==="overdue").length;N({totalUsers:q,activeUsers:J,lockedUsers:C,totalRevenue:_,pendingPayments:O,overduePayments:Q})},Be=async(D,K)=>{try{P(D);const q=!K;try{await Na.lockUser(D,q);const J=t.map(O=>O.id===D?{...O,locked:q,active:!q}:O);s(J),we(J,a);const C=t.find(O=>O.id===D),_=q?"locked":"unlocked";alert(`âœ… ${C?.name||`User ${D}`} has been ${_} successfully!`)}catch(J){console.error("API lock failed:",J);const C=t.map(Q=>Q.id===D?{...Q,locked:q,active:!q}:Q);s(C),we(C,a);const _=t.find(Q=>Q.id===D),O=q?"locked":"unlocked";alert(`âš ï¸ Backend not available. ${_?.name||`User ${D}`} ${O} locally. Changes will sync when backend is available.`)}}catch(q){console.error("Failed to toggle lock:",q),alert(`âŒ Failed to update user status: ${q.message}`)}finally{P(null)}},ue=async(D,K,q)=>{try{y(!0);try{await Na.sendEmail({userIds:D,subject:K,message:q}),alert("Emails sent successfully!"),d(!1),x([]),b({subject:"",message:""});return}catch(_){console.warn("Backend email operation failed, simulating email send:",_.message)}const J=t.filter(_=>D.includes(_.id)),C=JSON.parse(localStorage.getItem("emailLogs")||"[]");C.push({timestamp:new Date().toISOString(),recipients:J.map(_=>({id:_.id,name:_.name,email:_.email})),subject:K,message:q,status:"simulated"}),localStorage.setItem("emailLogs",JSON.stringify(C)),alert(`âœ… Email simulation successful!

ðŸ“§ Sent to ${J.length} user(s):
${J.map(_=>`${_.name} (${_.email})`).join(`
`)}

${v?"":`ðŸ“Œ Backend not deployed - this was a simulation.
`}ðŸ’¡ Deploy backend to send real emails.`),d(!1),x([]),b({subject:"",message:""})}catch(J){console.error("Failed to send email:",J),alert("Failed to process email request.")}finally{y(!1)}},de=async D=>{const K=t.find(q=>q.id===D);K&&await ue([D],"Payment Reminder - Subscription",`Dear ${K.name},

This is a friendly reminder about your pending subscription payment for ${K.plan?.toUpperCase()} plan (KSH ${K.price}).

Please complete your payment to continue enjoying our services.

Thank you!`)},oe=t.filter(D=>{const K=D.name?.toLowerCase().includes(i.toLowerCase())||D.email?.toLowerCase().includes(i.toLowerCase());if(r==="all")return K;if(r==="active")return K&&D.active&&!D.locked;if(r==="locked")return K&&D.locked;if(r==="trial")return K&&(!D.active||!D.plan);if(r==="pending-payment"){const q=a.filter(J=>J.userId===D.id&&J.status==="pending");return K&&q.length>0}if(r==="overdue"){const q=a.filter(J=>J.userId===D.id&&J.status==="overdue");return K&&q.length>0}return K}),ve=D=>{const K=a.filter(_=>_.userId===D),q=K.filter(_=>_.status==="pending").length,J=K.filter(_=>_.status==="overdue").length,C=K.filter(_=>_.status==="paid").length;return{pending:q,overdue:J,paid:C,total:K.length}};return f&&t.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-white mx-auto mb-4"}),e.jsx("p",{className:"text-white text-xl",children:"Loading Main Admin Dashboard..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900",children:[!v&&e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 text-center",children:e.jsxs("p",{className:"text-sm md:text-base font-semibold",children:["âš ï¸ Demo Mode: Backend not available. Actions are simulated locally.",e.jsx("a",{href:"/BACKEND_NOT_DEPLOYED.md",className:"underline ml-2",children:"Deploy Backend â†’"})]})}),g&&e.jsx("div",{className:"bg-red-500 text-white px-6 py-3 text-center",children:e.jsxs("p",{className:"text-sm font-semibold",children:["âš ï¸ ",g]})}),e.jsx("header",{className:"bg-black/30 backdrop-blur-lg border-b border-white/10 px-6 py-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Main Admin Dashboard"}),e.jsx("p",{className:"text-gray-300",children:"Monitor all users, payments, and system activity"})]}),e.jsxs("button",{onClick:F,className:"flex items-center gap-2 bg-red-500/20 hover:bg-red-500/30 text-red-300 px-4 py-2 rounded-lg transition-colors",children:[e.jsx(ot,{className:"w-4 h-4"}),"Logout"]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(be,{className:"w-8 h-8 text-blue-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:M.totalUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Total Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ze,{className:"w-8 h-8 text-green-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:M.activeUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Active Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Ve,{className:"w-8 h-8 text-red-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:M.lockedUsers})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Locked Users"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx($e,{className:"w-8 h-8 text-yellow-400"}),e.jsxs("span",{className:"text-2xl font-bold text-white",children:["KSH ",M.totalRevenue.toLocaleString()]})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Total Revenue"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(qt,{className:"w-8 h-8 text-orange-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:M.pendingPayments})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Pending Payments"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ls,{className:"w-8 h-8 text-red-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:M.overduePayments})]}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Overdue Payments"})]})]}),e.jsx("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-4 flex-1 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-80",children:[e.jsx(Kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users...",className:"w-full pl-10 pr-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",value:i,onChange:D=>l(D.target.value)})]}),e.jsxs("select",{value:r,onChange:D=>o(D.target.value),className:"px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Users"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"locked",children:"Locked"}),e.jsx("option",{value:"trial",children:"Free Trial"}),e.jsx("option",{value:"pending-payment",children:"Pending Payment"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]}),e.jsxs("button",{onClick:()=>d(!0),disabled:u.length===0||f,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-6 py-3 rounded-lg font-bold flex items-center gap-2 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(zt,{className:"w-5 h-5"}),"Send Email to Selected (",u.length,")"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"xl:col-span-2 bg-white/10 backdrop-blur-lg rounded-xl border border-white/20 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsx("h2",{className:"text-xl font-bold text-white",children:"All Users"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-black/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 text-left",children:e.jsx("input",{type:"checkbox",checked:u.length===oe.length&&oe.length>0,onChange:D=>{D.target.checked?x(oe.map(K=>K.id)):x([])},className:"w-5 h-5 rounded"})}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"User"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Plan"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Status"}),e.jsx("th",{className:"px-4 py-4 text-left text-sm font-semibold text-gray-200",children:"Actions"})]})}),e.jsxs("tbody",{children:[oe.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",className:"px-4 py-12 text-center",children:[e.jsx(be,{className:"w-16 h-16 text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No users found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:i||r!=="all"?"Try adjusting your filters":"Users will appear here once they sign up"})]})}),oe.map(D=>(ve(D.id),e.jsxs("tr",{className:"border-t border-white/10 hover:bg-white/5 transition",children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:u.includes(D.id),onChange:K=>{K.target.checked?x([...u,D.id]):x(u.filter(q=>q!==D.id))},className:"w-5 h-5 rounded"})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[D.profilePicture?e.jsx("img",{src:D.profilePicture,alt:D.name,className:"w-10 h-10 rounded-full"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-purple-600 flex items-center justify-center text-white font-bold",children:D.name?.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-white",children:D.name}),e.jsx("p",{className:"text-sm text-gray-400",children:D.email})]})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${D.plan==="ultra"?"bg-purple-500/20 text-purple-300":"bg-blue-500/20 text-blue-300"}`,children:[D.plan?.toUpperCase()," - KSH ",D.price]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"flex items-center gap-2",children:D.locked?e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-red-500/20 text-red-300 flex items-center gap-1",children:[e.jsx(Ve,{className:"w-3 h-3"}),"Locked"]}):D.active?e.jsxs("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-green-500/20 text-green-300 flex items-center gap-1",children:[e.jsx(Ze,{className:"w-3 h-3"}),"Active"]}):e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-bold bg-gray-500/20 text-gray-300",children:"Inactive"})})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Be(D.id,D.locked),disabled:S===D.id,className:`p-2 rounded-lg transition ${D.locked?"bg-green-500/20 hover:bg-green-500/30 text-green-300":"bg-red-500/20 hover:bg-red-500/30 text-red-300"} ${S===D.id?"opacity-50 cursor-not-allowed":""}`,title:D.locked?"Unlock User":"Lock User",children:S===D.id?e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):D.locked?e.jsx(Uc,{className:"w-4 h-4"}):e.jsx(Ve,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>de(D.id),disabled:f,className:"p-2 rounded-lg bg-blue-500/20 hover:bg-blue-500/30 text-blue-300 transition",title:"Send Payment Reminder",children:e.jsx(eo,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{D.role==="cashier"?window.open("/dashboard/cashier","_blank"):window.open("/admin","_blank")},className:"p-2 rounded-lg bg-purple-500/20 hover:bg-purple-500/30 text-purple-300 transition",title:"View User Dashboard",children:e.jsx(Hi,{className:"w-4 h-4"})})]})})]},D.id)))]})]})})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl border border-white/20",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"Recent Activity"]})}),e.jsx("div",{className:"p-4 space-y-3 max-h-96 overflow-y-auto",children:A.length===0?e.jsx("p",{className:"text-gray-400 text-center py-8",children:"No recent activity"}):A.map(D=>e.jsxs("div",{className:"bg-white/5 rounded-lg p-3 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${D.type==="login"?"bg-green-400":"bg-blue-400"}`}),e.jsx("span",{className:"text-white font-medium",children:D.user.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${D.type==="login"?"bg-green-500/20 text-green-300":"bg-blue-500/20 text-blue-300"}`,children:D.type})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:D.user.email}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:new Date(D.timestamp).toLocaleString()})]},D.id))})]})]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-purple-900 rounded-2xl shadow-2xl max-w-2xl w-full border border-white/20",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6 text-white rounded-t-2xl",children:e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(zt,{}),"Send Email to ",u.length," User(s)"]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:m.subject,onChange:D=>b({...m,subject:D.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Email subject..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Message"}),e.jsx("textarea",{value:m.message,onChange:D=>b({...m,message:D.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 h-40",placeholder:"Email message..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>ue(u,m.subject,m.message),disabled:f,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-3 rounded-lg font-bold transition disabled:opacity-50",children:f?"Sending...":"Send Email"}),e.jsx("button",{onClick:()=>d(!1),className:"px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-lg font-bold transition",children:"Cancel"})]})]})]})})]})}function sf(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState([]),[o,i]=h.useState(!1),[l,c]=h.useState(!0),d=[{value:"registrar",label:"Registrar/Reception",icon:be},{value:"doctor",label:"Doctor",icon:Qs},{value:"pharmacist",label:"Pharmacist",icon:Tt},{value:"cashier",label:"Cashier",icon:zt}];h.useEffect(()=>{u(),x()},[]);const u=async()=>{try{const b=await Pe.get("/api/business/users");a(b.data.users||[]),c(!1)}catch(b){console.error("Failed to load staff:",b),c(!1)}},x=async()=>{try{const b=await Pe.get("/api/messages/inbox?limit=5");r(b.data.messages||[])}catch(b){console.error("Failed to load messages:",b)}},m=async b=>{try{const f={name:b.name,email:b.email,password:b.password,business_role:b.businessRole};await Pe.post("/api/business/users",f),i(!1),u()}catch(f){console.error("Failed to add staff:",f),alert("Failed to add staff member: "+(f.response?.data?.error||f.message))}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-600 via-cyan-600 to-teal-600 shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"text-5xl mr-3",children:"ðŸ¥"}),"Clinic Admin Dashboard"]}),e.jsx("p",{className:"text-cyan-100 mt-2 text-lg",children:"Manage your clinic staff and operations"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center px-6 py-3 bg-white text-blue-600 rounded-xl hover:bg-blue-50 shadow-lg transform transition hover:scale-105 font-semibold",children:[e.jsx(ge,{className:"w-5 h-5 mr-2"}),"Add Staff"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:d.map((b,f)=>{const y=b.icon,g=s.filter(v=>v.business_role===b.value).length,p=["from-blue-500 to-blue-600","from-cyan-500 to-cyan-600","from-teal-500 to-teal-600","from-green-500 to-green-600"];return e.jsx("div",{className:`bg-gradient-to-br ${p[f]} rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-100 font-medium",children:b.label}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:g})]}),e.jsx(y,{className:"w-12 h-12 opacity-80"})]})},b.value)})}),n.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg mb-8 p-6 border border-blue-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(Wt,{className:"w-7 h-7 mr-3 text-blue-600"}),"Recent Messages"]}),e.jsx("a",{href:"/messages",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"View all â†’"})]}),e.jsx("div",{className:"space-y-3",children:n.map(b=>e.jsx("div",{className:"flex items-start p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:b.fromUserName}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(b.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:b.content}),e.jsxs("span",{className:"text-xs text-blue-600 mt-1 inline-block",children:["From: ",b.fromRole]})]})},b.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-blue-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-cyan-50",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Clinic Staff"})}),e.jsx("div",{className:"p-6",children:l?e.jsx("p",{className:"text-center text-gray-600",children:"Loading staff..."}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No staff members yet"}),e.jsx("button",{onClick:()=>i(!0),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Add your first staff member"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-gray-900",children:b.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:b.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:b.business_role||b.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${b.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.is_active?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[e.jsx("button",{className:"text-blue-600 hover:text-blue-700 mr-3",children:"Edit"}),e.jsx("button",{className:"text-red-600 hover:text-red-700",children:"Remove"})]})]},b.id))})]})})})]})]}),o&&e.jsx(af,{roles:d,onClose:()=>i(!1),onSubmit:m})]})}function af({roles:t,onClose:s,onSubmit:a}){const[n,r]=h.useState({name:"",email:"",password:"",businessRole:""}),o=i=>{if(i.preventDefault(),!n.name||!n.email||!n.password||!n.businessRole){alert("Please fill all fields");return}a(n)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-600 to-cyan-600",children:e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Add New Staff Member"})}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:n.name,onChange:i=>r({...n,name:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Dr. John Doe",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:n.email,onChange:i=>r({...n,email:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"john@clinic.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:n.password,onChange:i=>r({...n,password:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:n.businessRole,onChange:i=>r({...n,businessRole:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",required:!0,children:[e.jsx("option",{value:"",children:"Select role..."}),t.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-xl hover:from-blue-700 hover:to-cyan-700 transition font-semibold shadow-lg",children:"Add Staff"})]})]})]})})}function nf(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState([]),[o,i]=h.useState(!1),[l,c]=h.useState(!0),d=[{value:"bartender",label:"Bartender",icon:Qi},{value:"cashier",label:"Cashier",icon:$e},{value:"store",label:"Store Manager",icon:De}];h.useEffect(()=>{u(),x()},[]);const u=async()=>{try{const b=await Pe.get("/api/business/users");a(b.data.users||[]),c(!1)}catch(b){console.error("Failed to load staff:",b),c(!1)}},x=async()=>{try{const b=await Pe.get("/api/messages/inbox?limit=5");r(b.data.messages||[])}catch(b){console.error("Failed to load messages:",b)}},m=async b=>{try{const f={name:b.name,email:b.email,password:b.password,business_role:b.businessRole};await Pe.post("/api/business/users",f),i(!1),u()}catch(f){console.error("Failed to add staff:",f),alert("Failed to add staff member: "+(f.response?.data?.error||f.message))}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-pink-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-600 via-pink-600 to-indigo-600 shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"text-5xl mr-3",children:"ðŸ»"}),"Bar Admin Dashboard"]}),e.jsx("p",{className:"text-purple-100 mt-2 text-lg",children:"Manage your bar staff and operations"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center px-6 py-3 bg-white text-purple-600 rounded-xl hover:bg-purple-50 shadow-lg transform transition hover:scale-105 font-semibold",children:[e.jsx(ge,{className:"w-5 h-5 mr-2"}),"Add Staff"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:d.map((b,f)=>{const y=b.icon,g=s.filter(v=>v.business_role===b.value).length,p=["from-purple-500 to-purple-600","from-pink-500 to-pink-600","from-indigo-500 to-indigo-600"];return e.jsx("div",{className:`bg-gradient-to-br ${p[f]} rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-100 font-medium",children:b.label}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:g})]}),e.jsx(y,{className:"w-12 h-12 opacity-80"})]})},b.value)})}),n.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg mb-8 p-6 border border-purple-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(Wt,{className:"w-7 h-7 mr-3 text-purple-600"}),"Recent Messages"]}),e.jsx("a",{href:"/messages",className:"text-purple-600 hover:text-purple-700 font-semibold",children:"View all â†’"})]}),e.jsx("div",{className:"space-y-3",children:n.map(b=>e.jsx("div",{className:"flex items-start p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:b.fromUserName}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(b.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:b.content}),e.jsxs("span",{className:"text-xs text-purple-600 mt-1 inline-block",children:["From: ",b.fromRole]})]})},b.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-purple-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-pink-50",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Bar Staff"})}),e.jsx("div",{className:"p-6",children:l?e.jsx("p",{className:"text-center text-gray-600",children:"Loading staff..."}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No staff members yet"}),e.jsx("button",{onClick:()=>i(!0),className:"text-purple-600 hover:text-purple-700 font-medium",children:"Add your first staff member"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-gray-900",children:b.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:b.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800",children:b.business_role||b.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${b.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.is_active?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[e.jsx("button",{className:"text-purple-600 hover:text-purple-700 mr-3",children:"Edit"}),e.jsx("button",{className:"text-red-600 hover:text-red-700",children:"Remove"})]})]},b.id))})]})})})]})]}),o&&e.jsx(rf,{roles:d,onClose:()=>i(!1),onSubmit:m})]})}function rf({roles:t,onClose:s,onSubmit:a}){const[n,r]=h.useState({name:"",email:"",password:"",businessRole:""}),o=i=>{if(i.preventDefault(),!n.name||!n.email||!n.password||!n.businessRole){alert("Please fill all fields");return}a(n)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-600 to-pink-600",children:e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Add New Staff Member"})}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:n.name,onChange:i=>r({...n,name:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"John Doe",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:n.email,onChange:i=>r({...n,email:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"john@bar.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:n.password,onChange:i=>r({...n,password:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:n.businessRole,onChange:i=>r({...n,businessRole:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition",required:!0,children:[e.jsx("option",{value:"",children:"Select role..."}),t.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-xl hover:from-purple-700 hover:to-pink-700 transition font-semibold shadow-lg",children:"Add Staff"})]})]})]})})}function of(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState([]),[o,i]=h.useState(!1),[l,c]=h.useState(!0),[d,u]=h.useState({totalRooms:0,occupied:0,available:0,maintenance:0}),x=[{value:"receptionist",label:"Receptionist",icon:cr},{value:"housekeeping",label:"Housekeeping",icon:Ha},{value:"manager",label:"Manager",icon:pt},{value:"cashier",label:"Cashier",icon:tt}];h.useEffect(()=>{m(),b(),f()},[]);const m=async()=>{try{const p=await Pe.get("/api/business/users");a(p.data.users||[]),c(!1)}catch(p){console.error("Failed to load staff:",p),c(!1)}},b=async()=>{try{const p=await Pe.get("/api/messages/inbox?limit=5");r(p.data.messages||[])}catch(p){console.error("Failed to load messages:",p)}},f=async()=>{try{u({totalRooms:50,occupied:32,available:15,maintenance:3})}catch(p){console.error("Failed to load stats:",p)}},y=async p=>{try{const v={name:p.name,email:p.email,password:p.password,business_role:p.businessRole};await Pe.post("/api/business/users",v),i(!1),m()}catch(v){console.error("Failed to add staff:",v),alert("Failed to add staff member: "+(v.response?.data?.error||v.message))}},g=d.totalRooms>0?Math.round(d.occupied/d.totalRooms*100):0;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 via-white to-orange-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-600 via-orange-600 to-red-600 shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"text-5xl mr-3",children:"ðŸ¨"}),"Hotel Admin Dashboard"]}),e.jsx("p",{className:"text-amber-100 mt-2 text-lg",children:"Manage your hotel staff and operations"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center px-6 py-3 bg-white text-amber-600 rounded-xl hover:bg-amber-50 shadow-lg transform transition hover:scale-105 font-semibold",children:[e.jsx(ge,{className:"w-5 h-5 mr-2"}),"Add Staff"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-100 font-medium",children:"Total Rooms"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:d.totalRooms})]}),e.jsx(pt,{className:"w-12 h-12 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-100 font-medium",children:"Occupied"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:d.occupied})]}),e.jsx(Ha,{className:"w-12 h-12 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-100 font-medium",children:"Available"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:d.available})]}),e.jsx(cr,{className:"w-12 h-12 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-100 font-medium",children:"Occupancy Rate"}),e.jsxs("p",{className:"text-3xl font-bold mt-2",children:[g,"%"]})]}),e.jsx(pt,{className:"w-12 h-12 opacity-80"})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:x.map((p,v)=>{const j=p.icon,S=s.filter(T=>T.business_role===p.value).length,P=["from-amber-500 to-amber-600","from-orange-500 to-orange-600","from-red-500 to-red-600","from-rose-500 to-rose-600"];return e.jsx("div",{className:`bg-gradient-to-br ${P[v]} rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-amber-100 font-medium",children:p.label}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:S})]}),e.jsx(j,{className:"w-12 h-12 opacity-80"})]})},p.value)})}),n.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg mb-8 p-6 border border-amber-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(Wt,{className:"w-7 h-7 mr-3 text-amber-600"}),"Recent Messages"]}),e.jsx("a",{href:"/messages",className:"text-amber-600 hover:text-amber-700 font-semibold",children:"View all â†’"})]}),e.jsx("div",{className:"space-y-3",children:n.map(p=>e.jsx("div",{className:"flex items-start p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:p.fromUserName}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(p.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:p.content}),e.jsxs("span",{className:"text-xs text-amber-600 mt-1 inline-block",children:["From: ",p.fromRole]})]})},p.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-amber-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-amber-50 to-orange-50",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Hotel Staff"})}),e.jsx("div",{className:"p-6",children:l?e.jsx("p",{className:"text-center text-gray-600",children:"Loading staff..."}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No staff members yet"}),e.jsx("button",{onClick:()=>i(!0),className:"text-amber-600 hover:text-amber-700 font-medium",children:"Add your first staff member"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(p=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-gray-900",children:p.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:p.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-amber-100 text-amber-800",children:p.business_role||p.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${p.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:p.is_active?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[e.jsx("button",{className:"text-amber-600 hover:text-amber-700 mr-3",children:"Edit"}),e.jsx("button",{className:"text-red-600 hover:text-red-700",children:"Remove"})]})]},p.id))})]})})})]})]}),o&&e.jsx(lf,{roles:x,onClose:()=>i(!1),onSubmit:y})]})}function lf({roles:t,onClose:s,onSubmit:a}){const[n,r]=h.useState({name:"",email:"",password:"",businessRole:""}),o=i=>{if(i.preventDefault(),!n.name||!n.email||!n.password||!n.businessRole){alert("Please fill all fields");return}a(n)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-amber-600 to-orange-600",children:e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Add New Staff Member"})}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:n.name,onChange:i=>r({...n,name:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-transparent transition",placeholder:"John Doe",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:n.email,onChange:i=>r({...n,email:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-transparent transition",placeholder:"john@hotel.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:n.password,onChange:i=>r({...n,password:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:n.businessRole,onChange:i=>r({...n,businessRole:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-amber-500 focus:border-transparent transition",required:!0,children:[e.jsx("option",{value:"",children:"Select role..."}),t.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-amber-600 to-orange-600 text-white rounded-xl hover:from-amber-700 hover:to-orange-700 transition font-semibold shadow-lg",children:"Add Staff"})]})]})]})})}function cf(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState([]),[o,i]=h.useState(!1),[l,c]=h.useState(!0),[d,u]=h.useState({todaySales:0,todayOrders:0,lowStockItems:0,departments:0}),x=[{value:"department_head",label:"Department Head",icon:De},{value:"cashier",label:"Cashier",icon:$e},{value:"stock_clerk",label:"Stock Clerk",icon:ct},{value:"supervisor",label:"Supervisor",icon:Ae}];h.useEffect(()=>{m(),b(),f()},[]);const m=async()=>{try{const g=await Pe.get("/api/business/users");a(g.data.users||[]),c(!1)}catch(g){console.error("Failed to load staff:",g),c(!1)}},b=async()=>{try{const g=await Pe.get("/api/messages/inbox?limit=5");r(g.data.messages||[])}catch(g){console.error("Failed to load messages:",g)}},f=async()=>{try{const g=await Pe.get("/api/v2/monitor/stats");u({todaySales:g.data.totalSales||0,todayOrders:g.data.transactionCount||0,lowStockItems:0,departments:8})}catch(g){console.error("Failed to load stats:",g)}},y=async g=>{try{const p={name:g.name,email:g.email,password:g.password,business_role:g.businessRole};await Pe.post("/api/business/users",p),i(!1),m()}catch(p){console.error("Failed to add staff:",p),alert("Failed to add staff member: "+(p.response?.data?.error||p.message))}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-green-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-emerald-600 via-green-600 to-teal-600 shadow-lg",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-4xl font-bold text-white flex items-center",children:[e.jsx("span",{className:"text-5xl mr-3",children:"ðŸ›’"}),"Supermarket Admin Dashboard"]}),e.jsx("p",{className:"text-emerald-100 mt-2 text-lg",children:"Manage your supermarket staff and operations"})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center px-6 py-3 bg-white text-emerald-600 rounded-xl hover:bg-emerald-50 shadow-lg transform transition hover:scale-105 font-semibold",children:[e.jsx(ge,{className:"w-5 h-5 mr-2"}),"Add Staff"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-emerald-100 font-medium",children:"Today's Sales"}),e.jsxs("p",{className:"text-3xl font-bold mt-2",children:["$",d.todaySales.toFixed(2)]})]}),e.jsx($e,{className:"w-12 h-12 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-100 font-medium",children:"Orders"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:d.todayOrders})]}),e.jsx(ct,{className:"w-12 h-12 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-teal-500 to-teal-600 rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-teal-100 font-medium",children:"Low Stock"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:d.lowStockItems})]}),e.jsx(De,{className:"w-12 h-12 opacity-80"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-cyan-500 to-cyan-600 rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-cyan-100 font-medium",children:"Departments"}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:d.departments})]}),e.jsx(Ae,{className:"w-12 h-12 opacity-80"})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:x.map((g,p)=>{const v=g.icon,j=s.filter(P=>P.business_role===g.value).length,S=["from-emerald-500 to-emerald-600","from-green-500 to-green-600","from-teal-500 to-teal-600","from-cyan-500 to-cyan-600"];return e.jsx("div",{className:`bg-gradient-to-br ${S[p]} rounded-xl shadow-lg p-6 text-white transform transition hover:scale-105`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-emerald-100 font-medium",children:g.label}),e.jsx("p",{className:"text-3xl font-bold mt-2",children:j})]}),e.jsx(v,{className:"w-12 h-12 opacity-80"})]})},g.value)})}),n.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg mb-8 p-6 border border-emerald-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[e.jsx(Wt,{className:"w-7 h-7 mr-3 text-emerald-600"}),"Recent Messages"]}),e.jsx("a",{href:"/messages",className:"text-emerald-600 hover:text-emerald-700 font-semibold",children:"View all â†’"})]}),e.jsx("div",{className:"space-y-3",children:n.map(g=>e.jsx("div",{className:"flex items-start p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:g.fromUserName}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(g.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:g.content}),e.jsxs("span",{className:"text-xs text-emerald-600 mt-1 inline-block",children:["From: ",g.fromRole]})]})},g.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-emerald-100",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-emerald-50 to-green-50",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Supermarket Staff"})}),e.jsx("div",{className:"p-6",children:l?e.jsx("p",{className:"text-center text-gray-600",children:"Loading staff..."}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No staff members yet"}),e.jsx("button",{onClick:()=>i(!0),className:"text-emerald-600 hover:text-emerald-700 font-medium",children:"Add your first staff member"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(g=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"font-medium text-gray-900",children:g.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:g.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-emerald-100 text-emerald-800",children:g.business_role||g.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${g.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:g.is_active?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:[e.jsx("button",{className:"text-emerald-600 hover:text-emerald-700 mr-3",children:"Edit"}),e.jsx("button",{className:"text-red-600 hover:text-red-700",children:"Remove"})]})]},g.id))})]})})})]})]}),o&&e.jsx(df,{roles:x,onClose:()=>i(!1),onSubmit:y})]})}function df({roles:t,onClose:s,onSubmit:a}){const[n,r]=h.useState({name:"",email:"",password:"",businessRole:""}),o=i=>{if(i.preventDefault(),!n.name||!n.email||!n.password||!n.businessRole){alert("Please fill all fields");return}a(n)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 transform transition-all",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-emerald-600 to-green-600",children:e.jsx("h3",{className:"text-2xl font-bold text-white",children:"Add New Staff Member"})}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:n.name,onChange:i=>r({...n,name:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition",placeholder:"John Doe",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:n.email,onChange:i=>r({...n,email:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition",placeholder:"john@supermarket.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{type:"password",value:n.password,onChange:i=>r({...n,password:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:n.businessRole,onChange:i=>r({...n,businessRole:i.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition",required:!0,children:[e.jsx("option",{value:"",children:"Select role..."}),t.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50 transition font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-emerald-600 to-green-600 text-white rounded-xl hover:from-emerald-700 hover:to-green-700 transition font-semibold shadow-lg",children:"Add Staff"})]})]})]})})}function uf(){const{user:t}=re(),[s,a]=h.useState([]),[n,r]=h.useState(0),[o,i]=h.useState(!1),[l,c]=h.useState([]);h.useEffect(()=>{d(),u()},[]);const d=async()=>{try{const x=await Pe.get("/api/messages/inbox");a(x.data.messages||[]),r(x.data.unreadCount||0)}catch(x){console.error("Failed to load messages:",x)}},u=async()=>{c([{id:1,name:"Patient A",status:"Waiting",room:"101"},{id:2,name:"Patient B",status:"In Progress",room:"102"}])};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-blue-600 shadow",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"ðŸ‘¨â€âš•ï¸ Doctor Dashboard"}),e.jsxs("p",{className:"text-blue-100 mt-1",children:["Welcome, Dr. ",t?.name]})]}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center px-4 py-2 bg-white text-blue-600 rounded-lg hover:bg-gray-100",children:[e.jsx(eo,{className:"w-5 h-5 mr-2"}),"Send Message"]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Patients Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:l.length})]}),e.jsx(be,{className:"w-10 h-10 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Unread Messages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:n})]}),e.jsx(Wt,{className:"w-10 h-10 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Prescriptions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:"0"})]}),e.jsx(Yi,{className:"w-10 h-10 text-blue-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-8 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Wt,{className:"w-6 h-6 mr-2 text-blue-600"}),"Messages"]}),s.length===0?e.jsx("p",{className:"text-center text-gray-600 py-8",children:"No messages"}):e.jsx("div",{className:"space-y-3",children:s.map(x=>e.jsx("div",{className:"flex items-start p-4 bg-gray-50 rounded-lg hover:bg-gray-100",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:x.fromUserName}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(x.timestamp).toLocaleString()})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:x.content}),e.jsxs("div",{className:"flex items-center mt-2",children:[e.jsxs("span",{className:"text-xs text-blue-600",children:["From: ",x.fromRole]}),x.status==="sent"&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded-full",children:"New"})]})]})},x.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center",children:[e.jsx(Qs,{className:"w-6 h-6 mr-2 text-blue-600"}),"Patient Queue"]}),l.length===0?e.jsx("p",{className:"text-center text-gray-600 py-8",children:"No patients in queue"}):e.jsx("div",{className:"space-y-3",children:l.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:x.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Room: ",x.room]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${x.status==="Waiting"?"bg-yellow-100 text-yellow-800":x.status==="In Progress"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:x.status}),e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700",children:"View"})]})]},x.id))})]})]}),o&&e.jsx(mf,{onClose:()=>i(!1)})]})}function mf({onClose:t}){const[s,a]=h.useState([]),[n,r]=h.useState({toRole:"",content:"",priority:"normal"});h.useEffect(()=>{o()},[]);const o=async()=>{try{const l=await Pe.get("/api/messages/available-roles");a(l.data.roles||[])}catch(l){console.error("Failed to load roles:",l)}},i=async l=>{l.preventDefault();try{await Pe.post("/api/messages/send",n),alert("Message sent!"),t()}catch(c){console.error("Failed to send message:",c),alert("Failed to send message")}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Send Message"})}),e.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To (Role)"}),e.jsxs("select",{value:n.toRole,onChange:l=>r({...n,toRole:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Select role..."}),s.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),e.jsx("textarea",{value:n.content,onChange:l=>r({...n,content:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:"4",placeholder:"Type your message...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsxs("select",{value:n.priority,onChange:l=>r({...n,priority:l.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Send"})]})]})]})})}function ss({children:t}){const{user:s,loading:a}=re();return a?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):s?t:e.jsx(ae,{to:"/auth/login",replace:!0})}function as({children:t}){const{user:s}=re();return s?s.subscription==="pro"||s.plan==="pro"||s.subscription==="custom"?t:e.jsx(ae,{to:"/upgrade",replace:!0}):e.jsx(ae,{to:"/auth/login",replace:!0})}function ec({children:t,allowedRoles:s=[]}){const{user:a}=re();if(!a)return e.jsx(ae,{to:"/auth/login",replace:!0});const n=a.businessRole||a.business_role||a.role;return s.length===0||s.includes(n)?t:e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸš«"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access this page."}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Required role: ",s.join(", ")]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Your role: ",n]}),e.jsx("button",{onClick:()=>window.history.back(),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Go Back"})]})})}function ns({children:t,requiredType:s}){const{user:a}=re();if(!a)return e.jsx(ae,{to:"/auth/login",replace:!0});const n=a.businessType||a.business_type;return n?n!==s?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ¢"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Wrong Business Type"}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["This page is for ",s," businesses only."]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Your business type: ",n]}),e.jsx("button",{onClick:()=>window.location.href=`/admin/${n}`,className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Go to Your Dashboard"})]})}):t:e.jsx(ae,{to:"/select-business-type",replace:!0})}function $s({children:t}){return e.jsx(ec,{allowedRoles:["admin"],children:t})}function hf({user:t}){const[s,a]=h.useState(!1);if(s||!t)return null;const n=t?.serviceStartDate?new Date(t.serviceStartDate):null,r=t?.daysUsed||0,o=t?.plan||"",l=Math.max(0,30-r);return l>7?null:e.jsxs("div",{className:"bg-amber-50 border-l-4 border-amber-500 p-3 md:p-4 flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx(ft,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-amber-900",children:l===0?`Your ${o} plan has expired. Please renew to continue.`:`Your ${o} plan expires in ${l} day${l!==1?"s":""}. Consider upgrading.`}),e.jsxs("p",{className:"text-xs text-amber-700 mt-1",children:["Service started: ",n?.toLocaleDateString()||"Unknown"]})]})]}),e.jsx("button",{onClick:()=>a(!0),className:"flex-shrink-0 text-amber-600 hover:text-amber-900",children:e.jsx(Qe,{className:"w-5 h-5"})})]})}function xf(){const{refreshProducts:t}=vn();return h.useEffect(()=>{const s=r=>{console.log(" Stock update received:",r.detail),t()},a=r=>{console.log(" Sale completed, refreshing stock:",r.detail),t()},n=r=>{console.log(" Products sync event:",r.detail)};return window.addEventListener("stockUpdate",s),window.addEventListener("saleComplete",a),window.addEventListener("productsSync",n),()=>{window.removeEventListener("stockUpdate",s),window.removeEventListener("saleComplete",a),window.removeEventListener("productsSync",n)}},[t]),null}function Fe({children:t,adminOnly:s=!1,ultraOnly:a=!1,ownerOnly:n=!1}){const{user:r,loading:o}=re(),{isLocked:i,lock:l,unlock:c}=oo(),[d,u]=h.useState(!1),x=Ql(6e4),m=x?.[0]||i||!1,b=h.useCallback(()=>{x?.[1]?.(),c()},[x,c]),[f,y]=h.useState({});if(h.useEffect(()=>{r&&!n&&((async()=>{try{const v=localStorage.getItem("token"),S=await fetch(`${ee}/settings`,{headers:{Authorization:`Bearer ${v}`}});if(S.ok){const P=await S.json();y(P)}}catch(v){console.error("Failed to load settings:",v)}})(),sessionStorage.getItem("reminderShown")||(u(!0),sessionStorage.setItem("reminderShown","true")))},[r,n]),h.useEffect(()=>{const p=v=>{console.log("ðŸ”’ Admin locked screen:",v.detail),l("admin")};return window.addEventListener("admin_locked_user_screen",p),()=>window.removeEventListener("admin_locked_user_screen",p)},[l]),o&&!n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(n){const p=localStorage.getItem("ownerToken"),v=localStorage.getItem("ownerUser");if(!p||!v)return e.jsx(ae,{to:"/main.admin"});try{if(JSON.parse(v).type!=="main_admin")return e.jsx(ae,{to:"/main.admin"})}catch{return e.jsx(ae,{to:"/main.admin"})}}else{if(!r)return e.jsx(ae,{to:"/auth/login"});if(!r.active)return e.jsx(ae,{to:"/choose-subscription"});if(s&&r.role!=="admin")return e.jsx(ae,{to:"/dashboard"});if(a&&(r.role!=="admin"||r.plan!=="ultra"))return e.jsx(ae,{to:"/dashboard"})}const g=n?"owner":"user";return e.jsxs(e.Fragment,{children:[e.jsx(hf,{}),e.jsx(xf,{}),m&&e.jsx(Zl,{onUnlock:b,userType:g}),d&&e.jsx(Xl,{onClose:()=>u(!1)}),t]})}function pf(){const{user:t}=re();if(!t||!t.active)return e.jsx(ae,{to:"/choose-subscription"});const s=t.subscription==="pro"||t.plan==="pro"||t.subscription==="custom"||t.plan===3e3,a=t.businessType||t.business_type,n=t.businessRole||t.business_role;if(s&&a){if(console.log("[Dashboard Router] Pro user detected:",{businessType:a,businessRole:n,role:t.role}),t.role==="admin")return e.jsx(ae,{to:`/admin/${a}`});if(n){if(a==="clinic"){if(n==="doctor")return e.jsx(ae,{to:"/dashboard/clinic/doctor"});if(n==="registrar"||n==="reception")return e.jsx(ae,{to:"/dashboard/clinic/reception"});if(n==="pharmacist"||n==="pharmacy")return e.jsx(ae,{to:"/dashboard/clinic/pharmacy"});if(n==="cashier")return e.jsx(ae,{to:"/dashboard/cashier"})}if(a==="bar"){if(n==="bartender")return e.jsx(ae,{to:"/dashboard/bar/bartender"});if(n==="cashier")return e.jsx(ae,{to:"/dashboard/cashier"})}if(a==="hotel"){if(n==="receptionist")return e.jsx(ae,{to:"/dashboard/hotel/reception"});if(n==="housekeeping")return e.jsx(ae,{to:"/dashboard/hotel/housekeeping"});if(n==="cashier")return e.jsx(ae,{to:"/dashboard/cashier"})}if(a==="supermarket"){if(n==="department_head")return e.jsx(ae,{to:"/dashboard/supermarket/department"});if(n==="cashier")return e.jsx(ae,{to:"/dashboard/cashier"})}}return e.jsx(ae,{to:"/dashboard/cashier"})}return s&&!a&&t.role==="admin"?e.jsx(ae,{to:"/select-business-type"}):t.role==="admin"?e.jsx(ae,{to:"/admin"}):e.jsx(ae,{to:"/dashboard/cashier"})}function ff(){return e.jsx(Zc,{children:e.jsx(Qc,{children:e.jsx(td,{children:e.jsx(mc,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:e.jsxs(_i,{children:[e.jsx(X,{path:"/",element:e.jsx(Oi,{})}),e.jsx(X,{path:"/get-started",element:e.jsx(Oi,{})}),e.jsx(X,{path:"/choose-subscription",element:e.jsx($p,{})}),e.jsx(X,{path:"/auth/login",element:e.jsx($i,{})}),e.jsx(X,{path:"/auth/signup",element:e.jsx($i,{})}),e.jsx(X,{path:"/plans",element:e.jsx(ae,{to:"/choose-subscription"})}),e.jsx(X,{path:"/build-pos",element:e.jsx(Vp,{})}),e.jsx(X,{path:"/main.admin/*",element:e.jsx(Vi,{})}),e.jsx(X,{path:"/main-admin",element:e.jsx(Fe,{ownerOnly:!0,children:e.jsx(Vi,{})})}),e.jsx(X,{path:"/select-business-type",element:e.jsx(Fe,{adminOnly:!0,children:e.jsx(Op,{})})}),e.jsx(X,{path:"/pro-dashboard",element:e.jsx(Fe,{adminOnly:!0,children:e.jsx(Fp,{})})}),e.jsx(X,{path:"/admin/clinic",element:e.jsx(ss,{children:e.jsx(as,{children:e.jsx(ns,{requiredType:"clinic",children:e.jsx($s,{children:e.jsx(sf,{})})})})})}),e.jsx(X,{path:"/admin/bar",element:e.jsx(ss,{children:e.jsx(as,{children:e.jsx(ns,{requiredType:"bar",children:e.jsx($s,{children:e.jsx(nf,{})})})})})}),e.jsx(X,{path:"/admin/hotel",element:e.jsx(ss,{children:e.jsx(as,{children:e.jsx(ns,{requiredType:"hotel",children:e.jsx($s,{children:e.jsx(of,{})})})})})}),e.jsx(X,{path:"/admin/supermarket",element:e.jsx(ss,{children:e.jsx(as,{children:e.jsx(ns,{requiredType:"supermarket",children:e.jsx($s,{children:e.jsx(cf,{})})})})})}),e.jsx(X,{path:"/dashboard/clinic/doctor",element:e.jsx(ss,{children:e.jsx(as,{children:e.jsx(ns,{requiredType:"clinic",children:e.jsx(ec,{allowedRoles:["doctor"],children:e.jsx(uf,{})})})})})}),e.jsx(X,{path:"/dashboard",element:e.jsx(Fe,{children:e.jsx(pf,{})})}),e.jsx(X,{path:"/dashboard/cashier",element:e.jsx(Fe,{children:e.jsx(yt,{})})}),e.jsx(X,{path:"/cashier/bar",element:e.jsx(Fe,{children:e.jsx(Yp,{})})}),e.jsx(X,{path:"/cashier/hospital",element:e.jsx(Fe,{children:e.jsx(Xp,{})})}),e.jsx(X,{path:"/cashier/school",element:e.jsx(Fe,{children:e.jsx(Zp,{})})}),e.jsx(X,{path:"/cashier/kiosk",element:e.jsx(Fe,{children:e.jsx(Qp,{})})}),e.jsx(X,{path:"/cashier/petrol",element:e.jsx(Fe,{children:e.jsx(ef,{})})}),e.jsx(X,{path:"/cashier/shoes",element:e.jsx(Fe,{children:e.jsx(tf,{})})}),e.jsx(X,{path:"/admin/*",element:e.jsx(Fe,{adminOnly:!0,children:e.jsx(da,{})})}),e.jsx(X,{path:"/admin",element:e.jsx(Fe,{adminOnly:!0,children:e.jsx(da,{})})}),e.jsx(X,{path:"/login",element:e.jsx(ae,{to:"/auth/login"})}),e.jsx(X,{path:"/signup",element:e.jsx(ae,{to:"/auth/signup"})}),e.jsx(X,{path:"/subscription",element:e.jsx(ae,{to:"/choose-subscription"})}),e.jsx(X,{path:"/payment",element:e.jsx(ae,{to:"/choose-subscription"})}),e.jsx(X,{path:"/cashier",element:e.jsx(Fe,{children:e.jsx(yt,{})})})]})})})})})}Kc.createRoot(document.getElementById("root")).render(e.jsx(hc.StrictMode,{children:e.jsx(ff,{})}));
